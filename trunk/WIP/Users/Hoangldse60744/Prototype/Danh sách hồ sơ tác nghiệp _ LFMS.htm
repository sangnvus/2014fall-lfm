<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Danh sách hồ sơ tác nghiệp | LFMS</title>
    <link href="http://localhost:19442/Content/logo/LFMS-icon-48.png" rel="icon">

    

    <!-- basic styles -->
    <link href="Danh%20s%C3%A1ch%20h%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p%20_%20LFMS_files/main.css" rel="stylesheet" type="text/css">
    <link href="Danh%20s%C3%A1ch%20h%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p%20_%20LFMS_files/bootstrap.css" rel="stylesheet" type="text/css">
    <link href="Danh%20s%C3%A1ch%20h%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p%20_%20LFMS_files/font-awesome.css" rel="stylesheet" type="text/css">

    <!-- ace styles -->
    <link href="Danh%20s%C3%A1ch%20h%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p%20_%20LFMS_files/ace.css" rel="stylesheet" type="text/css">
    <link href="Danh%20s%C3%A1ch%20h%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p%20_%20LFMS_files/ace-rtl.css" rel="stylesheet" type="text/css">
    <link href="Danh%20s%C3%A1ch%20h%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p%20_%20LFMS_files/ace-skins.css" rel="stylesheet" type="text/css">

    <!-- ace settings handler -->
    <script src="Danh%20s%C3%A1ch%20h%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p%20_%20LFMS_files/ace-extra.js" type="text/javascript"></script>

    <!-- basic scripts -->
    <!--[if !IE]> -->
    <script src="Danh%20s%C3%A1ch%20h%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p%20_%20LFMS_files/jquery-2.js" type="text/javascript"></script>
    <!-- <![endif]-->
    <script src="Danh%20s%C3%A1ch%20h%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p%20_%20LFMS_files/main.js" type="text/javascript"></script>

    <!--[if !IE]> -->
    <script type="text/javascript">
        window.jQuery || document.write("<script src='~/Content/js/jquery-2.0.3.min.js'>" + "<" + "/script>");
    </script>
    <!-- <![endif]-->

    <script type="text/javascript">
        if ("ontouchend" in document && document.ontouchend != null) document.write("<script src='~/Content/js/jquery.mobile.custom.min.js'>" + "<" + "/script>");
    </script>
    <script src="Danh%20s%C3%A1ch%20h%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p%20_%20LFMS_files/bootstrap.js" type="text/javascript"></script>
    <script src="Danh%20s%C3%A1ch%20h%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p%20_%20LFMS_files/typeahead-bs2.js" type="text/javascript"></script>

    <!-- ace scripts -->
    <script src="Danh%20s%C3%A1ch%20h%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p%20_%20LFMS_files/ace-elements.js" type="text/javascript"></script>
    <script src="Danh%20s%C3%A1ch%20h%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p%20_%20LFMS_files/ace.js" type="text/javascript"></script>
    <script src="Danh%20s%C3%A1ch%20h%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p%20_%20LFMS_files/md5.js" type="text/javascript"></script>


    <link href="Danh%20s%C3%A1ch%20h%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p%20_%20LFMS_files/jquery-ui-1.css" rel="stylesheet" type="text/css">

    <link href="Danh%20s%C3%A1ch%20h%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p%20_%20LFMS_files/datepicker.css" rel="stylesheet" type="text/css">
    <link href="Danh%20s%C3%A1ch%20h%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p%20_%20LFMS_files/jquery.css" rel="stylesheet">


    <script src="Danh%20s%C3%A1ch%20h%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p%20_%20LFMS_files/jquery-ui-1.js" type="text/javascript"></script>

    <script src="Danh%20s%C3%A1ch%20h%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p%20_%20LFMS_files/jquery_005.js" type="text/javascript"></script>
    <script src="Danh%20s%C3%A1ch%20h%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p%20_%20LFMS_files/jquery_004.js" type="text/javascript"></script>
    <script src="Danh%20s%C3%A1ch%20h%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p%20_%20LFMS_files/bootstrap-datepicker.js" type="text/javascript"></script>
    <script src="Danh%20s%C3%A1ch%20h%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p%20_%20LFMS_files/jquery.js" type="text/javascript"></script>
    <script src="Danh%20s%C3%A1ch%20h%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p%20_%20LFMS_files/jquery_002.js" type="text/javascript"></script>
    <script src="Danh%20s%C3%A1ch%20h%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p%20_%20LFMS_files/jquery_003.js"></script>
</head>

<body>
    <div class="navbar navbar-default" id="navbar">
        <script type="text/javascript">
            try { ace.settings.check('navbar', 'fixed') } catch (e) { }
        </script>

        <div class="navbar-container" id="navbar-container">
            <div class="navbar-header pull-left">
                <a href="http://localhost:19442/Home/Index" class="navbar-brand" title="Trang chủ">
                    <small>
                        <img src="Danh%20s%C3%A1ch%20h%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p%20_%20LFMS_files/LFMS-logo-big.png" style="border: none; height: 22px">
                    </small>
                </a><!-- /.brand -->
            </div><!-- /.navbar-header -->
            <div id="staffIdDiv" value="1" style="display:none"></div>

<div class="navbar-header pull-right" role="navigation">
    <ul class="nav ace-nav">
        <li class="green" id="notificationArea" style="display: block"><a data-toggle="dropdown" class="dropdown-toggle" href="#"><i class="icon-bell-alt" id="bellIcon"></i><span class="badge badge-success" id="countCalender1">0</span></a><ul class="pull-right dropdown-navbar dropdown-menu dropdown-caret dropdown-close"><li class="dropdown-header"><i class="icon-calendar"></i>Hôm nay có <span id="countCalender2">0</span> sự kiện</li><li></li></ul></li>

        <li class="light-green">
            <a data-toggle="dropdown" href="#" class="dropdown-toggle">
                <img class="nav-user-photo" src="Danh%20s%C3%A1ch%20h%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p%20_%20LFMS_files/thuannh.jpg" alt="">
                <span class="user-info">
                    <small>Xin chào,</small>
                    <p>Nguyễn Hòa Thuận</p>
                </span>

                <i class="icon-caret-down"></i>
            </a>

            <ul class="user-menu pull-right dropdown-menu dropdown-yellow dropdown-caret dropdown-close">
                <li>
                    <a href="http://localhost:19442/Case/ListCase" onclick="">
                        <i class="icon-folder-open"></i>
                        Danh sách hồ sơ
                    </a>
                </li>

                <li class="divider"></li>

                    <li>
                        <a href="http://localhost:19442/Customer/Customer" onclick="">
                            <i class="icon-group"></i>
                            Quản lý khách hàng
                        </a>
                    </li>
                    <li class="divider"></li>
                    <li>
                        <a href="http://localhost:19442/Staff/Staff">
                            <i class="icon-user"></i>
                            Quản lý nhân viên
                        </a>
                    </li>
                    <li class="divider"></li>
                    <li>
                        <a href="http://localhost:19442/Service/Service" onclick="">
                            <i class="icon-cog"></i>
                            Quản lý dịch vụ
                        </a>
                    </li>
                    <li class="divider"></li>
                    <li>
                        <a href="http://localhost:19442/Office/Office">
                            <i class="icon-home"></i>
                            Quản lý văn phòng
                        </a>
                    </li>
                    <li class="divider"></li>
                    <li>
                        <a href="http://localhost:19442/Salary/Salary">
                            <i class=" icon-globe"></i>
                            Quản lí lương nhân viên
                        </a>
                    </li>
                    <li class="divider"></li>
                    <li>
                        <a href="http://localhost:19442/Statistic/Statistic">
                            <i class="icon-home"></i>
                            Thống kê
                        </a>
                    </li>
                     <li class="divider"></li>
                    <li>
                        <a href="http://localhost:19442/OtherCost/OtherCost">
                            <i class="icon-cog"></i>
                            Chi phí khác
                        </a>
                    </li>
                    <li class="divider"></li>

                <li>
                    <a data-toggle="modal" href="#tblPassChange" onclick='$("#PassChangeDiv").appendTo("#bodyChangePass"); validatePassword("#validatPassForm"); clearFieldPassword();'>
                        <i class="icon-key"></i>
                        Đổi mật khẩu
                    </a>
                </li>

                <li class="divider"></li>

                <li>
                    <a href="#" onclick="logOut()">
                        <i class="icon-off"></i>
                        Đăng xuất
                    </a>
                </li>
            </ul>
        </li>
    </ul><!-- /.ace-nav -->
</div><!-- /.navbar-header -->

<script>
    $(document).ready(function () {
        GetCalendarsByStaffId();
    });

    function GetCalendarsByStaffId() {
        $.post("/UserControl/GetCalendarsByStaffId", { staffId: $("#staffIdDiv").attr("value") }, function (out) {
            var item = '<a data-toggle="dropdown" class="dropdown-toggle" href="#"><i class="icon-bell-alt" id="bellIcon"></i><span class="badge badge-success" id="countCalender1"></span></a>';
            item += '<ul class="pull-right dropdown-navbar dropdown-menu dropdown-caret dropdown-close"><li class="dropdown-header"><i class="icon-calendar"></i>Hôm nay có <span id="countCalender2"></span> sự kiện</li>';
            var count = 0;

            $.each(out, function (index, ca) {
                var casecode = "";
                var priority;
                if (typeof (ca.Case) != "undefined") {
                    casecode = " (" + ca.Case.CaseCode + ")";
                    priority = "";
                } else priority = ca.Priority;
                count += 1;

                item += '<li><a>';
                item += '<span class="label label-lg ' + priority + '" style="margin-right: 10px"><i class="icon-info-sign"></i></span>';
                item += '<span class="msg-body">';
                item += '<span class="msg-title" style="font-weight: bold">' + ca.Title + casecode + '</span>';

                var date1 = convertNETDateTime(ca.BeginTime).toLocaleFormat('%d/%m/%Y');
                var time1 = convertNETDateTime(ca.BeginTime).toLocaleTimeString();
                var date2 = convertNETDateTime(ca.EndTime).toLocaleFormat('%d/%m/%Y');
                var time2 = convertNETDateTime(ca.EndTime).toLocaleTimeString();

                if (date1 == date2) {
                    if (time1 == "12:00:00 AM" && time2 == "12:00:00 AM") {
                        item += '<span class="msg-time"><span>Cả ngày</span></span>';
                    } else {
                        item += '<span class="msg-time"><span> Bắt đầu: ' + time1 + '</span></span>';
                        item += '<span class="msg-time"><span> Kết thúc: ' + time2 + '</span></span>';
                    }
                } else {
                    item += '<span class="msg-time"><span> Từ ngày: ' + date1 + '</span></span>';
                    item += '<span class="msg-time"><span> Đến ngày: ' + date2 + '</span></span>';
                }

                item += '</span>'; // span body
                item += '</a></li>';
            });

            item += '<li></li></ul>';
            $('#notificationArea').html(item);
            $('#countCalender1').text(count);
            $('#countCalender2').text(count);

            if (count != 0) {
                $('#countCalender1').attr('class', 'badge badge-important');
                $('#bellIcon').attr('class', 'icon-bell-alt icon-animated-bell');
            }
        });
    }

</script>

<div id="PassChangeDiv">
    <div id="tblPassChange" class="modal fade" tabindex="-1">
        <div class="modal-dialog" style="width: 100%; min-width: 600px; max-width: 600px">
            <div class="modal-content">
                <div class="modal-header no-padding">
                    <div class="table-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                            <span class="white">×</span>
                        </button>
                        Thay đổi mật khẩu
                    </div>
                </div>
                <form class="modal-body no-padding" id="validatPassForm">
                    <div class="modal-body no-padding">
                        <div class="col-xs-12 form-horizontal" style="padding-top: 20px; margin-left: 10px">
                            <div class="row">
                                <div class="form-group col-sm-12">
                                    <label class="col-sm-4 ">Mật khẩu cũ: <span style="color: red"> *</span></label>
                                    <div class="col-sm-8">
                                        
                                        <div>
                                            <input name="Oldpassword" id="Oldpassword" style="width:100%" type="password">
                                        </div>
                                        <div id="checkPass" style="display: none">
                                            <span style="color: #D16E6C">Mật khẩu cũ không đúng ! </span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="form-group col-sm-12">
                                    <label class="col-sm-4 ">Mật khẩu mới: <span style="color: red"> *</span></label>
                                    <div class="col-sm-8">
                                        <div>
                                            <input name="password" id="password" style="width:100%" type="password">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="form-group col-sm-12">
                                    <label class="col-sm-4 ">Lặp lại mật khẩu mới: <span style="color: red"> *</span></label>
                                    <div class="col-sm-8">
                                        <div>
                                            <input name="password2" id="password2" style="width:100%" type="password">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>

                <div class="modal-footer no-margin-top"></div>
                <div class="modal-footer no-margin-top">
                    <button class="btn btn-grey pull-left" type="button" data-dismiss="modal" id="btnCloseChange">
                        <i class="icon-remove"></i>
                        Đóng
                    </button>
                    <button class="btn btn-success" type="button" data-bb-handler="confirm" id="btnUpdatePass" onclick="updateStaffPass()">
                        <i class="icon-ok"></i>
                        Đổi mật khẩu
                    </button>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div>
</div>
<script type="text/javascript">
    function updateStaffPass() {
        if ($('#validatPassForm').valid()) {
            editFr = $('#tblPassChange');
            var oldPassword = $.md5($('#Oldpassword', editFr).val());
            var staffPassword = $.md5($('#password2', editFr).val());
            $.post("/UserControl/UpdateStaffPass", {
                oldPassword: oldPassword, staffPassword2: staffPassword
            }, function (result) {
                if (result == "successful") {
                    $('.close').click();
                    $('#checkPass').attr("style", "display: none");
                    notification("Cập nhật mật khẩu nhân viên thành công!", "", 3000, "btn-primary center");
                } else if (result == 'error') {
                    $('.close').click();
                    $('#checkPass').attr("style", "display: none");
                    notification("Cập nhật mật khẩu nhân viên nhân viên thất bại!", "Hãy kiểm tra lại kết nối database.", 5000, "gritter-error center");
                } else if (result == "notMatch") {
                    $('#checkPass').attr("style", "display: block");
                }
            })
                .error(function () {
                    $('.close').click();
                    $('#checkPass').attr("style", "display: none");
                    notification("Cập nhật mật khẩu nhân viên thất bại", "Hãy kiểm tra lại kết nối database.", 5000, "gritter-error center");
                });
        }
    }

    function validatePassword(validateform) {
        $(validateform).validate({
            errorElement: 'div',
            errorClass: 'help-block',
            focusInvalid: false,
            rules: {
                password: {
                    required: true,
                    alphanumeric: true,
                    minlength: 6


                },
                password2: {
                    required: true,
                    alphanumeric: true,
                    minlength: 6,
                    equalTo: "#password"
                },
                Oldpassword: {
                    required: true,
                    alphanumeric: true
                }
            },
            messages: {
                password: {
                    required: "Hãy nhập mật khẩu mới.",
                    alphanumeric: "Mật khẩu không được có kí tự đặc biệt",
                    minlength: "Mật khẩu mới phải có ít nhất 6 kí tự.",
                },
                password2: {
                    required: "Hãy nhập lại mật khẩu mới.",
                    alphanumeric: "Mật khẩu không được có kí tự đặc biệt",
                    minlength: "Mật khẩu mới phải có ít nhất 6 kí tự.",
                    equalTo: "Mật khẩu 2 không trùng khớp.",
                },
                Oldpassword: {
                    required: "Hãy nhập lại mật khẩu cũ.",
                    alphanumeric: "Mật khẩu không được có kí tự đặc biệt",
                }
            },
            highlight: function (e) {
                $(e).closest('.form-group').removeClass('has-info').addClass('has-error');
            },

            success: function (e) {
                $(e).closest('.form-group').removeClass('has-error').addClass('has-info');
                $(e).remove();
            },
            errorPlacement: function (error, element) {
                if (element.is(':checkbox') || element.is(':radio')) {
                    var controls = element.closest('div[class*="col-"]');
                    if (controls.find(':checkbox,:radio').length > 1) controls.append(error);
                    else error.insertAfter(element.nextAll('.lbl:eq(0)').eq(0));
                }
                else error.insertAfter(element.parent());
            }
        });
    }

    function clearFieldPassword() {
        editFr = $('#tblPassChange');
        $('#Oldpassword', editFr).val("");
        $('#password', editFr).val("");
        $('#password2', editFr).val("");

    }

    function logOut() {
        $.post("/Login/LogOut", {}, function (out) {
            if (out != "success") {
                alert(out);
            }
            window.location = ("/Login/Login");
        });
    }
</script>


            
        </div><!-- /.container -->
    </div>

    <div class="main-container" id="main-container">
        <script type="text/javascript">
            try { ace.settings.check('main-container', 'fixed') } catch (e) { }
        </script>

        <div class="main-container-inner">

            <div class="main-content" style="margin-left:0">

    <div class="breadcrumbs" id="breadcrumbs">
        <script type="text/javascript">
            try { ace.settings.check('breadcrumbs', 'fixed') } catch (e) { }
        </script>

        <ul class="breadcrumb">
            <li>
                <i class="icon-home home-icon"></i>
                <a href="http://localhost:19442/Home/Index">Trang chủ</a> | Hồ sơ tác nghiệp
            </li>

            <li class="active">
                <strong>Danh sách hồ sơ</strong>
            </li>
        </ul><!-- .breadcrumb -->
    </div>

                <div class="page-content">
                    <div class="row">
                        <div class="col-xs-12">
                            <!-- PAGE CONTENT BEGINS -->
                            





<div id="staffRoleIdDiv" value="1" style="display:none"></div>

<div id="bodyChangePass"></div>

<div id="addNewCaseBtn" style="">
    <a href="#modalAddNewCase" role="button" class="green" data-toggle="modal">
        <button class="btn btn-primary" onclick="">
            <i class="icon-plus"></i>
            Thêm hồ sơ tác nghiệp
        </button>
    </a>
</div>

<hr>

<div id="modalAddNewCase" class="modal fade" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header no-padding">
                <div class="table-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                        <span class="white">×</span>
                    </button>
                    Thêm hồ sơ tác nghiệp
                </div>
            </div>

            <form novalidate="novalidate" class="modal-body no-padding" id="addCaseValidateForm">
                <div class="col-xs-12">
                    <div class="row">
                        <div class="form-group" style="margin-bottom: 0px">
                            <div class="col-sm-6">
                                <p class="header blue lighter smaller">Mã hồ sơ<span style="color: red"> *</span></p>
                                <div>
                                    <input id="txtCaseCode" name="txtCaseCode" class="col-xs-10 col-sm-5" style="width: 100%; height: 32px;" maxlength="50" type="text">
                                </div>
                                <div id="existCaseCodeError" style="display: none">
                                    <span style="color: #D16E6C">Mã hồ sơ đã tồn tại!</span>
                                </div>
                            </div>
                        </div>

                        <div class="col-sm-6">
                            <p class="header blue lighter smaller">Ngày thụ lý<span style="color: red"> *</span></p>
                            <div class="input-group input-group-sm">
                                <input value="08/10/2014" class="form-control date-picker" id="datePickerReceiptDate" data-date-format="dd/mm/yyyy" style="width: 100%; cursor: pointer; background: none repeat scroll 0 0 #fff !important" readonly="readonly" type="text">
                                <span class="input-group-addon">
                                    <i class="icon-calendar bigger-110"></i>
                                </span>

                                <script>
                                    var today = getCurdate();
                                    document.getElementById("datePickerReceiptDate").value = today.toString();
                                </script>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="form-group" style="margin-bottom: 0px">
                            <div class="col-sm-6">
                                <p class="header blue lighter smaller">Thuộc văn phòng<span style="color: red"> *</span></p>
                                <div>
                                    <select class="form-control" id="cboOffice" name="cboOffice"><option value="1">Luật Thuận Nguyễn Hồ Chí Minh</option><option value="2">Luật Thuận Nguyễn Vĩnh Long</option></select>
                                </div>
                            </div>
                        </div>

                        <div class="form-group" style="margin-bottom: 0px">
                            <div class="col-sm-6">
                                <p class="header blue lighter smaller">Nội dung<span style="color: red"> *</span></p>
                                <div>
                                    <textarea id="txtCaseContent" name="txtCaseContent" class="autosize-transition form-control" style="resize: none; overflow: hidden; word-wrap: break-word; height: 52px;"></textarea>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="space-12"></div>
                </div>
            </form>

            <div class="modal-footer no-margin-top">
                <button class="btn btn-grey pull-left" type="button" data-dismiss="modal" id="btnClose">
                    <i class="icon-remove"></i>
                    Đóng
                </button>
                <button class="btn btn-success" type="button" data-bb-handler="confirm" id="btnAddNewCase" onclick="addCase()">
                    <i class="icon-ok"></i>
                    Thêm mới
                </button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>

<div id="messageBox" class="" style="display:none" align="center">
    <div style="float:right; margin-right: 10px">
        <a href="#" class="closeDivisor" onclick="closeDivisor('messageBox'); return false;">[x]</a>
    </div>
    <div class="opacity1">
        <p id="messageBoxContent"></p>
    </div>
</div>

<p id="messageSuccess" style="display: none">Thêm hồ sơ thành công!</p>
<p id="messageError" style="display: none">Lỗi kết nối cơ sở dữ liệu!</p>

<div class="table-responsive">
    <div id="tblCase_wrapper" class="dataTables_wrapper" role="grid"><div class="row"><div class="col-sm-6"><div class="dataTables_length" id="tblCase_length"><label>Hiển thị <select aria-controls="tblCase" size="1" name="tblCase_length"><option selected="selected" value="10">10</option><option value="25">25</option><option value="50">50</option><option value="100">100</option></select> hồ sơ</label></div></div><div class="col-sm-6"><div id="tblCase_filter" class="dataTables_filter"><label>Tìm kiếm: <input aria-controls="tblCase" type="text"></label></div></div></div><table style="width: 100%;" aria-describedby="tblCase_info" id="tblCase" class="table table-striped table-bordered table-hover dataTable" width="100%">
        <thead>
            <tr role="row"><th aria-label="Mã hồ sơ: activate to sort column ascending" style="width: 179px;" colspan="1" rowspan="1" aria-controls="tblCase" tabindex="0" role="columnheader" class="sorting" width="15%">Mã hồ sơ</th><th aria-label="Nội dung: activate to sort column ascending" style="width: 441px;" colspan="1" rowspan="1" aria-controls="tblCase" tabindex="0" role="columnheader" class="hidden-320 sorting">Nội dung</th><th aria-label="Ngày thụ lý: activate to sort column ascending" aria-sort="descending" style="width: 179px;" colspan="1" rowspan="1" aria-controls="tblCase" tabindex="0" role="columnheader" class="hidden-640 sorting_desc" width="15%">Ngày thụ lý</th><th aria-label="Thuộc văn phòng: activate to sort column ascending" style="width: 245px;" colspan="1" rowspan="1" aria-controls="tblCase" tabindex="0" role="columnheader" class="hidden-480 sorting" width="20%">Thuộc văn phòng</th><th aria-label="Trạng thái: activate to sort column ascending" style="width: 179px;" colspan="1" rowspan="1" aria-controls="tblCase" tabindex="0" role="columnheader" class="sorting" width="15%">Trạng thái</th></tr>
        </thead>
        <tbody id="tbodyCaseList" role="alert" aria-live="polite" aria-relevant="all"><tr class="odd"><td><a href="http://localhost:19442/Case/Case/1006">DSST2014002</a></td><td class="hidden-320">Tranh chấp đất đai và mâu thuẫn dân sự</td><td class="hidden-640">16/04/2014</td><td class="hidden-480">Luật Thuận Nguyễn Hồ Chí Minh</td><td><span class="label label-lg label-danger arrowed">Đang thụ lý</span></td></tr><tr class="even"><td><a href="http://localhost:19442/Case/Case/1007">TLST2014003</a></td><td class="hidden-320">Tranh chấp thừa kế</td><td class="hidden-640">08/04/2014</td><td class="hidden-480">Luật Thuận Nguyễn Hồ Chí Minh</td><td><span class="label label-lg label-danger arrowed">Đang thụ lý</span></td></tr><tr class="odd"><td><a href="http://localhost:19442/Case/Case/3">DSST2014001</a></td><td class="hidden-320">Tranh chấp quyền sử dụng đất và kiện đòi tài sản</td><td class="hidden-640">01/04/2014</td><td class="hidden-480">Luật Thuận Nguyễn Hồ Chí Minh</td><td><span class="label label-lg label-danger arrowed">Đang thụ lý</span></td></tr><tr class="even"><td><a href="http://localhost:19442/Case/Case/4">TLST2014001</a></td><td class="hidden-320">Tranh chấp hợp đồng vay tài sản.</td><td class="hidden-640">20/03/2014</td><td class="hidden-480">Luật Thuận Nguyễn Hồ Chí Minh</td><td><span class="label label-lg label-danger arrowed">Đang thụ lý</span></td></tr><tr class="odd"><td><a href="http://localhost:19442/Case/Case/2">HS20140002</a></td><td class="hidden-320">Đòi bồi thường tai nạn giao thông</td><td class="hidden-640">14/02/2014</td><td class="hidden-480">Luật Thuận Nguyễn Vĩnh Long</td><td><span class="label label-lg label-danger arrowed">Đang thụ lý</span></td></tr><tr class="even"><td><a href="http://localhost:19442/Case/Case/1">HS20140001</a></td><td class="hidden-320">Tranh chấp tài sản thừa kế</td><td class="hidden-640">20/01/2014</td><td class="hidden-480">Luật Thuận Nguyễn Hồ Chí Minh</td><td><span class="label label-lg label-success arrowed">Đã thụ lý</span></td></tr><tr class="odd"><td><a href="http://localhost:19442/Case/Case/5">KDTM2014001</a></td><td class="hidden-320">Về tranh chấp hợp đồng cho thuê tài chính và đòi tài sản</td><td class="hidden-640">12/12/2013</td><td class="hidden-480">Luật Thuận Nguyễn Hồ Chí Minh</td><td><span class="label label-lg label-success arrowed">Đã thụ lý</span></td></tr><tr class="even"><td><a href="http://localhost:19442/Case/Case/6">TLST2014002</a></td><td class="hidden-320">Kiện đòi tài sản</td><td class="hidden-640">01/11/2013</td><td class="hidden-480">Luật Thuận Nguyễn Hồ Chí Minh</td><td><span class="label label-lg label-danger arrowed">Đang thụ lý</span></td></tr><tr class="odd"><td><a href="http://localhost:19442/Case/Case/1009">TEST201402</a></td><td class="hidden-320">Hồ sơ test</td><td class="hidden-640">30/07/2013</td><td class="hidden-480">Luật Thuận Nguyễn Vĩnh Long</td><td><span class="label label-lg label-success arrowed">Đã thụ lý</span></td></tr><tr class="even"><td><a href="http://localhost:19442/Case/Case/1008">TEST201401</a></td><td class="hidden-320">Hồ sơ test</td><td class="hidden-640">11/06/2013</td><td class="hidden-480">Thừa Phát Lại Vĩnh Long</td><td><span class="label label-lg label-success arrowed">Đã thụ lý</span></td></tr></tbody>
    </table><div class="row"><div class="col-sm-6"><div id="tblCase_info" class="dataTables_info">Hiển thị <b style="color:#428BCA"> 1 </b> tới <b style="color:#428BCA"> 10 </b> trong  <b style="color:#428BCA"> 11 </b> hồ sơ</div></div><div class="col-sm-6"><div class="dataTables_paginate paging_bootstrap"><ul class="pagination"><li class="prev disabled"><a href="#"><i class="icon-double-angle-left"></i></a></li><li class="active"><a href="#">1</a></li><li><a href="#">2</a></li><li class="next"><a href="#"><i class="icon-double-angle-right"></i></a></li></ul></div></div></div></div>
</div>

<script type="text/javascript">
    $(document).ready(function () {

        var roleId = $("#staffRoleIdDiv").attr("value");
        if (roleId == "1" || roleId == "2") {
            $('#addNewCaseBtn').show();
        }
        validateAddCase('#addCaseValidateForm');

        // load office len cobOffice
        if (roleId == "1") {
            loadSelectOfficesWithAdmin();
        } else {
            loadSelectOffices();
        }

        getCasesJson("10", "2", "", "0", "");
        var oTable1 = $('#tblCase').dataTable({
            "aoColumns": [
              null, null, null, null, null
            ],
            "aaSorting": [[2, "desc"]]
        });
    });
    var changePage = false;
    var changeRecord = 10;
    var totalRecord;
    var serverSideListCase = true;

    function getCasesJson(displayNum1, orderKey1, orderType1, pageNum1, caseCode1) {
        $.ajax({
            url: '/Case/GetAllJsonCase',
            method: 'POST',
            async: false,
            data: { displayNum: displayNum1, orderKey: orderKey1, orderType: orderType1, pageNum: pageNum1, caseCode: caseCode1 },
            success: function (out) {
                {
                    var item = "";
                    $.each(out.list, function (index1, cs) {
                        item += '<tr class="';

                        item += (index1 % 2 == 0) ? 'odd' : 'even';
                        item += '"><td><a href="/Case/Case/' + cs.CaseId + '">' + cs.CaseCode + '</a></td>';
                        item += '<td class="hidden-320">' + cs.CaseContent + '</td>';
                        item += '<td class="hidden-640">' + convertNETDateTime(cs.ReceiptDate).toLocaleFormat('%d/%m/%Y') + '</td>';
                        item += '<td class="hidden-480">' + cs.Office.OfficeName + '</td>';
                        if (cs.Status == "Đang thụ lý") {
                            item += '<td><span class="label label-lg label-danger arrowed">' + cs.Status + '</span></td>';
                        }
                        else if (cs.Status == "Đã thụ lý") {
                            item += '<td><span class="label label-lg label-success arrowed">' + cs.Status + '</span></td>';
                        }

                        item += '</tr>';
                    });
                    $('#tbodyCaseList').html(item);
                    totalRecord = out.totalRecord;

                };
            }
        });
    }

    function addCase() {
        if ($('#addCaseValidateForm').valid()) {
            var caseCode = $('#txtCaseCode').val();
            var receiptDate = $('#datePickerReceiptDate').val();
            var caseContent = $('#txtCaseContent').val();
            var officeId = $("#cboOffice option:selected").val();
            $.post("/Case/AddCase", {
                caseCode: caseCode, receiptDate: receiptDate, caseContent: caseContent, officeId: officeId
            }, function (result) {
                if (result != "error" && result != "existCode") {
                    $('#existCaseCodeError').attr("style", "display: none");
                    var url = '/Case/Case/' + result + '';
                    $(location).attr('href', url);
                } else if (result == "error") {
                    notification("Thêm hồ sơ thất bại!", "Hãy kiểm tra lại kết nối database.", 5000, "gritter-error center");
                } else if (result == "existCode") {
                    $('#existCaseCodeError').attr("style", "display: block");
                }
            })
            .error(function () {
                notification("Thêm hồ sơ thất bại!", "Hãy kiểm tra lại kết nối database.", 5000, "gritter-error center");
            });
    
        }
    }

    function loadSelectOfficesWithAdmin() {
        $.post("/Case/GetAllOfficeJson", {}, function (out) {
            var item = '';
            $.each(out, function (index, off) {
                item += '<option value="' + off.OfficeId + '">' + off.OfficeName + '</option>';
            });
            $('#cboOffice').html(item);
            $('#cboOffice').val("");
        });
    }

    function loadSelectOffices() {
        $.post("/Case/GetOfficesByStaffId", {}, function (out) {
            var item = '';
            $.each(out.Office_Staff, function (index, off) {
                item += '<option value="' + off.Office.OfficeId + '">' + off.Office.OfficeName + '</option>';
            });
            $('#cboOffice').html(item);
            $('#cboOffice').val("");
        });
    }

    function validateAddCase(validateform) {
        $(validateform).validate({
            errorElement: 'div',
            errorClass: 'help-block',
            focusInvalid: false,
            rules: {
                txtCaseCode: {
                    required: true
                },
                cboOffice: {
                    required: true
                },
                txtCaseContent: {
                    required: true
                }
            },
            messages: {
                txtCaseCode: {
                    required: "Nhập mã hồ sơ!"
                },
                cboOffice: {
                    required: "Chọn văn phòng!",
                },
                txtCaseContent: {
                    required: "Nhập nội dung!",
                }
            },
            highlight: function (e) {
                $(e).closest('.form-group').removeClass('has-info').addClass('has-error');
            },

            success: function (e) {
                $(e).closest('.form-group').removeClass('has-error').addClass('has-info');
                $(e).remove();
            },
            errorPlacement: function (error, element) {
                if (element.is(':checkbox') || element.is(':radio')) {
                    var controls = element.closest('div[class*="col-"]');
                    if (controls.find(':checkbox,:radio').length > 1) controls.append(error);
                    else error.insertAfter(element.nextAll('.lbl:eq(0)').eq(0));
                }
                else error.insertAfter(element.parent());
            }
        });
    }
</script>

<script type="text/javascript">
    jQuery(function ($) {
        $('.date-picker').datepicker({ autoclose: true }).next().on(ace.click_event, function () {
            $(this).prev().focus();
        });

        $('textarea[class*=autosize]').autosize({ append: "\n" });
    });

    jQuery.fn.dataTableExt.oSort['vn_date-asc'] = function (a, b) {
        var ukDatea = a.split('/');
        var ukDateb = b.split('/');

        var x = (ukDatea[2] + ukDatea[1] + ukDatea[0]) * 1;
        var y = (ukDateb[2] + ukDateb[1] + ukDateb[0]) * 1;

        return ((x < y) ? -1 : ((x > y) ? 1 : 0));
    };

    jQuery.fn.dataTableExt.oSort['vn_date-desc'] = function (a, b) {
        var ukDatea = a.split('/');
        var ukDateb = b.split('/');

        var x = (ukDatea[2] + ukDatea[1] + ukDatea[0]) * 1;
        var y = (ukDateb[2] + ukDateb[1] + ukDateb[0]) * 1;

        return ((x < y) ? 1 : ((x > y) ? -1 : 0));
    };
</script>

                            <!-- PAGE CONTENT ENDS -->
                        </div><!-- /.col -->
                    </div><!-- /.row -->
                </div><!-- /.page-content -->
            </div><!-- /.main-content -->

        </div><!-- /.main-container-inner -->

        <a href="#" id="btn-scroll-up" class="btn-scroll-up btn btn-sm btn-inverse">
            <i class="icon-double-angle-up icon-only bigger-110"></i>
        </a>
    </div><!-- /.main-container -->
    


<div class="datepicker datepicker-dropdown dropdown-menu"><div style="display: block;" class="datepicker-days"><table class=" table-condensed"><thead><tr><th style="visibility: visible;" class="prev"><i class="icon-arrow-left"></i></th><th colspan="5" class="switch">Tháng 10 2014</th><th style="visibility: visible;" class="next"><i class="icon-arrow-right"></i></th></tr><tr><th class="dow">CN</th><th class="dow">T2</th><th class="dow">T3</th><th class="dow">T4</th><th class="dow">T5</th><th class="dow">T6</th><th class="dow">T7</th></tr></thead><tbody><tr><td class="day old">28</td><td class="day old">29</td><td class="day old">30</td><td class="day">1</td><td class="day">2</td><td class="day">3</td><td class="day">4</td></tr><tr><td class="day">5</td><td class="day">6</td><td class="day">7</td><td class="day active">8</td><td class="day">9</td><td class="day">10</td><td class="day">11</td></tr><tr><td class="day">12</td><td class="day">13</td><td class="day">14</td><td class="day">15</td><td class="day">16</td><td class="day">17</td><td class="day">18</td></tr><tr><td class="day">19</td><td class="day">20</td><td class="day">21</td><td class="day">22</td><td class="day">23</td><td class="day">24</td><td class="day">25</td></tr><tr><td class="day">26</td><td class="day">27</td><td class="day">28</td><td class="day">29</td><td class="day">30</td><td class="day">31</td><td class="day new">1</td></tr><tr><td class="day new">2</td><td class="day new">3</td><td class="day new">4</td><td class="day new">5</td><td class="day new">6</td><td class="day new">7</td><td class="day new">8</td></tr></tbody><tfoot><tr><th style="display: none;" colspan="7" class="today">Hôm nay</th></tr></tfoot></table></div><div style="display: none;" class="datepicker-months"><table class="table-condensed"><thead><tr><th style="visibility: visible;" class="prev"><i class="icon-arrow-left"></i></th><th colspan="5" class="switch">2014</th><th style="visibility: visible;" class="next"><i class="icon-arrow-right"></i></th></tr></thead><tbody><tr><td colspan="7"><span class="month">Tháng 1</span><span class="month">Tháng 2</span><span class="month">Tháng 3</span><span class="month">Tháng 4</span><span class="month">Tháng 5</span><span class="month">Tháng 6</span><span class="month">Tháng 7</span><span class="month">Tháng 8</span><span class="month">Tháng 9</span><span class="month active">Tháng 10</span><span class="month">Tháng 11</span><span class="month">Tháng 12</span></td></tr></tbody><tfoot><tr><th style="display: none;" colspan="7" class="today">Hôm nay</th></tr></tfoot></table></div><div style="display: none;" class="datepicker-years"><table class="table-condensed"><thead><tr><th style="visibility: visible;" class="prev"><i class="icon-arrow-left"></i></th><th colspan="5" class="switch">2010-2019</th><th style="visibility: visible;" class="next"><i class="icon-arrow-right"></i></th></tr></thead><tbody><tr><td colspan="7"><span class="year old">2009</span><span class="year">2010</span><span class="year">2011</span><span class="year">2012</span><span class="year">2013</span><span class="year active">2014</span><span class="year">2015</span><span class="year">2016</span><span class="year">2017</span><span class="year">2018</span><span class="year">2019</span><span class="year old">2020</span></td></tr></tbody><tfoot><tr><th style="display: none;" colspan="7" class="today">Hôm nay</th></tr></tfoot></table></div></div><textarea class="autosizejs" tabindex="-1" style="position: absolute; top: -999px; left: 0px; right: auto; bottom: auto; border: 0px none; padding: 0px; box-sizing: content-box; word-wrap: break-word; height: 0px ! important; min-height: 0px ! important; overflow: hidden; transition: none 0s ease 0s ; font-family: &quot;Helvetica Neue&quot;,&quot;Segoe UI&quot;,Helvetica,Arial,&quot;Lucida Grande&quot;,sans-serif; font-size: 14px; font-weight: 400; font-style: normal; letter-spacing: 0px; text-transform: none; word-spacing: 0px; text-indent: 0px; line-height: 20px;">
</textarea></body></html>