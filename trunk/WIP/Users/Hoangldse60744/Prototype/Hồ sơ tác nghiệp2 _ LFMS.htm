<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Hồ sơ tác nghiệp | LFMS</title>
    <link href="http://localhost:19442/Content/logo/LFMS-icon-48.png" rel="icon">

    

    <!-- basic styles -->
    <link href="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/main.css" rel="stylesheet" type="text/css">
    <link href="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/bootstrap.css" rel="stylesheet" type="text/css">
    <link href="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/font-awesome.css" rel="stylesheet" type="text/css">

    <!-- ace styles -->
    <link href="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/ace.css" rel="stylesheet" type="text/css">
    <link href="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/ace-rtl.css" rel="stylesheet" type="text/css">
    <link href="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/ace-skins.css" rel="stylesheet" type="text/css">

    <!-- ace settings handler -->
    <script src="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/ace-extra.js" type="text/javascript"></script>

    <!-- basic scripts -->
    <!--[if !IE]> -->
    <script src="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/jquery-2.js" type="text/javascript"></script>
    <!-- <![endif]-->
    <script src="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/main.js" type="text/javascript"></script>

    <!--[if !IE]> -->
    <script type="text/javascript">
        window.jQuery || document.write("<script src='~/Content/js/jquery-2.0.3.min.js'>" + "<" + "/script>");
    </script>
    <!-- <![endif]-->

    <script type="text/javascript">
        if ("ontouchend" in document && document.ontouchend != null) document.write("<script src='~/Content/js/jquery.mobile.custom.min.js'>" + "<" + "/script>");
    </script>
    <script src="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/bootstrap.js" type="text/javascript"></script>

    <!-- ace scripts -->
    <script src="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/ace-elements.js" type="text/javascript"></script>
    <script src="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/ace.js" type="text/javascript"></script>
    <script src="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/md5.js" type="text/javascript"></script>


<style>.cke{visibility:hidden;}</style></head>

<body spellcheck="false">
    <div class="navbar navbar-default" id="navbar">
        <script type="text/javascript">
            try { ace.settings.check('navbar', 'fixed') } catch (e) { }
        </script>

        <div class="navbar-container" id="navbar-container">
            <div class="navbar-header pull-left">
                <a href="http://localhost:19442/Home/Index" class="navbar-brand" title="Trang chủ">
                    <small>
                        <img src="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/LFMS-logo-big.png" style="border: none; height: 22px">
                    </small>
                </a><!-- /.brand -->
            </div><!-- /.navbar-header -->

            <div id="staffIdDiv" value="1" style="display:none"></div>

<div class="navbar-header pull-right" role="navigation">
    <ul class="nav ace-nav">
        <li class="green" id="notificationArea" style="display: block"><a data-toggle="dropdown" class="dropdown-toggle" href="#"><i class="icon-bell-alt icon-animated-bell" id="bellIcon"></i><span class="badge badge-important" id="countCalender1">1</span></a><ul class="pull-right dropdown-navbar dropdown-menu dropdown-caret dropdown-close"><li class="dropdown-header"><i class="icon-calendar"></i>Hôm nay có <span id="countCalender2">1</span> sự kiện</li><li><a><span class="label label-lg label-success" style="margin-right: 10px"><i class="icon-info-sign"></i></span><span class="msg-body"><span class="msg-title" style="font-weight: bold">Gặp anh Nam</span><span class="msg-time"><span> Từ ngày: 19/09/2014</span></span><span class="msg-time"><span> Đến ngày: 20/09/2014</span></span></span></a></li><li></li></ul></li>

        <li class="light-green">
            <a data-toggle="dropdown" href="#" class="dropdown-toggle">
                <img class="nav-user-photo" src="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/thuannh.jpg" alt="">
                <span class="user-info">
                    <small>Xin chào,</small>
                    <p>Nguyễn Hòa Thuận</p>
                </span>

                <i class="icon-caret-down"></i>
            </a>

            <ul class="user-menu pull-right dropdown-menu dropdown-yellow dropdown-caret dropdown-close">
                <li>
                    <a href="http://localhost:19442/Case/ListCase" onclick="">
                        <i class="icon-folder-open"></i>
                        Danh sách hồ sơ
                    </a>
                </li>

                <li class="divider"></li>

                    <li>
                        <a href="http://localhost:19442/Customer/Customer" onclick="">
                            <i class="icon-group"></i>
                            Quản lý khách hàng
                        </a>
                    </li>
                    <li class="divider"></li>
                    <li>
                        <a href="http://localhost:19442/Staff/Staff">
                            <i class="icon-user"></i>
                            Quản lý nhân viên
                        </a>
                    </li>
                    <li class="divider"></li>
                    <li>
                        <a href="http://localhost:19442/Service/Service" onclick="">
                            <i class="icon-cog"></i>
                            Quản lý dịch vụ
                        </a>
                    </li>
                    <li class="divider"></li>
                    <li>
                        <a href="http://localhost:19442/Office/Office">
                            <i class="icon-home"></i>
                            Quản lý văn phòng
                        </a>
                    </li>
                    <li class="divider"></li>
                    <li>
                        <a href="http://localhost:19442/Salary/Salary">
                            <i class=" icon-globe"></i>
                            Quản lí lương nhân viên
                        </a>
                    </li>
                    <li class="divider"></li>
                    <li>
                        <a href="http://localhost:19442/Statistic/Statistic">
                            <i class="icon-home"></i>
                            Thống kê
                        </a>
                    </li>
                     <li class="divider"></li>
                    <li>
                        <a href="http://localhost:19442/OtherCost/OtherCost">
                            <i class="icon-cog"></i>
                            Chi phí khác
                        </a>
                    </li>
                    <li class="divider"></li>

                <li>
                    <a data-toggle="modal" href="#tblPassChange" onclick='$("#PassChangeDiv").appendTo("#bodyChangePass"); validatePassword("#validatPassForm"); clearFieldPassword();'>
                        <i class="icon-key"></i>
                        Đổi mật khẩu
                    </a>
                </li>

                <li class="divider"></li>

                <li>
                    <a href="#" onclick="logOut()">
                        <i class="icon-off"></i>
                        Đăng xuất
                    </a>
                </li>
            </ul>
        </li>
    </ul><!-- /.ace-nav -->
</div><!-- /.navbar-header -->

<script>
    $(document).ready(function () {
        GetCalendarsByStaffId();
    });

    function GetCalendarsByStaffId() {
        $.post("/UserControl/GetCalendarsByStaffId", { staffId: $("#staffIdDiv").attr("value") }, function (out) {
            var item = '<a data-toggle="dropdown" class="dropdown-toggle" href="#"><i class="icon-bell-alt" id="bellIcon"></i><span class="badge badge-success" id="countCalender1"></span></a>';
            item += '<ul class="pull-right dropdown-navbar dropdown-menu dropdown-caret dropdown-close"><li class="dropdown-header"><i class="icon-calendar"></i>Hôm nay có <span id="countCalender2"></span> sự kiện</li>';
            var count = 0;

            $.each(out, function (index, ca) {
                var casecode = "";
                var priority;
                if (typeof (ca.Case) != "undefined") {
                    casecode = " (" + ca.Case.CaseCode + ")";
                    priority = "";
                } else priority = ca.Priority;
                count += 1;

                item += '<li><a>';
                item += '<span class="label label-lg ' + priority + '" style="margin-right: 10px"><i class="icon-info-sign"></i></span>';
                item += '<span class="msg-body">';
                item += '<span class="msg-title" style="font-weight: bold">' + ca.Title + casecode + '</span>';

                var date1 = convertNETDateTime(ca.BeginTime).toLocaleFormat('%d/%m/%Y');
                var time1 = convertNETDateTime(ca.BeginTime).toLocaleTimeString();
                var date2 = convertNETDateTime(ca.EndTime).toLocaleFormat('%d/%m/%Y');
                var time2 = convertNETDateTime(ca.EndTime).toLocaleTimeString();

                if (date1 == date2) {
                    if (time1 == "12:00:00 AM" && time2 == "12:00:00 AM") {
                        item += '<span class="msg-time"><span>Cả ngày</span></span>';
                    } else {
                        item += '<span class="msg-time"><span> Bắt đầu: ' + time1 + '</span></span>';
                        item += '<span class="msg-time"><span> Kết thúc: ' + time2 + '</span></span>';
                    }
                } else {
                    item += '<span class="msg-time"><span> Từ ngày: ' + date1 + '</span></span>';
                    item += '<span class="msg-time"><span> Đến ngày: ' + date2 + '</span></span>';
                }

                item += '</span>'; // span body
                item += '</a></li>';
            });

            item += '<li></li></ul>';
            $('#notificationArea').html(item);
            $('#countCalender1').text(count);
            $('#countCalender2').text(count);

            if (count != 0) {
                $('#countCalender1').attr('class', 'badge badge-important');
                $('#bellIcon').attr('class', 'icon-bell-alt icon-animated-bell');
            }
        });
    }

</script>

<div id="PassChangeDiv">
    <div id="tblPassChange" class="modal fade" tabindex="-1">
        <div class="modal-dialog" style="width: 100%; min-width: 600px; max-width: 600px">
            <div class="modal-content">
                <div class="modal-header no-padding">
                    <div class="table-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                            <span class="white">×</span>
                        </button>
                        Thay đổi mật khẩu
                    </div>
                </div>
                <form class="modal-body no-padding" id="validatPassForm">
                    <div class="modal-body no-padding">
                        <div class="col-xs-12 form-horizontal" style="padding-top: 20px; margin-left: 10px">
                            <div class="row">
                                <div class="form-group col-sm-12">
                                    <label class="col-sm-4 ">Mật khẩu cũ: <span style="color: red"> *</span></label>
                                    <div class="col-sm-8">
                                        
                                        <div>
                                            <input name="Oldpassword" id="Oldpassword" style="width:100%" type="password">
                                        </div>
                                        <div id="checkPass" style="display: none">
                                            <span style="color: #D16E6C">Mật khẩu cũ không đúng ! </span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="form-group col-sm-12">
                                    <label class="col-sm-4 ">Mật khẩu mới: <span style="color: red"> *</span></label>
                                    <div class="col-sm-8">
                                        <div>
                                            <input name="password" id="password" style="width:100%" type="password">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="form-group col-sm-12">
                                    <label class="col-sm-4 ">Lặp lại mật khẩu mới: <span style="color: red"> *</span></label>
                                    <div class="col-sm-8">
                                        <div>
                                            <input name="password2" id="password2" style="width:100%" type="password">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>

                <div class="modal-footer no-margin-top"></div>
                <div class="modal-footer no-margin-top">
                    <button class="btn btn-grey pull-left" type="button" data-dismiss="modal" id="btnCloseChange">
                        <i class="icon-remove"></i>
                        Đóng
                    </button>
                    <button class="btn btn-success" type="button" data-bb-handler="confirm" id="btnUpdatePass" onclick="updateStaffPass()">
                        <i class="icon-ok"></i>
                        Đổi mật khẩu
                    </button>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div>
</div>
<script type="text/javascript">
    function updateStaffPass() {
        if ($('#validatPassForm').valid()) {
            editFr = $('#tblPassChange');
            var oldPassword = $.md5($('#Oldpassword', editFr).val());
            var staffPassword = $.md5($('#password2', editFr).val());
            $.post("/UserControl/UpdateStaffPass", {
                oldPassword: oldPassword, staffPassword2: staffPassword
            }, function (result) {
                if (result == "successful") {
                    $('.close').click();
                    $('#checkPass').attr("style", "display: none");
                    notification("Cập nhật mật khẩu nhân viên thành công!", "", 3000, "btn-primary center");
                } else if (result == 'error') {
                    $('.close').click();
                    $('#checkPass').attr("style", "display: none");
                    notification("Cập nhật mật khẩu nhân viên nhân viên thất bại!", "Hãy kiểm tra lại kết nối database.", 5000, "gritter-error center");
                } else if (result == "notMatch") {
                    $('#checkPass').attr("style", "display: block");
                }
            })
                .error(function () {
                    $('.close').click();
                    $('#checkPass').attr("style", "display: none");
                    notification("Cập nhật mật khẩu nhân viên thất bại", "Hãy kiểm tra lại kết nối database.", 5000, "gritter-error center");
                });
        }
    }

    function validatePassword(validateform) {
        $(validateform).validate({
            errorElement: 'div',
            errorClass: 'help-block',
            focusInvalid: false,
            rules: {
                password: {
                    required: true,
                    alphanumeric: true,
                    minlength: 6


                },
                password2: {
                    required: true,
                    alphanumeric: true,
                    minlength: 6,
                    equalTo: "#password"
                },
                Oldpassword: {
                    required: true,
                    alphanumeric: true
                }
            },
            messages: {
                password: {
                    required: "Hãy nhập mật khẩu mới.",
                    alphanumeric: "Mật khẩu không được có kí tự đặc biệt",
                    minlength: "Mật khẩu mới phải có ít nhất 6 kí tự.",
                },
                password2: {
                    required: "Hãy nhập lại mật khẩu mới.",
                    alphanumeric: "Mật khẩu không được có kí tự đặc biệt",
                    minlength: "Mật khẩu mới phải có ít nhất 6 kí tự.",
                    equalTo: "Mật khẩu 2 không trùng khớp.",
                },
                Oldpassword: {
                    required: "Hãy nhập lại mật khẩu cũ.",
                    alphanumeric: "Mật khẩu không được có kí tự đặc biệt",
                }
            },
            highlight: function (e) {
                $(e).closest('.form-group').removeClass('has-info').addClass('has-error');
            },

            success: function (e) {
                $(e).closest('.form-group').removeClass('has-error').addClass('has-info');
                $(e).remove();
            },
            errorPlacement: function (error, element) {
                if (element.is(':checkbox') || element.is(':radio')) {
                    var controls = element.closest('div[class*="col-"]');
                    if (controls.find(':checkbox,:radio').length > 1) controls.append(error);
                    else error.insertAfter(element.nextAll('.lbl:eq(0)').eq(0));
                }
                else error.insertAfter(element.parent());
            }
        });
    }

    function clearFieldPassword() {
        editFr = $('#tblPassChange');
        $('#Oldpassword', editFr).val("");
        $('#password', editFr).val("");
        $('#password2', editFr).val("");

    }

    function logOut() {
        $.post("/Login/LogOut", {}, function (out) {
            if (out != "success") {
                alert(out);
            }
            window.location = ("/Login/Login");
        });
    }
</script>


        </div><!-- /.container -->
    </div>

    <div class="main-container" id="main-container">
        <script type="text/javascript">
            try { ace.settings.check('main-container', 'fixed') } catch (e) { }
        </script>

        <div class="main-container-inner">
            <a class="menu-toggler" id="menu-toggler" href="#">
                <span class="menu-text"></span>
            </a>


    <div class=" sidebar" id="sidebar">
        <script type="text/javascript">
            try { ace.settings.check('sidebar', 'fixed') } catch (e) { }
        </script>

        <ul class="nav nav-list">
            <li class="" id="liCaseDetail" onclick='getCaseDetail("3")'>
                <a href="#" onclick="setLiActiveClass('#liCaseDetail')">
                    <i class="icon-edit"></i>
                    <span class="menu-text"> Chi tiết hồ sơ </span>
                </a>
            </li>

            <li class="active" id="liCaseEvent" onclick='getCaseEvent("3")'>
                <a href="#" onclick="setLiActiveClass('#liCaseEvent')">
                    <i class="icon-calendar"></i>
                    <span class="menu-text"> Sự kiện </span>
                </a>
            </li>

            <li class="" id="liCasePeople" onclick='getPeople("3")'>
                <a href="#" onclick="setLiActiveClass('#liCasePeople')">
                    <i class="icon-group"></i>
                    <span class="menu-text"> Người liên quan </span>
                </a>
            </li>

            <li class="" id="liCaseFile" onclick="getFiles()">
                <a href="#" onclick="setLiActiveClass('#liCaseFile')">
                    <i class="icon-book"></i>
                    <span class="menu-text"> Tài liệu liên quan </span>
                </a>
            </li>

            <li class="" id="liCaseInvoice" onclick='getCost("3")'>
                <a href="#" onclick="setLiActiveClass('#liCaseInvoice')">
                    <i class="icon-credit-card"></i>
                    <span class="menu-text"> Hóa đơn </span>
                </a>
            </li>
        </ul><!-- /.nav-list -->

        <div class="sidebar-collapse" id="sidebar-collapse">
            <i class="icon-double-angle-left" data-icon1="icon-double-angle-left" data-icon2="icon-double-angle-right"></i>
        </div>

        <script type="text/javascript">
            try { ace.settings.check('sidebar', 'collapsed') } catch (e) { }
        </script>
    </div>

            <div class="main-content">

    <div class="breadcrumbs" id="breadcrumbs">
        <script type="text/javascript">
            try { ace.settings.check('breadcrumbs', 'fixed') } catch (e) { }
        </script>

        <ul class="breadcrumb">
            <li>
                <i class="icon-home home-icon"></i>
                <a href="http://localhost:19442/Home/Index">Trang chủ</a> | Hồ sơ tác nghiệp
            </li>

            <li>
                <a href="http://localhost:19442/Case/ListCase">Danh sách hồ sơ</a>
            </li>

            <li>
                <span id="breadcrumbsCaseCode" style="font-weight: bold">DSST2014001</span>
            </li>
        </ul><!-- .breadcrumb -->


        <div style="position: absolute; right: 0; top:0;margin-right: 20px">
            <div id="searchBtn" style="position: absolute; right: 0; top:0">
                <button class="btn btn-sm btn-warning">
                    <i class="icon-arrow-left icon-on-right"></i>
                    <span class="bigger-110 no-text-shadow">Thư Viện</span>
                </button>
            </div>

            <div id="searchtvplContent" style="margin-top:5px">

                <div class=" widget-box transparent ">
                    <div class="widget-header">
                        <div class="widget-toolbar no-border" style="float:left;width:100%">
                            <ul id="tabSearchtvpl" class="nav nav-tabs" style="font-size: 15px;">
                                <p style="float: left; margin: 0px 10px 0px 25px; font-size: 18px; font-weight: bold; color: blue">Tra cứu : </p>
                                <li class="active" id="vbplLi" onclick="changeSearch(this)">
                                    <a href="#" style="font-weight: bold;">VĂN BẢN PHÁP LUẬT</a>
                                </li>

                                <li id="cvLi" onclick="changeSearch(this)">
                                    <a href="#">CÔNG VĂN</a>
                                </li>
                                <li id="tcvnLi" onclick="changeSearch(this)">
                                    <a href="#">TIÊU CHUẨN VIỆT NAM</a>
                                </li>
                            </ul>
                        </div>
                    </div>

                    <div class="widget-body" style=" padding-left: 10%">
                        <p style="font-size: 9px; color: Gray; margin: 0;line-height: 20px">
                            Từ khoá: <strong>Số Hiệu, Tiêu đề</strong> hoặc <strong>Nội dung ngắn gọn</strong>
                            của Văn Bản...
                        </p>
                        <div class="input-group" style="width:70%;">
                            <input id="searchText" class="form-control" placeholder="Tìm kiếm văn bản pháp luật..." type="text">
                            <span class="input-group-btn">
                                <button type="button" class="btn btn-sm btn-info no-radius" id="searchDocBtn" onclick="searchKeyWord()">
                                    <i class="icon-search"></i>
                                    Tìm Kiếm
                                </button>
                            </span>
                            <div id="searchWait" style="margin-left: 20px; visibility: hidden"><i class="icon-spinner icon-spin orange bigger-200"></i></div>
                        </div>
                        <table style=" line-height: 20px; font-size: 12px; width:80% " border="0" cellpadding="2" cellspacing="2">
                            <tbody>

                                <tr id="searchArea">
                                    <td width="100px"> <span class="info-blue">Tìm trong: </span></td>
                                    <td style="padding-right: 10px"> <input checked="checked" id="RadioGroup1_0" value="0" name="RadioGroup" type="radio">  Tất cả</td>
                                    <td style="padding-right: 10px"> <input id="RadioGroup1_1" value="1" name="RadioGroup" type="radio">  Tiêu đề văn bản</td>
                                    <td style="padding-right: 10px"> <input id="RadioGroup1_2" value="2" name="RadioGroup" type="radio">  Số hiệu văn bản</td>
                                </tr>
                                <tr id="searchArea">
                                    <td> <span class="info-blue">Ban hành từ: </span></td>
                                    <td colspan="4">

                                        <input value="01/01/1945 đến 19/09/2014" class="form-control" id="id-date-range-picker" readonly="readonly" style="font-size: 12px; height:25px;cursor: pointer; background: none repeat scroll 0 0 #fff !important" type="text">
                                    </td>
                                    <td align="right" width="200px">
                                        <span id="hideSearchMethodBtn" style="cursor: pointer; color: Blue; font-weight: bold;" onclick="hideSearchMethod()">+ Thêm điều kiện</span>
                                    </td>

                                </tr>
                                <tr style="display: none;" id="searchMath" class="hideSearch">
                                    <td> <span class="info-blue">Kết quả phải:</span>   </td>
                                    <td colspan="4">
                                        <input checked="checked" id="RadioGroup1_True" value="True" name="RadioGroup1" type="radio">   Có tất cả các từ trên
                                        <input style="margin-left: 20px;" id="RadioGroup1_False" value="False" name="RadioGroup1" type="radio"> Chính xác cụm từ trên
                                    </td>
                                </tr>

                                <tr style="display: none;" class="info-blue hideSearch" id="trStatus">
                                    <td class="vbpl-tcvn">  Loại Văn bản: </td>
                                    <td colspan="4" class="vbpl-tcvn">
                                        <select style="width: 80%; height: 25px; " class="dropdown-large" id="documentTypeDropDownListVbpl">
                                            <option value="0" selected="selected">Tất cả</option>
                                            <option value="1">Chỉ thị</option>
                                            <option value="31">Điều ước quốc tế</option>
                                            <option value="6">Hiến pháp</option>
                                            <option value="34">Lệnh</option>
                                            <option value="10">Luật</option>
                                            <option value="11">Nghị định</option>
                                            <option value="13">Nghị quyết</option>
                                            <option value="14">Pháp lệnh</option>
                                            <option value="17">Quyết định</option>
                                            <option value="18">Sắc lệnh</option>
                                            <option value="23">Thông tư</option>
                                            <option value="24">Thông tư liên tịch</option>
                                            <option value="40">Văn bản hợp nhất</option>
                                            <option value="33">Văn bản khác</option>
                                            <option value="32">Văn bản WTO</option>
                                        </select>
                                        <select style="width: 80%; height: 25px; display:none" class="dropdown-large" id="documentTypeDropDownListTcvn">
                                            <option value="39" selected="selected">Tất cả</option>
                                            <option value="35">Quy chuẩn</option>
                                            <option value="38">Tiêu chuẩn ngành</option>
                                            <option value="36">Tiêu chuẩn Việt Nam</option>
                                            <option value="37">Tiêu chuẩn XDVN</option>
                                        </select>

                                        <span id="bLocStatus" style="margin-left:10px">Tình trạng:</span>
                                    </td>

                                    <td colspan="4" class="vbpl-tcvn">
                                        <select style="width: 100%; height: 25px; " id="ddlStatus" name="ddlStatus">
                                            <option value="0" selected="selected">Tất cả</option>
                                            <option value="1">Còn hiệu lực</option>
                                            <option value="2">Hết hiệu lực</option>
                                            <option value="3">Không còn phù hợp</option>
                                            <option value="4">Không xác định</option>
                                        </select>
                                    </td>

                                </tr>

                                <tr style="display: none;" class="hideSearch">
                                    <td>
                                        <span class="info-blue">Sắp xếp theo:</span>
                                    </td>
                                    <td colspan="4">
                                        <select style="width: 80%; height: 25px; " class="dropdown-large" id="sortDropDownList" name="sortDropDownList">
                                            <option selected="selected" value="1">Văn bản chính xác sẽ nằm trên</option>
                                            <option value="2">Văn bản mới ban hành sẽ nằm trên</option>
                                            <option value="6">Văn bản mới ban hành sẽ nằm dưới</option>

                                        </select>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div id="searchResult" style="width: 100%; height: 100%; line-height: 10px;">

                    </div>

                </div>
            </div>
        </div>

    </div>

                <div class="page-content">
                    <div class="row">
                        <div class="col-xs-12">
                            <!-- PAGE CONTENT BEGINS -->
                            

<link rel="stylesheet" href="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/jquery.css">
<link rel="stylesheet" href="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/chosen.css">
<link rel="stylesheet" href="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/datepicker.css">
<link rel="stylesheet" href="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/bootstrap.css">
<link rel="stylesheet" href="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/ace.css">
<link rel="stylesheet" href="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/font-awesome.css">

<link rel="stylesheet" href="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/screen.css">
<link rel="stylesheet" href="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/daterangepicker-bs3.css">
<link rel="stylesheet" href="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/jquery_002.css">
<link rel="stylesheet" href="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/jquery-ui-1.css">

<script src="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/ckeditor.js" type="text/javascript"></script>
<script src="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/ckfinder.js" type="text/javascript"></script>

<script src="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/jquery-ui-1.js" type="text/javascript"></script>
<script src="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/moment.js" type="text/javascript"></script>
<script src="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/timeliner.js" type="text/javascript"></script>
<script src="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/bootbox.js" type="text/javascript"></script>
<script src="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/jquery_008.js" type="text/javascript"></script>

<script src="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/jquery_002.js" type="text/javascript"></script>
<script src="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/jquery_006.js" type="text/javascript"></script>
<script src="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/bootstrap-datepicker.js" type="text/javascript"></script>
<script src="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/daterangepicker.js" type="text/javascript"></script>

<script src="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/jquery_009.js" type="text/javascript"></script>
<script src="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/fuelux.js" type="text/javascript"></script>
<script src="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/jquery.js" type="text/javascript"></script>
<script src="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/jquery_004.js" type="text/javascript"></script>
<script src="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/chosen.js" type="text/javascript"></script>
<script src="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/jquery_003.js"></script>
<script src="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/additional-methods.js"></script>

<script src="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/jquery_005.js"></script>
<script src="H%E1%BB%93%20s%C6%A1%20t%C3%A1c%20nghi%E1%BB%87p2%20_%20LFMS_files/jquery_007.js"></script>


<div id="reviewPopup" class="modal fade" tabindex="-1">
    <div class="modal-dialog" style="width:800px">
        <div class="modal-content">

            <div class="modal-header no-padding">
                <div class="table-header">
                    <button aria-hidden="true" data-dismiss="modal" class="close" type="button">
                        <span class="white">×</span>
                    </button>
                    Xem trước nội dung văn bản:
                </div>
            </div>
            <div style="min-height:100px">
                <div class="center">
                    <i id="reviewWait" class="icon-spinner icon-spin orange bigger-300" style="margin-top:20px"></i>
                </div>
                <div id="reviewContent">

                </div>
            </div>
            <div class="modal-footer no-margin-top">
                <button class="btn btn-default pull-left" type="button" data-dismiss="modal" id="reviewClose">
                    <i class="icon-remove"></i>
                    Đóng
                </button>

            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>
<div id="caseIdDiv" value="3" style="display:none"></div>
<div id="staffRoleIdDiv" value="1" style="display:none"></div>
<div id="IsAuthorize" value="true" style="display:none"></div>
<div id="StatusDiv" value="Đang thụ lý" style="display:none"></div>
<div id="OfficeStatusDiv" value="true" style="display:none"></div>

<div id="CanEditLawyer" value="true" style="display:none"></div>
<div id="StaffIdDiv" value="1" style="display:none"></div>
<div id="StaffNameDiv" value="Nguyễn Hòa Thuận" style="display:none"></div>


<div id="bodyChangePass">

</div>

<div class="col-sm-12 widget-container-span" style="display: none" id="peopleContent">
    <div class="widget-box transparent">
        <div class="widget-header">
            <div class="widget-toolbar no-border">
                <ul class="nav nav-tabs" id="myTab2">
                    <li id="lawyerLi" class="active">
                        <a href="#" onclick="GetLawyerRelated(3, false)">Luật sư</a>
                    </li>

                    <li id="customerLi">
                        <a href="#" onclick="GetCustomerRelated(3, false)">Khách hàng</a>
                    </li>

                    <li id="subjectLi">
                        <a href="#" onclick="GetSubjectRelated(3, false)">Chủ thể</a>
                    </li>
                </ul>
            </div>
        </div>

        <div class="widget-body">
            <div class="widget-main padding-12 no-padding-left no-padding-right">
                <div class="padding-4" id="subPeopleContent">

                </div>
            </div>
        </div>
    </div>
</div>

<div id="bodyContent">

<div class="widget-box transparent">
    <div class="widget-header">
        <div class="widget-toolbar no-border">
            <ul class="nav nav-tabs">
                <li id="sktnLi" class="active">
                    <a style="font-weight: bold;" onclick='showTabEvent("sktn")' href="#">Sự kiện tác nghiệp</a>
                </li>
                <li class="" id="qdlsLi">
                    <a onclick='showTabEvent("qdls")' style="" href="#">Quan điểm luật sư</a>
                </li>

            

            </ul>
        </div>
    </div>


    <div class="widget-body">
        <div class="space-6"></div>
        <div style="display: none;" id="tabQDLSDiv">
            <h3 class="header smaller lighter green">
                <span data-rel="tooltip" data-original-title="Sửa quan điểm luật sư" title="" class="tooltip-info">
                    <i id="editViewpoint" class="icon-edit bigger-160" onclick="setActiveComponentViewpoint()" style="cursor: pointer"></i>
                </span>
                Quan điểm luật sư
            </h3>

            <div class="row" style="margin: 20px auto 20px 100px">
                <div class="col-sm-10">
                    <div class="col-sm-6">
                        <label>Mục tiêu bảo vệ</label>
                        <textarea id="txtProtectiveGoal" class="autosize-transition form-control" style="resize: none; overflow: hidden; word-wrap: break-word; height: 212px;" disabled="disabled">Buộc
 bị đơn trả lại cho nguyên đơn những tài sản sau đây: 

Trả lại toàn bộ nhà đất tọa lạc ấp Cẩm Sơn, xã Xuân Mỹ, huyện Cẩm Mỹ 
theo giấy chứng nhận quyền sử dụng đất và quyền sở hữu nhà số K303571 do
 UBND huyện Long Khánh cấp ngày 14.4.1997 với diện tích còn lại sau thu 
hồi là 1.085,5 m2 theo bản vẽ hiện trạng ngày 28/8/2011</textarea>
                    </div>
                    <div class="col-sm-6">
                        <label>Phần thủ tục bắt đầu</label>
                        <textarea id="txtOpeningProcedure" class="autosize-transition form-control" style="resize: none; overflow: hidden; word-wrap: break-word; height: 52px;" disabled="disabled"></textarea>
                    </div>
                </div>

                <div class="col-sm-10 space"></div>

                <div class="col-sm-10">
                    <div class="col-sm-6">
                        <label>Phần thủ tục xét hỏi</label>
                        <textarea id="txtInquiryProcedure" class="autosize-transition form-control" style="resize: none; overflow: hidden; word-wrap: break-word; height: 52px;" disabled="disabled"></textarea>
                    </div>
                    <div class="col-sm-6">
                        <label>Phần tranh luận</label>
                        <textarea id="txtArgumentProcedure" class="autosize-transition form-control" style="resize: none; overflow: hidden; word-wrap: break-word; height: 52px;" disabled="disabled"></textarea>
                    </div>
                </div>

                <div class="col-sm-10 space"></div>

                <div class="col-sm-10" id="divButtonUpdateViewpoint" style="display: none" align="right">
                    <button id="btnCancelUpdateViewpoint" class="btn btn-grey" type="button" onclick="cancelUpdateViewpoint()">
                        <i class="icon-remove"></i>
                        Hủy chỉnh sửa
                    </button>
                    <button id="btnUpdateViewpoint" class="btn btn-success" type="button" onclick="updateViewpoint()">
                        <i class="icon-ok"></i>
                        Lưu chỉnh sửa
                    </button>
                </div>
            </div>
        </div>
        
        <div id="tabSKTNDiv" style="">
            <h3 class="header smaller lighter green">
                <span data-original-title="Sửa sự kiện tác nghiệp" data-rel="tooltip" title="" class="tooltip-info">
                    <i id="editEventi" class="icon-edit bigger-160" onclick="editableEvent()" style="cursor: pointer"></i>
                </span>
                Sự kiện tác nghiệp
            </h3>

            <div class="timeline">
                <div class="timelineContainer" id="timelineEvent">
                    <div class="timelineToggle">
                        <p><a class="expandAll">+ Mở Rộng</a></p>
                    </div>
                <div class="timelineMajor" id="caseEvent1009" creatorid="1"><h2 class="timelineMajorMarker"><span>Thu thập thông tin hồ sơ án</span><span style="display:none">22/09/2010 00:00 đến 22/09/2010 00:00</span></h2><dl class="timelineMinor"><dt class="dt-time" id="8dt"> <a style="font-size: 1em; text-decoration:none"><div class="dateArea">22/09/2010</div> <div class="timeArea">00:00</div><span style="font-size: 25px">➦</span><div class="dateArea">22/09/2010</div> <div class="timeArea">00:00</div></a></dt><dt>  <span>Luật sư phụ trách:</span> <span style="font-weight: bold">Nguyễn Hòa Thuận</span></dt><div style="font-size: 14px;margin-left:70%;margin-bottom:10px"></div><dd style="display: none;" id="8dtEX" class="timelineEvent"><div id="content1009">Khoảng năm 1992 – 1997, bà Hoa bỏ tiền mua thửa đất có diện tích 1.211 m<sup>2</sup> nằm dọc quốc lộ 56 tọa lạc tại ấp Cẩm Sơn, xã Xuân Mỹ, huyện Cẩm Mỹ, Đồng Nai, trên đất có một căn nhà nát.<br>
Quá trình tìm đất do chị gái của bà Hoa là bà Thuý và anh rể của bà Hoa 
là ông Lượng tìm, khi chọn được đất thì bà Hoa là người đứng ra mặc cả 
giá cả với bên bán, giá mua bán được thống nhất là 5,3 cây vàng.<br>
Bà Hoa gửi vàng cho mẹ - bà Nguyễn Thị Phái để đưa cho ông Lượng, bà Thúy trả tiền mua đất.<br>
Sau khi mua bà Hoa để cho ông Lượng, bà Thuý đứng tên chủ quyền nhà, đất
 và được hưởng hoa lợi từ việc thu hoạch hoa màu, khi cần lấy lại nhà, 
đất thì ông Lượng, bà Thuý giao nhà, đất. Đất đã được Ubnd huyện Long 
Khánh cấp giấy chứng nhận quyền sử dụng số K 303571 ngày 14/4/1997.<br>
Vì là chị em ruột trong gia đình nên thỏa thuận nêu trên không được lập 
thành văn bản nhưng anh em trong gia đình đều biết rõ sự việc.<br>
Sau khi mua nhà, đất xong thì bà Hoa mua vật tư về xây dựng lại căn nhà.
 Vật tư được mua tại cửa hàng vật tư Hồng Phước do bà Nguyễn Thị Thanh 
Lan – em gái bà Hoa làm chủ với số tiền 100.000.000 đồng tương đương với
 21 cây vàng lúc bấy giờ.<br>
&nbsp;<br>
Năm 2005 bà Hoa mua tiếp 02 thửa đất của ông Ngô Văn Dũng với tổng diện tích 21.500 m<sup>2</sup> tọa lạc tại ấp Tân Hòa, xã Bảo Bình, huyện Cẩm Mỹ, tỉnh Đồng Nai.<br>
Giá mua bán được thỏa thuận là 358.000.000 đồng, lệ phí sang tên trước bạ là 6.000.000 đồng được chia đôi mỗi bên chịu một nữa.<br>
Ngày 25/04/2005 bà Hoa trực tiếp giao 200.000.000 đồng tại nhà anh Dũng –
 bên bán, có anh Hiển là anh của anh Dũng viết giấy nhận tiền và vẽ sơ 
đồ vị trí tứ cận của khu đất <em>[hiện do bà Thúy giữ]</em>.<br>
Lần giao tiền thứ hai với số tiền 161.000.000 đồng <em>(bao gồm cả lệ phí sang tên trước bạ)</em> cũng do bà Hoa trực tiếp giao cho vợ chồng anh Dũng tại nhà ông Lượng, bà Thuý.<br>
Bà Hoa cũng để cho ông Lượng, bà Thúy đứng tên quyền sử dụng đối với 02 
thửa đất này và cũng được hưởng hoa lợi từ việc thu hoạch cà phê, điều 
trên đất.<br>
Hai thửa đất được UBND huyện Cẩm Mỹ cấp giấy chứng nhận quyền sử dụng số AC 600723 với diện tích 8.770 m<sup>2</sup> và AC 600724 với diện tích 12.730 m<sup>2</sup> cùng ngày 13/06/2005.<br>
&nbsp;<br>
Tháng 11/2006 bà Hoa biết được ông Lượng, bà Thúy đã nhận tiền đền bù 
giải tỏa mở rộng quốc lộ 56 với số tiền 76.500.000 đồng nhưng ông Lượng,
 bà Thúy không báo cho bà Hoa biết.<br>
Đến khi bà Hoa hỏi thì bà Thúy chỉ trả lại cho bà Hoa 30.000.000 đồng.<br>
Lần 1 trả 20.000.000 đồng vào ngày 16/11/2006 do bà Thúy trả trực tiếp 
cho bà Hoa tại nhà bà Thuý, lần 2 trả vào ngày 20/12/2006 với số tiền 
20.000.000 đồng (trong đó có 10.000.000 đồng tiền bà Thúy mượn để mua 
máy bơm nước tưới cà phê) do con trai bà Thuý cầm tiền đến nhà bà Hoa ở 
52 Đinh Bộ Lĩnh, quận Bình Thạnh để trả.<br>
Sau đó bà Hoa yêu cầu ông Lượng, bà Thúy giao trả nhà, đất ở và 2 thửa đất nông nghiệp.<br>
Quá trình hòa giải tại gia đình và tại UBND xã Xuân Mỹ thì ông Lượng, bà
 Thúy chỉ đồng ý giao trả và làm thủ tục sang tên đối với 2 thửa đất 
nông nghiệp tại xã Bảo Bình.<br>
Còn nhà và đất ở thì chưa đồng ý vì ông Lượng, bà Thúy cho rằng số tiền 
200.000.000 đồng bà Hoa hỗ trợ không đủ để mua đất khác ở.<br>
Ngày 26/10/2007, bà Hoa làm đơn kiện bà Thúy, ông Lượng ra trước Tand huyện Cẩm Mỹ.</div></dd></dl><div id="editor1009"></div></div><div class="timelineMajor" id="caseEvent1" creatorid="1"><h2 class="timelineMajorMarker"><span>Khởi kiện</span><span style="display:none">26/10/2010 00:00 đến 26/10/2010 00:00</span></h2><dl class="timelineMinor"><dt class="dt-time" id="0dt"> <a style="font-size: 1em; text-decoration:none"><div class="dateArea">26/10/2010</div> <div class="timeArea">00:00</div><span style="font-size: 25px">➦</span><div class="dateArea">26/10/2010</div> <div class="timeArea">00:00</div></a></dt><dt>  <span>Luật sư phụ trách:</span> <span style="font-weight: bold">Nguyễn Hòa Thuận</span></dt><div style="font-size: 14px;margin-left:70%;margin-bottom:10px"></div><dd style="display: none;" id="0dtEX" class="timelineEvent"><div id="content1">Xác định lại yêu cầu khởi kiện</div></dd></dl><div id="editor1"></div></div><div class="timelineMajor" id="caseEvent2" creatorid="1"><h2 class="timelineMajorMarker"><span>Phản tố</span><span style="display:none">03/01/2011 00:00 đến 03/01/2011 00:00</span></h2><dl class="timelineMinor"><dt class="dt-time" id="1dt"> <a style="font-size: 1em; text-decoration:none"><div class="dateArea">03/01/2011</div> <div class="timeArea">00:00</div><span style="font-size: 25px">➦</span><div class="dateArea">03/01/2011</div> <div class="timeArea">00:00</div></a></dt><dt>  <span>Luật sư phụ trách:</span> <span style="font-weight: bold">Nguyễn Hòa Thuận</span></dt><div style="font-size: 14px;margin-left:70%;margin-bottom:10px"></div><dd style="display: none;" id="1dtEX" class="timelineEvent"><div id="content2">Bút lục 62
<ol>
	<li>Bà Huệ trả lại 3 sổ đỏ đang chiếm giữ;</li>
	<li>Bà Huệ trả lại 30 triệu đồng đã cho mượn;</li>
	<li>Đồng ý trả lại số tiền 358 triệu đồng đã mượn của bà Huệ.</li>
</ol>
Không đồng ý tất cả các yêu cầu của nguyên đơn - bà Huệ</div></dd></dl><div id="editor2"></div></div><div class="timelineMajor" id="caseEvent3" creatorid="1"><h2 class="timelineMajorMarker"><span>Đối chất</span><span style="display:none">27/06/2013 00:00 đến 27/06/2013 00:00</span></h2><dl class="timelineMinor"><dt class="dt-time" id="2dt"> <a style="font-size: 1em; text-decoration:none"><div class="dateArea">27/06/2013</div> <div class="timeArea">00:00</div><span style="font-size: 25px">➦</span><div class="dateArea">27/06/2013</div> <div class="timeArea">00:00</div></a></dt><dt>  <span>Luật sư phụ trách:</span> <span style="font-weight: bold">Nguyễn Hòa Thuận</span></dt><div style="font-size: 14px;margin-left:70%;margin-bottom:10px"></div><dd style="display: none;" id="2dtEX" class="timelineEvent"><div id="content3">Các
 bên giữ nguyên ý kiến. Các con của bị đơn chỉ có công sức đóng góp cho 
gia đình trong thời gian chung sống nhưng không phải là đóng góp để tạo 
dựng tài sản mà chỉ là đóng góp phụ giúp cha mẹ công việc gia đình nên 
không yêu cầu gì.</div></dd></dl><div id="editor3"></div></div><div class="timelineMajor" id="caseEvent4" creatorid="5"><h2 class="timelineMajorMarker"><span>Kết quả xác minh</span><span style="display:none">16/07/2013 00:00 đến 16/07/2013 00:00</span></h2><dl class="timelineMinor"><dt class="dt-time" id="3dt"> <a style="font-size: 1em; text-decoration:none"><div class="dateArea">16/07/2013</div> <div class="timeArea">00:00</div><span style="font-size: 25px">➦</span><div class="dateArea">16/07/2013</div> <div class="timeArea">00:00</div></a></dt><dt>  <span>Luật sư phụ trách:</span> <span style="font-weight: bold">Nguyễn Hữu Tiếng</span></dt><div style="font-size: 14px;margin-left:70%;margin-bottom:10px"></div><dd style="display: none;" id="3dtEX" class="timelineEvent"><div id="content4">Biên bản xác minh ngày 16/7/2008 với ông Trần Công Đồng – chuyên viên Chi cục thuế huyện Cẩm Mỹ:
<ul>
	<li>Diện tích do ông Ngân kê khai ngày 30/10/1992 không được rõ vì có dấu hiệu tẩy xóa;</li>
	<li>Biên lai số 053538 lập ngày 30/10/1992 của Ubnd xã Xuân Mỹ là tiền phúc lợi xã hội, không liên quan tiền thuế đất</li>
</ul>
</div></dd></dl><div id="editor4"></div></div><div class="timelineMajor" id="caseEvent5" creatorid="5"><h2 class="timelineMajorMarker"><span>Kết quả giám định</span><span style="display:none">14/08/2013 00:00 đến 14/08/2013 00:00</span></h2><dl class="timelineMinor"><dt class="dt-time" id="4dt"> <a style="font-size: 1em; text-decoration:none"><div class="dateArea">14/08/2013</div> <div class="timeArea">00:00</div><span style="font-size: 25px">➦</span><div class="dateArea">14/08/2013</div> <div class="timeArea">00:00</div></a></dt><dt>  <span>Luật sư phụ trách:</span> <span style="font-weight: bold">Nguyễn Hữu Tiếng</span></dt><div style="font-size: 14px;margin-left:70%;margin-bottom:10px"></div><dd style="display: none;" id="4dtEX" class="timelineEvent"><div id="content5"><strong>Định giá</strong>:<br>
Biên bản định giá ngày 07/10/2010 và điều chỉnh kết quả định giá tại ấp Cẩm Sơn, xã Xuân Mỹ, huyện Cẩm Mỹ, Đồng Nai:
<ul>
	<li>Cây trồng: 2.782.000 đ</li>
	<li>Nhà ở chính: 140.587.000 đ</li>
	<li>Nhà ở (con gái): 12.916.000 đ</li>
	<li>Nhà kho: 6.556.000 đ</li>
	<li>Hàng rào: 6.540.000 đ</li>
	<li>Mái hiên che tạm: 3.350.000 đ</li>
	<li>Nền xi măng dưới mái hiên: 1.005.000 đ</li>
	<li>Giếng dùng chung: 984.000 đ</li>
	<li>Đất (2 thửa): 399.020.000 đ</li>
</ul>
Tổng giá trị tài sản: <strong>573.740.000 đ</strong><br>
&nbsp;<br>
Biên bản định giá ngày 07/10/2010 và điều chỉnh kết quả định giá tại ấp Tân Hòa, xã Bảo Bình, huyện Cẩm Mỹ, Đồng Nai:
<ul>
	<li>Nhà ở: 11.382.000 đ</li>
	<li>Chái bếp: 1.875.000 đ</li>
	<li>Tường: 720.000 đ</li>
	<li>Cây trồng: 221.762.500 đ</li>
	<li>Giếng: 6.060.000 đ</li>
	<li>Đất: 645.000.000 đ</li>
</ul>
Tổng giá trị tài sản: <strong>886.799.500 </strong></div></dd></dl><div id="editor5"></div></div><div class="timelineMajor" id="caseEvent6" creatorid="1"><h2 class="timelineMajorMarker"><span>Hòa giải</span><span style="display:none">04/11/2013 00:00 đến 04/11/2013 00:00</span></h2><dl class="timelineMinor"><dt class="dt-time" id="5dt"> <a style="font-size: 1em; text-decoration:none"><div class="dateArea">04/11/2013</div> <div class="timeArea">00:00</div><span style="font-size: 25px">➦</span><div class="dateArea">04/11/2013</div> <div class="timeArea">00:00</div></a></dt><dt>  <span>Luật sư phụ trách:</span> <span style="font-weight: bold">Nguyễn Hòa Thuận</span></dt><div style="font-size: 14px;margin-left:70%;margin-bottom:10px"></div><dd style="display: none;" id="5dtEX" class="timelineEvent"><div id="content6">Hoãn phiên hòa giải vì bị đơn, đại diện bị đơn, ông Lý và 7 người con bị đơn vắng mặt.<br>
Hòa giải không thành</div></dd></dl><div id="editor6"></div></div><div class="timelineMajor" id="caseEvent7" creatorid="1"><h2 class="timelineMajorMarker"><span>QĐXX sơ thẩm</span><span style="display:none">30/11/2013 00:00 đến 30/11/2013 00:00</span></h2><dl class="timelineMinor"><dt class="dt-time" id="6dt"> <a style="font-size: 1em; text-decoration:none"><div class="dateArea">30/11/2013</div> <div class="timeArea">00:00</div><span style="font-size: 25px">➦</span><div class="dateArea">30/11/2013</div> <div class="timeArea">00:00</div></a></dt><dt>  <span>Luật sư phụ trách:</span> <span style="font-weight: bold">Nguyễn Hòa Thuận</span></dt><div style="font-size: 14px;margin-left:70%;margin-bottom:10px"></div><dd style="display: none;" id="6dtEX" class="timelineEvent"><div id="content7">Quyết định đưa vụ án ra xét xử số 86/2010/DSST-QĐ mở phiên tòa lúc 13 giờ 30 phút ngày 29/12/2013</div></dd></dl><div id="editor7"></div></div><div class="timelineMajor" id="caseEvent8" creatorid="1"><h2 class="timelineMajorMarker"><span>Phiên tòa sơ thẩm</span><span style="display:none">29/12/2013 00:00 đến 29/12/2013 00:00</span></h2><dl class="timelineMinor"><dt class="dt-time" id="7dt"> <a style="font-size: 1em; text-decoration:none"><div class="dateArea">29/12/2013</div> <div class="timeArea">00:00</div><span style="font-size: 25px">➦</span><div class="dateArea">29/12/2013</div> <div class="timeArea">00:00</div></a></dt><dt>  <span>Luật sư phụ trách:</span> <span style="font-weight: bold">Nguyễn Hòa Thuận</span></dt><div style="font-size: 14px;margin-left:70%;margin-bottom:10px"></div><dd style="display: none;" id="7dtEX" class="timelineEvent"><div id="content8">Hoãn vì những người liên quan là các con ông Ngân, bà Thúy vắng mặt</div></dd></dl><div id="editor8"></div></div><br class="clear"></div>
            </div>

            <div id="newEventDiv" class="timeline" style="width: 80%;">
                <div id="titleEventInputDiv" style="width: 45%; display: none">
                    <input style="width: 100%;font-size: 20px;height: 35px;margin-bottom: 10px;" maxlength="100" placeholder="Tiêu đề sự kiện..." id="titleEventInput" type="text">
                </div>
                <div id="newEditorDiv" style="display:none">

                </div>
            </div>


            <div id="successDiv">
                <button style="display: none" id="addEventBtn" class="blue btn btn-primary" onclick="addEvent()">
                    <i class="icon-plus"></i>
                    Thêm sự kiện
                </button>

                <button style="float:right;display: none" id="successBtn" class="invoiceTd blue btn btn-success" onclick="successEditEvent()">
                    <i class="icon-ok"></i>
                    Hoàn Thành
                </button>
            </div>

            <div id="editDiv" style="display:none;margin:5px">
                <button id="closeBtn" type="button" class="btn btn-default pull-left" style="float: left; width: 100px">
                    
                    Đóng
                </button>
                <button class="blue btn btn-success" id="saveBtn" style="float: right;">
                    
                    Lưu chỉnh sửa
                </button>
            </div>

            <div class="input-group input-group-sm" style="display:none; margin-bottom: 10px;width:45%" id="eventDatepickerDiv">
                <div>
                    <input style="font-size: 20px ;cursor: pointer; background: none repeat scroll 0 0 #fff !important" readonly="readonly" class="form-control" placeholder="Thời gian sự kiện..." id="datePickerEvent" type="text">
                </div>
                <span class="input-group-addon">
                    <i class="icon-calendar bigger-110"></i>
                </span>
            </div>
        </div>
    </div>
</div>
</div>



<script>
    $(document).ready(function () {
        document.body.setAttribute('spellcheck', false);
        setLiActiveClass('#liCaseDetail');
        getCaseDetail($("#caseIdDiv").attr("value"));
    });

    var offId;
    function getCaseDetail(caseId) {
        $('#peopleContent').hide();
        $('.date-picker').datepicker('remove');
        removeEditor();


        $.post("/Case/GetCaseDetail", { id: caseId }, function (out) {
            document.getElementById("bodyContent").innerHTML = (out.html);

            // Khởi tạo breadcrumbs
            $('#breadcrumbsCaseCode').text(out.result.CaseCode);

            // Khởi tạo case detail
            setDeactiveComponent();

            // Khởi tạo giá trị
            $('#txtCaseCode').val(out.result.CaseCode);
            $("#StatusDiv").attr("value", out.result.Status);
            $("#OfficeStatusDiv").attr("value", out.result.Office.Active);


            if (out.result.ReceiptDate != null) {
                var receiptDate = convertNETDateTime(out.result.ReceiptDate).toLocaleFormat('%d/%m/%Y');
                $('#datePickerReceiptDate').val(receiptDate);
            }

            $('#cboOffice').html('<option>' + out.result.Office.OfficeName + '</option>');
            offId = out.result.OfficeId;

            loadSelectedStatus(out.result.Status);
            $('#txtCaseContent').val(out.result.CaseContent);
            $('#txtDisputeSubject').val(out.result.DisputeSubject);
            $('#txtDisputeRelation').val(out.result.DisputeRelation);

            $('#txtLimitationStatute').val(out.result.LimitationStatute);
            $('#txtLegalEvent').val(out.result.LegalEvent);
            $('#txtErrorFactor').val(out.result.ErrorFactor);

            // Gọi JS cho component
            $('.date-picker').datepicker({ autoclose: true }).next().on(ace.click_event, function () {
                $(this).prev().focus();
            });

            $('textarea[class*=autosize]').autosize({ append: "\n" });

            $('[data-rel=tooltip]').tooltip();

            validateUpdateDetail('#updateDetailValidateForm');
            if ($("#liCaseDetail").attr("class") != "active") {
                $("#bodyContent").html("");
            }
        });
    }

    function updateCaseDetail() {
        if ($('#updateDetailValidateForm').valid()) {;
            var status = $('#cboStatus').val();
            if (status == "Đã thụ lý") {
                bootbox.confirm("Hồ sơ ở trạng thái đã thụ lý sẽ không thể chỉnh sửa. Bạn có chắc muốn lưu?", function (result) {
                    if (result) {
                        doUpdateCaseDetail();
                    }
                });
            } else doUpdateCaseDetail();
        }
    }
    function doUpdateCaseDetail() {
        var caseId = $("#caseIdDiv").attr("value");
        var receiptDate = $('#datePickerReceiptDate').val();
        var officeId = $("#cboOffice option:selected").val();
        var status = $('#cboStatus').val();
        var caseContent = $('#txtCaseContent').val();
        var disputeSubject = $('#txtDisputeSubject').val();
        var disputeRelation = $('#txtDisputeRelation').val();
        var limitationStatute = $('#txtLimitationStatute').val();
        var legalEvent = $('#txtLegalEvent').val();
        var errorFactor = $('#txtErrorFactor').val();


        $.post("/Case/UpdateCaseDetail", {
            caseId: caseId, receiptDate: receiptDate, officeId: officeId, status: status, caseContent: caseContent,
            disputeSubject: disputeSubject, disputeRelation: disputeRelation, limitationStatute: limitationStatute, legalEvent: legalEvent, errorFactor: errorFactor
        }, function (result) {
            if (result == "success") {
                getCaseDetail($("#caseIdDiv").attr("value"));
                notification("Cập nhật chi tiết hồ sơ thành công!", "", 2000, "btn-primary center");
            } else if (result == "error") {
                notification("Cập nhật thông tin hồ sơ thất bại!", "Hãy kiểm tra lại kết nối database.", 3000, "gritter-error center");
            } else if (result == "StaffNotInOffice") {
                notification("Cập nhật thông tin hồ sơ thất bại!", "Đang có luật sư phụ trách không thuộc văn phòng này, hãy kiểm tra lại!", 3000, "gritter-error center");
            }

        })
        .error(function () {
            notification("Cập nhật chi tiết hồ sơ thất bại!", "Hãy kiểm tra lại kết nối database.", 3000, "gritter-error center");
        });
    }

    function cancelUpdateCaseDetail() {
        setDeactiveComponent();
        getCaseDetail($("#caseIdDiv").attr("value"));
    }

    function loadSelectedOfficesWithAdmin() {
        $.post("/Case/GetAllOfficeJson", {}, function (out) {
            var item = '';
            $.each(out, function (index, off) {
                if (off.OfficeId == offId) {
                    item += '<option selected="selected" value="' + off.OfficeId + '">' + off.OfficeName + '</option>';
                }
                else {
                    item += '<option value="' + off.OfficeId + '">' + off.OfficeName + '</option>';
                }
            });
            $('#cboOffice').html(item);
        });
    }

    function loadSelectedOffices() {
        $.post("/Case/GetOfficesByStaffId", {}, function (out) {
            var item = '';
            $.each(out.Office_Staff, function (index, off) {
                if (off.Office.OfficeId == offId) {
                    item += '<option selected="selected" value="' + off.Office.OfficeId + '">' + off.Office.OfficeName + '</option>';
                }
                else {
                    item += '<option value="' + off.Office.OfficeId + '">' + off.Office.OfficeName + '</option>';
                }
            });
            $('#cboOffice').html(item);
        });
    }

    function loadSelectedStatus(status) {
        var item = '';
        if (status == 'Đang thụ lý') {
            item += '<option selected="selected">Đang thụ lý</option>';
            item += '<option>Đã thụ lý</option>';
        }
        else if (status == 'Đã thụ lý') {
            item += '<option>Đang thụ lý</option>';
            item += '<option selected="selected">Đã thụ lý</option>';
        }
        $('#cboStatus').html(item);
    }

    function setLiActiveClass(liId) {
        $('#liCaseDetail').attr("class", "");
        $('#liCaseEvent').attr("class", "");
        $('#liCasePeople').attr("class", "");
        $('#liCaseFile').attr("class", "");
        $('#liCaseInvoice').attr("class", "");
        $(liId).attr("class", "active");
    }

    function setDeactiveComponent() {
        $('#datePickerReceiptDate').attr("disabled", "disabled");
        $('#datePickerReceiptDate').attr("style", "cursor: not-allowed; background: none repeat scroll 0 0 #EEEEEE !important");
        $('#cboOffice').attr("disabled", "disabled");
        $('#cboStatus').attr("disabled", "disabled");
        $('#txtCaseContent').attr("disabled", "disabled");
        $('#txtDisputeSubject').attr("disabled", "disabled");
        $('#txtDisputeRelation').attr("disabled", "disabled");
        $('#txtLimitationStatute').attr("disabled", "disabled");
        $('#txtLegalEvent').attr("disabled", "disabled");
        $('#txtErrorFactor').attr("disabled", "disabled");

        $('#btnCancelUpdateCaseDetail').hide();
        $('#btnUpdateCaseDetail').hide();
    }

    function setActiveComponent() {
        var authorize = $("#IsAuthorize").attr("value");
        if (authorize == "true") {

            $('#datePickerReceiptDate').removeAttr("disabled");
            $('#cboOffice').removeAttr("disabled");

            // load office len cobOffice trong case detail
            var roleId = $("#staffRoleIdDiv").attr("value");
            if (roleId == "1") {
                loadSelectedOfficesWithAdmin();
            } else {
                loadSelectedOffices();
            }

            $('#cboStatus').removeAttr("disabled");
            $('#txtCaseContent').removeAttr("disabled");
            $('#txtDisputeSubject').removeAttr("disabled");
            $('#txtDisputeRelation').removeAttr("disabled");
            $('#txtLimitationStatute').removeAttr("disabled");
            $('#txtLegalEvent').removeAttr("disabled");
            $('#txtErrorFactor').removeAttr("disabled");

            $('#datePickerReceiptDate').attr("style", "cursor: pointer; background: none repeat scroll 0 0 #fff !important");

            $('#btnCancelUpdateCaseDetail').show();
            $('#btnUpdateCaseDetail').show();

        } else {
            if ($("#StatusDiv").attr("value") == "Đã thụ lý") {
                notification("Bạn không có quyền sửa hồ sơ này!", "Hồ sơ đang trong trạng thái đã thụ lý.", 3000, "gritter-error center");
            } else if ($("#OfficeStatusDiv").attr("value")== "false") {
                notification("Bạn không có quyền sửa hồ sơ này!", "Văn phòng đang tạm thời ngừng hoạt động.", 3000, "gritter-error center");

            }else notification("Bạn không có quyền sửa hồ sơ này!", "Liên hệ với quản lý hoặc luật sư trưởng.", 3000, "gritter-error center");
        }
    }

    function validateUpdateDetail(validateform) {
        $(validateform).validate({
            errorElement: 'div',
            errorClass: 'help-block',
            focusInvalid: false,
            rules: {
                txtCaseContent: {
                    required: true
                }
            },
            messages: {
                txtCaseContent: {
                    required: "Nhập nội dung!"
                }
            },
            highlight: function (e) {
                $(e).closest('.form-group').removeClass('has-info').addClass('has-error');
            },

            success: function (e) {
                $(e).closest('.form-group').removeClass('has-error').addClass('has-info');
                $(e).remove();
            },
            errorPlacement: function (error, element) {
                if (element.is(':checkbox') || element.is(':radio')) {
                    var controls = element.closest('div[class*="col-"]');
                    if (controls.find(':checkbox,:radio').length > 1) controls.append(error);
                    else error.insertAfter(element.nextAll('.lbl:eq(0)').eq(0));
                }
                else error.insertAfter(element.parent());
            }
        });
    }
</script>



<script>
    var invoiceJson = "";
    var paymentJson = "";
    var totalInvoice=0;
    var totalPayment=0;


    function maskMoney(input) {
        var num = $(input).val();
        if (num != "") {
            var str = ("" + num).replace(/(\d)(?=(\d\d\d)+(?!\d))/g, function ($1) { return $1 + "." });
            $(input).val(str + " VNĐ");
        }
    }

    function convertToMoney(num) {
        if (""+num != "") {
            var str = ("" + num).replace(/(\d)(?=(\d\d\d)+(?!\d))/g, function ($1) { return $1 + "." });
            str = str + " VNĐ";
            return str;
        } 
    }

    function removeMask(input) {
        var num = $(input).val();
        if (num != "") {
            var result = num.replace(" VNĐ", "");
            result = parseInt(result.split(".").join(""));
            return $(input).val(result);
        }
    }

    function getCost(oDid) {
        $('#peopleContent').hide();
        $('.date-picker').datepicker('remove');
        removeEditor();

        $.post("/Case/GetCost", { caseId: oDid }, function (out) {
            document.getElementById("bodyContent").innerHTML = (out.html);

            var today = getCurdate();

            document.getElementById("curDateSpan").innerHTML = today;
            $('#CaseCodeSpan').text(out.result.CaseCode);
            updateInvoice(out.result.UsedServices);
            updatePayment(out.result.Payments);
            $("#offNameLi").append(" <b>" + out.result.Office.OfficeName + "</b>");
            $("#offAddressLi").append(" <b>" + out.result.Office.Address + "</b>");
            $("#offEmailLi").append(" <b>" + out.result.Office.Email + "</b>");
            $("#offPhoneLi").append(" <b>" + out.result.Office.PhoneNumber + "</b>");
            if (out.result.Case_Customer.length > 0) {
                $("#cusNameLi").append(" <b>" + out.result.Case_Customer[0].Customer.CustomerName + "</b>");
                $("#cusAddressLi").append(" <b>" + out.result.Case_Customer[0].Customer.Address + "</b>");
                $("#cusEmailLi").append(" <b>" + out.result.Case_Customer[0].Customer.Email + "</b>");
                $("#cusPhoneLi").append(" <b>" + out.result.Case_Customer[0].Customer.Mobile + "</b>");
            }
            $("#selectService").chosen();
            $('[data-rel=tooltip]').tooltip();
            $('.date-picker').datepicker({ autoclose: true }).next().on(ace.click_event, function () {
                $(this).prev().focus();
            });

            $("#selectService").chosen().on('change', function () {
                $(this).closest('form').validate().element($(this));
            });
            $("#selectService_chosen").css("width", "100%");
            validateAddCost("#invoiceValidateForm");
            validateAddCost("#paymentValidateForm");
            $('textarea[class*=autosize]').autosize({ append: "\n" });
            $("#serviceCost").numeric({ decimal: false, negative: false });
            $("#paymentCost").numeric({ decimal: false, negative: false });
        });
    }

    function updateInvoice(input) {
        $('#txtInvoice').css("height", "");
        input = sortByKey(input, "RegisteredDate");
        invoiceJson = input;
        var itemInvoice = '<tbody id="invoiceTbody">';
        var sumInvoice = 0;
        totalInvoice = 0;
        $.each(input, function (index, od) {
            itemInvoice += '<tr>';

            itemInvoice += '<td class="center">' + Number(index + 1) + '</td>';
            itemInvoice += '<td>' + od.ServiceName + '</td>';
            itemInvoice += '<td>' + od.Description + '</td>';
            var date = convertNETDateTime(od.RegisteredDate).toLocaleFormat('%d/%m/%Y');

            itemInvoice += '<td>' + date + '</td>';
            itemInvoice += '<td style="text-align:right">' + convertToMoney(od.ServiceCost) + '</td>';
            itemInvoice += '<td style="display:none" class="invoiceTd center"><div class="action-buttons"> <a class="green" data-toggle="modal" href="#invoicePopup" onclick="editInvoicePopup(' + od.UsedServiceId + ')"><i style="cursor:pointer" class="icon-pencil bigger-140"></i></a>' +
                '<a class="green" onclick="deleteInvoice(' + od.UsedServiceId + ')"><i style="cursor:pointer" class="red icon-trash bigger-140"></i></a></div></td>';
            itemInvoice += '</tr>';
            sumInvoice = sumInvoice + od.ServiceCost;
            totalInvoice=sumInvoice;
        });
        itemInvoice += '</tbody>';
        $('#invoiceTbl').append(itemInvoice);
        $('#sumInvoiceSpan').text(convertToMoney(sumInvoice));
        if (totalInvoice > totalPayment) {
            $("#balanceSpan").text("Chưa Thanh Toán: ");
            $("#sumBalanceSpan").text(convertToMoney(totalInvoice - totalPayment));
        } else if (totalInvoice < totalPayment) {
            $("#balanceSpan").text("Số Dư:");
            $("#sumBalanceSpan").text(convertToMoney(totalInvoice - totalPayment));
        } else {
            $("#balanceSpan").text("Đã thanh toán đủ");
            $("#sumBalanceSpan").text("");
        }

    }

    function updatePayment(input) {
        $('#txtPayment').css("height", "");
        input = sortByKey(input, "PaymentTime");
        paymentJson = input;

        var itemPayment = '<tbody id="paymentTbody">';
        var sumPayment = 0;
        totalPayment = 0;
        $.each(input, function (index, od) {
            itemPayment += '<tr>';
            itemPayment += '<td>' + index + 1 + '</td>';
            itemPayment += '<td>' + od.Description + '</td>';
            var date = convertNETDateTime(od.PaymentTime).toLocaleFormat('%d/%m/%Y');
            itemPayment += '<td>' + date + '</td>';
            itemPayment += '<td style="text-align:right">' + convertToMoney(od.PaymentMoney) + '</td>';
            itemPayment += '<td style="display:none" class="paymentTd center"><div class="action-buttons"> <a class="green" data-toggle="modal" href="#paymentPopup" onclick="editPaymentPopup(' + od.PaymentId + ')"><i style="cursor:pointer" class="icon-pencil bigger-140"></i></a>' +
                '<a class="green" onclick="deletePayment(' + od.PaymentId + ')"><i style="cursor:pointer" class="red icon-trash bigger-140"></i></a></div></td>';

            itemPayment += '</tr>';
            sumPayment = sumPayment + od.PaymentMoney;
            totalPayment=sumPayment;

        });
        itemPayment += '</tbody>';
        $('#sumPaymentSpan').text(convertToMoney(sumPayment));
        $('#paymentTbl').append(itemPayment);
        if (totalInvoice > totalPayment) {
            $("#balanceSpan").text("Chưa Thanh Toán: ");
            $("#sumBalanceSpan").text(convertToMoney(totalInvoice - totalPayment));
        } else if (totalInvoice < totalPayment) {
            $("#balanceSpan").text("Số Dư:");
            $("#sumBalanceSpan").text(convertToMoney(totalPayment-totalInvoice));
        } else {
            $("#balanceSpan").text("Đã thanh toán đủ");
            $("#sumBalanceSpan").text("");
        }
    }

    function editableInvoice() {
        var authorize = $("#IsAuthorize").attr("value");
        if (authorize == "true") {
            $("#editInvoiceTh").show();
            $(".invoiceTd").show();
            $("#editInvoice").attr("onClick", "successEditInvoice()");
        } else {
            if ($("#StatusDiv").attr("value") == "Đã thụ lý") {
                notification("Bạn không có quyền sửa hồ sơ này!", "Hồ sơ đang trong trạng thái đã thụ lý.", 3000, "gritter-error center");
            } else if ($("#OfficeStatusDiv").attr("value")== "false") {
                notification("Bạn không có quyền sửa hồ sơ này!", "Văn phòng đang tạm thời ngừng hoạt động.", 3000, "gritter-error center");

            } else notification("Bạn không có quyền sửa hồ sơ này!", "Liên hệ với quản lý hoặc luật sư trưởng.", 3000, "gritter-error center");
        }
    }

    function successEditInvoice() {
        $("#editInvoiceTh").hide();
        $(".invoiceTd").hide();
        $("#editInvoice").attr("onClick", "editableInvoice()");
    }

    function editablePayment() {
        var authorize = $("#IsAuthorize").attr("value");
        if (authorize == "true") {
            $("#editPaymentTh").show();
            $(".paymentTd").show();
            $("#editPayment").attr("onClick", "successEditPayment()");
        } else {
            if ($("#StatusDiv").attr("value") == "Đã thụ lý") {
                notification("Bạn không có quyền sửa hồ sơ này!", "Hồ sơ đang trong trạng thái đã thụ lý.", 3000, "gritter-error center");
            }else if ($("#OfficeStatusDiv").attr("value")== "false") {
                notification("Bạn không có quyền sửa hồ sơ này!", "Văn phòng đang tạm thời ngừng hoạt động.", 3000, "gritter-error center");

            } else notification("Bạn không có quyền sửa hồ sơ này!", "Liên hệ với quản lý hoặc luật sư trưởng.", 3000, "gritter-error center");
        }
    }

    function successEditPayment() {
        $("#editPaymentTh").hide();
        $(".paymentTd").hide();
        $("#editPayment").attr("onClick", "editablePayment()");
    }

    function choseTypeService() {
        var selected = $("#selectTypeService").val();
        var serviceitem = '<option value=""></option>';
        $.each(allservice, function (indextype, sertype) {
            if (sertype.ServiceTypeId == selected) {
                $.each(sertype.Services, function (indexser, ser) {
                    serviceitem += '<option value=' + ser.ServiceId + '>' + ser.ServiceName + ' </option>';
                });
            }
        });
        $("#selectService").html(serviceitem);
        $("#selectService").trigger("chosen:updated");

    }

    var allservice = "";

    function addInvoiceToCus() {
        if ($('#invoiceValidateForm').valid()) {
            $("#invoicePopup").click();
            var result = $("#serviceCost").val().replace(" VNĐ", "");
            result = result.split(".").join("");
            $.post("/Case/AddInvoice", {
                serviceCost: result, caseId: $("#caseIdDiv").attr("value"), txtDescription: $("#txtInvoice").val(),
                serviceName: $("#selectService  option:selected").text(), datePickerService: $("#datePickerService").val()
            }, function (out) {
                if ("Successful" == out) {
                    $.post("/Case/UpdateCost", { update: "UsedServices", caseId: $("#caseIdDiv").attr("value") }, function (update) {
                        $("#invoiceTbl")[0].removeChild($("#invoiceTbody")[0]);
                        updateInvoice(update.UsedServices);
                        $(".invoiceTd").show();
                        notification("Thêm dịch vụ thành công !", "", 2000, "btn-primary center");
                        $("#serviceCost").val("");
                        txtDescription: $("#txtDescription").val("");
                        return false;
                    });
                }
                else notification("Thêm dịch vụ thất bại!", "Hãy kiểm tra lại kết nối database", 3000, "gritter-error center");
            });


        }
    }

    function addPaymentToCus() {
        if ($('#paymentValidateForm').valid()) {
            $("#paymentPopup").click();
            var result = $("#paymentCost").val().replace(" VNĐ", "");
            result = result.split(".").join("");
            $.post("/Case/AddPayment", {
                paymentCost: result, caseId: $("#caseIdDiv").attr("value"), txtDescription: $("#txtPayment").val(),
                datePickerPayment: $("#datePickerPayment").val()
            }, function (out) {
                if ("Successful" == out) {
                    $.post("/Case/UpdateCost", { update: "Payments", caseId: $("#caseIdDiv").attr("value") }, function (update) {
                        $("#paymentTbl")[0].removeChild($("#paymentTbody")[0]);
                        updatePayment(update.Payments);
                        $(".paymentTd").show();
                        notification("Thêm thanh toán thành công !", "", 2000, "btn-primary center");
                        $("#paymentCost").val("");
                        txtDescription: $("#txtPayment").val("");
                        return false;
                    });
                } else notification("Thêm thanh toán thất bại!", "Hãy kiểm tra lại kết nối database", 3000, "gritter-error center");
            });

        }
    }

    function deleteInvoice(element) {
        $(ace.click_event, function () {
            bootbox.confirm("Bạn thực sự muốn xóa dịch vụ này?", function (result) {
                if (result) {
                    $.post("/Case/DeleteInvoice", { invoiceId: element }, function (out) {
                        if (out == "Successful") {
                            $.post("/Case/UpdateCost", { update: "UsedServices", caseId: $("#caseIdDiv").attr("value") }, function (update) {
                                $("#invoiceTbl")[0].removeChild($("#invoiceTbody")[0]);
                                updateInvoice(update.UsedServices);
                                $(".invoiceTd").show();
                                notification("Xóa dịch vụ thành công !", "", 2000, "btn-primary center");
                                $("#serviceCost").val("");
                                txtDescription: $("#txtDescription").val("");
                                return false;
                            });
                        }
                        else notification("Xóa dịch vụ thất bại!", "Hãy kiểm tra lại kết nối database", 3000, "gritter-error center");
                    });
                }
            });
        });
    }

    function deletePayment(element) {
        $(ace.click_event, function () {
            bootbox.confirm("Bạn thực sự muốn xóa thanh toán này?", function (result) {
                if (result) {
                    $.post("/Case/DeletePayment", { paymentId: element }, function (out) {
                        if (out == "Successful") {
                            $.post("/Case/UpdateCost", { update: "Payments", caseId: $("#caseIdDiv").attr("value") }, function (update) {
                                $("#paymentTbl")[0].removeChild($("#paymentTbody")[0]);
                                updatePayment(update.Payments);
                                $(".paymentTd").show();
                                notification("Xóa thanh toán thành công !", "", 2000, "btn-primary center");
                                $("#paymentCost").val("");
                                txtDescription: $("#txtPayment").val("");
                                return false;
                            });
                        } else notification("Xóa thanh toán thất bại!", "Hãy kiểm tra lại kết nối database", 3000, "gritter-error center");
                    });
                }
            });
        });
    }

    function addPaymentPopup() {
        var today = getCurdate();
        $('#paymentHeader').html("Tạo Thanh Toán:");
        document.getElementById("datePickerPayment").value = today;
        $('#addPaymentBtn').attr("onClick", 'addPaymentToCus()');
    }

    function AddInvoicePopup() {
        $('#invoiceHeader').html("Thêm Dịch Vụ:");
        $('#addInvoiceBtn').html("Thêm Dịch Vụ");
        $("#serviceTypeDiv").show();
        $("#serviceDiv").show();
        $('#addInvoiceBtn').attr("onClick", 'addInvoiceToCus()');
        var today = getCurdate();
        document.getElementById("datePickerService").value = today;
        $.post("/Case/GetAllServices", {}, function (out) {
            allservice = out;
            var servicetypeitem = "";
            $.each(out, function (index, ser) {
                servicetypeitem += '<option value=' + ser.ServiceTypeId + '>' + ser.ServiceTypeName + ' </option>';
            });
            $("#selectTypeService").html(servicetypeitem);
            $("#selectTypeService").val("");
            $("#selectService").html('<option value=""></option>');
            $("#selectService").trigger("chosen:updated");
        });
    }

    function editInvoicePopup(id) {
        $('#invoiceHeader').html("Sửa Chi Phí:");
        $('#addInvoiceBtn').html("Sửa Chi Phí");
        $('#addInvoiceBtn').attr("onClick", 'editInvoice(' + id + ')');
        $("#serviceTypeDiv").hide();
        $("#serviceDiv").hide();
        $.each(invoiceJson, function (index, invoice) {
            if (invoice.UsedServiceId == id) {
                $("#serviceCost").val(convertToMoney(invoice.ServiceCost));
                $("#datePickerService").val(convertNETDateTime(invoice.RegisteredDate).toLocaleFormat('%d/%m/%Y'));
                $("#txtInvoice").val(invoice.Description);
            }
        });
    }

    function editPaymentPopup(id) {
        $('#paymentHeader').html("Sửa Thanh Toán:");
        $('#addPaymentBtn').html("Sửa Thanh Toán");
        $('#addPaymentBtn').attr("onClick", 'editPayment(' + id + ')');
        $.each(paymentJson, function (index, payment) {
            if (payment.PaymentId == id) {
                $("#paymentCost").val(convertToMoney(payment.PaymentMoney));
                $("#datePickerPayment").val(convertNETDateTime(payment.PaymentTime).toLocaleFormat('%d/%m/%Y'));
                $("#txtPayment").val(payment.Description);
            }
        });
    }

    function editPayment(id) {
        if ($('#paymentValidateForm').valid()) {
            var result = $("#paymentCost").val().replace(" VNĐ", "");
            result = result.split(".").join("");
            $("#paymentPopup").click();
            $.post("/Case/UpdatePayment", {
                paymentId: id, paymentCost: result,
                txtDescription: $("#txtPayment").val(), datePickerPayment: $("#datePickerPayment").val()
            }, function (out) {
                if ("Successful" == out) {
                    $.post("/Case/UpdateCost", { update: "Payments", caseId: $("#caseIdDiv").attr("value") }, function (update) {
                        $("#paymentTbl")[0].removeChild($("#paymentTbody")[0]);
                        updatePayment(update.Payments);
                        $(".paymentTd").show();
                        notification("Sửa thanh toán thành công !", "", 2000, "btn-primary center");
                        $("#paymentCost").val("");
                        txtDescription: $("#txtPayment").val("");
                        return false;
                    });
                } else notification("Sửa thanh toán thất bại!", "Hãy kiểm tra lại kết nối database", 3000, "gritter-error center");
            });

        }
    }

    function editInvoice(id) {
        if ($('#invoiceValidateForm').valid()) {
            var result = $("#serviceCost").val().replace(" VNĐ", "");
            result = result.split(".").join("");
            $("#invoicePopup").click();
            $.post("/Case/UpdateInvoice", {

                invoiceId: id, serviceCost: result,
                txtDescription: $("#txtInvoice").val(), datePickerService: $("#datePickerService").val()
            }, function (out) {
                if (out == "Successful") {
                    $.post("/Case/UpdateCost", { update: "UsedServices", caseId: $("#caseIdDiv").attr("value") }, function (update) {
                        $("#invoiceTbl")[0].removeChild($("#invoiceTbody")[0]);
                        updateInvoice(update.UsedServices);
                        $(".invoiceTd").show();
                        notification("Sửa dịch vụ thành công !", "", 2000, "btn-primary center");
                        $("#serviceCost").val("");
                        txtDescription: $("#txtDescription").val("");
                        return false;
                    });
                }
                else notification("Sửa dịch vụ thất bại!", "Hãy kiểm tra lại kết nối database", 3000, "gritter-error center");
            });

        }
    }

    function validateAddCost(validateform) {
        $(validateform).validate({
            errorElement: 'div',
            errorClass: 'help-block',
            focusInvalid: false,
            rules: {
                selectService: {
                    required: true
                },
                serviceCost: {
                    required: true,
                    maxlength: false
                },
                selectTypeService: {
                    required: true
                },
                txtDescription: {
                    required: true
                },
                paymentCost: {
                    required: true,
                    maxlength: false
                },
            },
            messages: {
                txtDescription: {
                    required: "Nhập nội dung!"
                },
                serviceCost: {
                    required: "Nhập chi phí!",
                },
                paymentCost: {
                    required: "Nhập số tiền thanh toán!",
                },
                selectTypeService: {
                    required: "Chọn loại dịch vụ!"
                },
                selectService: {
                    required: "Chọn dịch vụ!"
                }
            },
            highlight: function (e) {
                $(e).closest('.form-group').removeClass('has-info').addClass('has-error');
            },

            success: function (e) {
                $(e).closest('.form-group').removeClass('has-error').addClass('has-info');
                $(e).remove();
            },
            errorPlacement: function (error, element) {
                if (element.is(':checkbox') || element.is(':radio')) {
                    var controls = element.closest('div[class*="col-"]');
                    if (controls.find(':checkbox,:radio').length > 1) controls.append(error);
                    else error.insertAfter(element.nextAll('.lbl:eq(0)').eq(0));
                }
                else if (element.is('.chosen-select')) {
                    error.insertAfter(element.siblings('[class*="chosen-container"]:eq(0)'));
                }
                else error.insertAfter(element.parent());
            }
        });
    }
</script>



<script>
    function showTabEvent(id) {
        if (id == "qdls") {
            $("#qdlsLi").find("a").css("font-weight", "bold");
            $("#sktnLi").find("a").css("font-weight", "");
            $("#qdlsLi").attr("class", "active");
            $("#sktnLi").attr("class", "");
            $("#tabQDLSDiv").show();
            $("#tabSKTNDiv").hide();
        } else {
            $("#sktnLi").find("a").css("font-weight", "bold");
            $("#qdlsLi").find("a").css("font-weight", "");
            $("#sktnLi").attr("class", "active");
            $("#qdlsLi").attr("class", "");
            $("#tabQDLSDiv").hide();
            $("#tabSKTNDiv").show();
        }
    }

    var editor = "";
    var dateChange = false;
    function createEditor(id) {
        editor = CKEDITOR.appendTo(id, {

        });
    }

    function removeEditor() {
        if (editor) {
            editor.destroy();
            editor = "";
        }
    }
    function formatDateEvent(date) {
        date = convertNETDateTime(date);
        var day = Number((date).toLocaleFormat('%d'));
        var month = Number((date).toLocaleFormat('%m'));
        var year = (date).toLocaleFormat('%Y');
        var hour = Number((date).toLocaleFormat('%H'));
        var min =  Number((date).toLocaleFormat('%M'));
        day = (day<10)? "0"+day:day;
        month = (month<10)? "0"+month:month;
        hour = (hour<10)? "0"+hour:hour;
        min = (min<10)? "0"+min:min;
        return day + "/" + month + "/" + year + " " + hour + ":" + min;
    }
    function convertStringDateToDiv(date) {
          date =  date.split(" đến ");
          date[0] = date[0].split(" ");
          date[1] = date[1].split(" ");
          return '<a style="font-size: 1em; text-decoration:none">'+'<div class="dateArea">'+date[0][0]+'</div>'+' <div class="timeArea">'+ date[0][1]+'</div>'+
              '<span style="font-size: 25px">➦</span>'+'<div class="dateArea">'+date[1][0]+'</div>'+' <div class="timeArea">'+ date[1][1]+'</div>'
              + '</a>';
    }
    
    function getCaseEvent(id) {
        $('#peopleContent').hide();
        $('.date-picker').datepicker('remove');
        removeEditor();
        $.post("/Case/GetEvent", { caseId: id }, function (out) {
            document.getElementById("bodyContent").innerHTML = (out.html);
            getViewpoint(id);
            showTabEvent("sktn");
            var eventStr = "";
            $.each(out.result.OperationalEvents, function (index, event) {
                var staffName;
                $.each(out.creatorUsername, function (i, e) {
                    if (event.CreatorId == e.StaffId) {
                        staffName = e.Staff.StaffName;
                    }
                });
                eventStr += '<div  class="timelineMajor" id="caseEvent' + event.OperationalEventId + '" creatorId="' + event.CreatorId + '">';
                eventStr += '<h2 class="timelineMajorMarker"><span>' + event.Title + '</span><span style="display:none">' + formatDateEvent(event.BeginTime) + " đến " + formatDateEvent(event.EndTime) + '</span></h2>';
                
                eventStr += '<dl class="timelineMinor">';
                
                eventStr += '<dt class="dt-time"  id="' + index + 'dt"> ' + convertStringDateToDiv(formatDateEvent(event.BeginTime) + " đến " + formatDateEvent(event.EndTime)) + '</dt>';

                eventStr += '<dt>  <span>Luật sư phụ trách:</span> <span style="font-weight: bold">' +   staffName  + '</span></dt>';
                eventStr += '<div style="font-size: 14px;margin-left:70%;margin-bottom:10px"></div>';
                eventStr += '<dd style="display: none;" id="' + index + 'dtEX" class="timelineEvent">';
                eventStr += '<div id=content' + event.OperationalEventId + '>' + event.Description + '</div>';
                eventStr += '</dd></dl>';
                eventStr += '<div id="editor' + event.OperationalEventId + '"></div></div>';
            });

            dateChange = false;
            isEdit = false;
            $('#timelineEvent').append(eventStr);
            $.timeliner({
                startOpen: []
            });
            $.timeliner({
                timelineContainer: '#timelineEvent'
            });
            if ($('.daterangepicker').length > 1) {
                $($('.daterangepicker')[1]).remove();
            }

            $('#datePickerEvent').daterangepicker({
                separator: " đến ", timePicker: true, timePickerIncrement: 15, format: 'DD/MM/YYYY HH:mm', timePicker12Hour: false
               
            }).prev().on(ace.click_event, function () {
                $(this).next().focus();
         
            });
            $('#datePickerEvent').change(this, function () {
                dateChange = true;
            }).click(this,function() {
                var eventTime = $('#datePickerEvent').val().split(" đến ");
                if (eventTime != "") {
                    $('#datePickerEvent').data("daterangepicker").setStartDate(eventTime[0]);
                    $('#datePickerEvent').data("daterangepicker").setEndDate(eventTime[1]);
                } else {
                    $('#datePickerEvent').data("daterangepicker").setStartDate(getCurdate()+"00:00");
                    $('#datePickerEvent').data("daterangepicker").setEndDate(getCurdate()+"00:00");
                }
            });
            $('[data-rel=tooltip]').tooltip();
            var obj = $(".timelineMajor");
            obj = obj.sort(sortCaseEvent);
            $(obj).appendTo("#timelineEvent");
            $('<br class="clear">').appendTo("#timelineEvent");
        });
    }

    function editableEvent() {
        var authorize = $("#IsAuthorize").attr("value");
        var staffId = $("#StaffIdDiv").attr("value");
        if (authorize == "true") {
            $("#addEventBtn").show();
            $("#addCalendarEventBtn").show();
            $("#successBtn").show();
            $("#editEventi").attr("onClick", "successEditEvent()");
            $('.timelineMajor').each(function (index, element) {
                if (staffId == $(this).attr("creatorid")) {
                    $(createEditElement($('.timelineMajor')[index].id)).insertAfter($($(element).find(".dt-time")[0]));
                }
            });
        } else {
            if ($("#StatusDiv").attr("value") == "Đã thụ lý") {
                notification("Bạn không có quyền sửa hồ sơ này!", "Hồ sơ đang trong trạng thái đã thụ lý.", 3000, "gritter-error center");
            } else if ($("#OfficeStatusDiv").attr("value")== "false") {
                notification("Bạn không có quyền sửa hồ sơ này!", "Văn phòng đang tạm thời ngừng hoạt động.", 3000, "gritter-error center");

            }else notification("Bạn không có quyền sửa hồ sơ này!", "Liên hệ với quản lý hoặc luật sư trưởng.", 3000, "gritter-error center");
        }
    }

    function successEditEvent() {
        if (!isEdit) {
            $("#addEventBtn").hide();
            $("#addCalendarEventBtn").hide();
            $("#successBtn").hide();
            $("#titleEventInputDiv").hide();
            $("#editEventi").attr("onClick", "editableEvent()");
            $('.timelineMajor').each(function (index, domEle) {
                if ($($('.timelineMajor')[index]).find(".divEdit").size() != 0)
                    ($($('.timelineMajor')[index])).find(".divEdit").remove();
            });
        } else notification("Chỉnh sửa chưa hoàn thành!", "Hãy lưu hoặc đóng chỉnh sửa", "2000", "gritter-error center");
    }

    function deleteEvent(element) {
        bootbox.confirm("Bạn có chắc muốn xóa?", function (result) {
            if (result) {
                $.post("/Case/DeleteOEvent", { element: element }, function (out) {
                    if (out == "deleteEventSuccess") {
                        $("#caseEvent" + element).remove();
                        var obj = $(".timelineMajor");
                        obj = obj.sort(sortCaseEvent);
                        $(obj).appendTo("#timelineEvent");
                        $(".clear").remove();
                        $('<br class="clear">').appendTo("#timelineEvent");

                        notification("Xóa sự kiện thành công!", "", 2000, "btn-primary center");
                    } else {
                        notification("Xóa sự kiện thất bại!", "hãy kiểm tra lại kết nối database", 2000, "gritter-error center");
                    }
                });
            }
        });

    }
    // tao edit, delete

    function createEditElement(eventId) {
        var divEdit = document.createElement("div");
        divEdit.setAttribute("class", "divEdit  action-buttons");
        var a1 = document.createElement("a");
        a1.setAttribute("class", "green");
        a1.setAttribute("onClick", 'editEvent("' + eventId + '")');
        var i1 = document.createElement("i");
        i1.setAttribute("class", "icon-pencil bigger-200");
        var a2 = document.createElement("a");
        a2.setAttribute("class", "red");
        a2.setAttribute("onClick", 'deleteEvent(' + eventId.split("caseEvent").join("") + ')');
        var i2 = document.createElement("i");
        i2.setAttribute("class", "icon-trash bigger-200");

        $(a1).append(i1);
        $(a2).append(i2);
        $(divEdit).append(a1);
        $(divEdit).append(a2);
        return divEdit;
    }

    var isEdit = false;

    function editEvent(element) {
        $("#" + element).children().hide();
        isEdit = true;
        var caseEventId = $("#" + element).attr("id");
        $("#" + element).attr("style", "margin:10px");
        $("#titleEventInputDiv").prependTo("#" + element);
        $("#eventDatepickerDiv").prependTo("#" + element);

        $("#editDiv").appendTo("#" + element);
        var editdivId = "editor" + caseEventId.split("caseEvent").join("");

        createEditor(editdivId);
        $("#" + editdivId).show();
        $("#eventDatepickerDiv").show();
        $("#titleEventInputDiv").show();

        $("#editDiv").show();
        var title =  $($("#" + element).children(".timelineMajorMarker").children()[0]).html();
        $("#titleEventInput").val(title);

        var time = $($("#" + element).children(".timelineMajorMarker").children()[1]).html();
        var str = ($("#" + element).attr("id")).split("caseEvent").join("");
        str = $("#content" + str).html();
        for (var first in CKEDITOR.instances) {
            editor = CKEDITOR.instances[first];
            CKEDITOR.instances[first].setData(str);
            break;
        }
        $("#datePickerEvent").val(time);
        $("#saveBtn").text("Lưu chỉnh sửa");
        $("#saveBtn").attr("onClick", 'saveEditEvent("' + caseEventId + '")');
        $("#closeBtn").attr("onClick", 'closeEditEvent("' + caseEventId + '")');

        $("#successDiv").hide();
        $(".divEdit").hide();
    }

    function addEvent() {
        isEdit = false;
        $("#titleEventInputDiv").prependTo("#newEventDiv");
        $("#eventDatepickerDiv").prependTo("#newEventDiv");
        $("#newEventDiv").css("margin", "20px auto 20px 100px");
        $("#editDiv").appendTo("#newEventDiv");
        $("#titleEventInput").val("");
        $("#datePickerEvent").val("");
        createEditor("newEditorDiv");
        $("#newEditorDiv").show();
        $("#titleEventInputDiv").show();
        $("#eventDatepickerDiv").show();
        $("#editDiv").show();
        $("#saveBtn").attr("onClick", 'saveNewEvent()');
        $("#saveBtn").text("Tạo sự kiện");
        $("#closeBtn").attr("onClick", 'closeNewEvent()');
        $("#successDiv").hide();
        $(".divEdit").hide();
    }



    function addCalendarEvent() {
        $.ajax({
            url: '/Case/NewOEvent',
            method: 'POST',
            data: {
                date: $('#datePickerBegin').val(),
                str: $('#eventName').val(),
                caseId: $("#caseIdDiv").attr("value"),
                endTime: $('#datePickerEnd').val()
            },
            success: function (result) {
                if (result != 0) {
                    console.debug("success");
                } else {
                    console.debug("fail");
                }
            },
            error: function (errMsg) {
                //alert(errMsg.responseText);
                console.debug("error");
            }
        });
    }

    function closeNewEvent() {
        if (editor.checkDirty()) {
            bootbox.confirm("Nội dung đã thay đổi, bạn có đồng ý không lưu?", function (result) {
                if (result) {
                    doCloseEditEvent("newEventDiv");
                }
            });
        } else {
            doCloseEditEvent("newEventDiv");
        }
    }

    function closeEditEvent(element) {
        if (editor.checkDirty() || dateChange) {
            bootbox.confirm("Nội dung đã thay đổi, bạn có đồng ý không lưu?", function (result) {
                if (result) {
                    doCloseEditEvent(element);
                }
            });
        } else {
            doCloseEditEvent(element);
        }
    }

    function doCloseEditEvent(element) {
        dateChange = false;
        isEdit = false;
        removeEditor();
        $("#" + element).children().show();
        $("#" + element).css("margin", "");
        $("#eventDatepickerDiv").hide();
        $("#editDiv").hide();
        $("#titleEventInputDiv").hide();

        $("#successDiv").show();
        $(".divEdit").show();
    }

    function saveNewEvent() {
        var date = $("#datePickerEvent").val();
        var title = $("#titleEventInput").val().trim();
        if (date != "" && title != "") {
            var str = editor.getData();
            var bdate = date.split(" đến ")[0];
            var indexdt = $(".timelineMajor").length;
            var edate = date.split(" đến ")[1];
            var creator = $("#StaffIdDiv").attr("value");
            var content = String(str).replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;');
            var caseId = $("#caseIdDiv").attr("value");
            $.post("/Case/NewOEvent", { caseId: caseId, bdate: bdate, edate: edate, str: content, title: title }, function (out) {
                var eventStr = "";
                if (out != 0) {
                    doCloseEditEvent("newEventDiv");
                    eventStr += '<div  class="timelineMajor" id="caseEvent' + out + '" creatorId="' + creator + '">';
                    eventStr += '<h2 class="timelineMajorMarker"><span>' + title + '</span><span style="display:none">' + date + '</span></h2>';
                    eventStr += '<dl class="timelineMinor">';
                    eventStr += '<dt class="dt-time" id="' + indexdt + 'dt"> ' + convertStringDateToDiv(date) +'</dt>';
                    eventStr += '<dt>  <span>Luật sư phụ trách:</span> <span style="font-weight: bold">' +    $("#StaffNameDiv").attr("value")  + '</span></dt>';
                    eventStr += '<div style="font-size: 14px;margin-left:70%;margin-bottom:10px"></div>';
                    eventStr += '<dd style="display: none;"  id="' + indexdt + 'dtEX" class="timelineEvent">';
                    eventStr += '<div id=content' + out + '>' + str + '</div>';
                    eventStr += '</dd></dl>';
                    eventStr += '<div id="editor' + out + '"></div></div>';

                    $(eventStr).appendTo("#timelineEvent");
                    var obj = $(".timelineMajor");
                    obj = obj.sort(sortCaseEvent);
                    $(obj).appendTo("#timelineEvent");
                    $(".clear").remove();
                    $('<br class="clear">').appendTo("#timelineEvent");
                    successEditEvent();
                    editableEvent();
                    notification("Thêm sự kiện thành công!", "", 2000, "btn-primary center");

                } else {
                    notification("Thêm sự kiện thất bại!", "hãy kiểm tra lại kết nối database", 2000, "gritter-error center");
                }
            }).error(function () {
                notification("Thêm sự kiện thất bại!", "hãy kiểm tra lại kết nối database", 2000, "gritter-error center");
            });
        } else notification("", "hãy chọn thời gian và nhập tiêu đề!", 2000, "gritter-error center");
        return false;
    }

    function saveEditEvent(element) {
        var str = editor.getData();
        var content = String(str).replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;');
        var caseEventId = element.replace("caseEvent", "");
        var caseId = $("#caseIdDiv").attr("value");
        var date = $("#datePickerEvent").val();
        var title = $("#titleEventInput").val().trim();

        if (title != "" && title != null && date != "") {
            var bdate = date.split(" đến ")[0];
            var edate = date.split(" đến ")[1];
            $.post("/Case/EditOEvent", { oEventId: caseEventId, content: content, caseId: caseId, bdate: bdate, edate: edate, title: title }, function (out) {
                if (out == "EditLegalEventSuccess") {
                    doCloseEditEvent(element);
                    $($("#" + element).children(".timelineMajorMarker").children()[1]).html(date);
                    $($("#" + element).children(".timelineMajorMarker").children()[0]).html(title);
                    $($("#" + element).find(".timelineMinor").find("dt")[0]).html(convertStringDateToDiv(date));


                    var obj = $(".timelineMajor");
                    obj = obj.sort(sortCaseEvent);
                    $(obj).appendTo("#timelineEvent");
                    $(".clear").remove();
                    $('<br class="clear">').appendTo("#timelineEvent");
                    $("#content" + caseEventId).html(str);
                    notification("Sửa sự kiện thành công!", "", 2000, "btn-primary center");
                } else {
                    notification("Sửa sự kiện thất bại!", "hãy kiểm tra lại kết nối database", 2000, "gritter-error center");
                }
            }).error(function () {
                notification("Thêm sự kiện thất bại!", "hãy kiểm tra lại kết nối database", 2000, "gritter-error center");
            });
        } else {
            notification("", "hãy nhập tiêu đề và chọn thời gian cho sự kiện", 2000, "gritter-error center");
            return false;
        }
        return false;
    }

    function sortCaseEvent(a, b) {
        var x = $($(a).children(".timelineMajorMarker").children()[1]).html();
        x = x.split(" đến ")[0];
        var x2 = $($(a).children(".timelineMajorMarker").children()[1]).html().split(" đến ")[1];
        var x2hour = (x2.split(" ")[1]).split(":");
        var x2date = (x2.split(" ")[0]).split("/");
        x2 = new Date(x2date[2], x2date[1] - 1, x2date[0], x2hour[0], x2hour[1]);
        
        var xhour = (x.split(" ")[1]).split(":");
        var xdate = (x.split(" ")[0]).split("/");
        x = new Date(xdate[2], xdate[1] - 1, xdate[0], xhour[0], xhour[1]);

        var y = $($(b).children(".timelineMajorMarker").children()[1]).html();
        y = y.split(" đến ")[0];
        var y2 =  $($(b).children(".timelineMajorMarker").children()[1]).html().split(" đến ")[1];
        var y2hour = (y2.split(" ")[1]).split(":");
        var y2date = (y2.split(" ")[0]).split("/");
        y2 = new Date(y2date[2], y2date[1] - 1, y2date[0], y2hour[0], y2hour[1]);

        var yhour = (y.split(" ")[1]).split(":");
        var ydate = (y.split(" ")[0]).split("/");
        y = new Date(ydate[2], ydate[1] - 1, ydate[0], yhour[0], yhour[1]);
        if (x > y) return 1;
        else if (x < y) return -1;
        else  {
            if (x2 > y2) return 1;
            else if (x2 < y2) return -1;
            else return 0;
        }
    }
</script>



<script>
    function getViewpoint(caseId) {
        $.post("/Case/GetLawyerViewpoint", { id: caseId }, function (out) {
            $('#txtProtectiveGoal').val(out.ProtectiveGoal);
            $('#txtOpeningProcedure').val(out.OpeningProcedure);
            $('#txtInquiryProcedure').val(out.InquiryProcedure);
            $('#txtArgumentProcedure').val(out.ArgumentProcedure);

            $('textarea[class*=autosize]').autosize({ append: "\n" });
        });
    }

    function updateViewpoint() {
        var caseId = $("#caseIdDiv").attr("value");
        var protectiveGoal = $('#txtProtectiveGoal').val();
        var openingProcedure = $('#txtOpeningProcedure').val();
        var inquiryProcedure = $('#txtInquiryProcedure').val();
        var argumentProcedure = $('#txtArgumentProcedure').val();

        $.post("/Case/UpdateLawyerViewpoint", {
            caseId: caseId, protectiveGoal: protectiveGoal, openingProcedure: openingProcedure,
            inquiryProcedure: inquiryProcedure, argumentProcedure: argumentProcedure
        }, function (result) {
            if (result == "success") {
                getViewpoint($("#caseIdDiv").attr("value"));
                setDeactiveComponentViewpoint();
                notification("Cập nhật quan điểm luật sư thành công!", "", 2000, "btn-primary center");
            } else if (result == "error") {
                notification("Cập nhật quan điểm luật sư thất bại!", "Hãy kiểm tra lại kết nối database.", 3000, "gritter-error center");
            }
        })
            .error(function () {
                notification("Cập nhật quan điểm luật sư thất bại!", "Hãy kiểm tra lại kết nối database.", 3000, "gritter-error center");
            });
    }

    function cancelUpdateViewpoint() {
        setDeactiveComponentViewpoint();
        getViewpoint($("#caseIdDiv").attr("value"));
    }

    function setDeactiveComponentViewpoint() {
        $('#txtProtectiveGoal').attr("disabled", "disabled");
        $('#txtOpeningProcedure').attr("disabled", "disabled");
        $('#txtInquiryProcedure').attr("disabled", "disabled");
        $('#txtArgumentProcedure').attr("disabled", "disabled");

        $('#divButtonUpdateViewpoint').hide();
    }

    function setActiveComponentViewpoint() {
        var authorize = $("#IsAuthorize").attr("value");
        if (authorize == "true") {

            $('#txtProtectiveGoal').removeAttr("disabled");
            $('#txtOpeningProcedure').removeAttr("disabled");
            $('#txtInquiryProcedure').removeAttr("disabled");
            $('#txtArgumentProcedure').removeAttr("disabled");

            $('#divButtonUpdateViewpoint').show();

        } else {
            if ($("#StatusDiv").attr("value") == "Đã thụ lý") {
                notification("Bạn không có quyền sửa hồ sơ này!", "Hồ sơ đang trong trạng thái đã thụ lý.", 3000, "gritter-error center");
            }else if ($("#OfficeStatusDiv").attr("value")== "false") {
                notification("Bạn không có quyền sửa hồ sơ này!", "Văn phòng đang tạm thời ngừng hoạt động.", 3000, "gritter-error center");

            } else notification("Bạn không có quyền sửa hồ sơ này!", "Liên hệ với quản lý hoặc luật sư trưởng.", 3000, "gritter-error center");
        }
    }
</script>



<script>
    function getFiles() {
        $('#peopleContent').hide();

        var caseId = $("#caseIdDiv").attr("value");
        $.post("/Case/GetFile", { caseId: caseId }, function (out) {
            if (out == "success") {
                $('.date-picker').datepicker('remove');
                removeEditor();
                $("#bodyContent").html("");

                var finder = new CKFinder();
                finder.height = "500px";
                finder.replace('bodyContent');
            }
        });
    }
</script>



<script>
    var law;
    function loadSelectOffices() {
        $.post("/Case/GetAllOfficeJson", {}, function (out) {
            var item = "";
            $.each(out, function (index, off) {
                item += '<option value="' + off.OfficeId + '">' + off.OfficeName + '</option>';
            });

            $('#cboOffice2').html(item);
            $("#cboOffice2").trigger("chosen:updated");
        });
    }
    function GetLawyerRelated(caseId, tableUpdate) {

        $('.date-picker').datepicker('remove');
        $("#selectLawyerRelated").html('<option value=""></option>');
        $("#selectLawyerRelated").trigger("chosen:updated");
        $('#subPeopleContent').html('');
        $('#lawyerLi').attr('class', 'active');
        $('#customerLi').attr('class', '');
        $('#subjectLi').attr('class', '');
        $('#lawyerLi').attr('style', 'font-weight: bold');
        $('#customerLi').attr('style', '');
        $('#subjectLi').attr('style', '');

        $.post("/Case/GetLawyerRelated", { caseId: caseId }, function (out) {
            document.getElementById("subPeopleContent").innerHTML = (out.html);
            law = out.result.Case_Staff;
            var itemLawyerRelated = '<tbody>';
            $.each(out.result.Case_Staff, function (index, lr) {
                itemLawyerRelated += '<tr>';
                itemLawyerRelated += '<td align="center"><a onClick="loadLawyerDetail(' + index + ')" data-toggle="modal" href="#modalLawyerRelated"><span class="profile-picture"><img src="' + lr.Staff.Avatar + '" class="editable-click" style="height: 60px !important"></img></span></a></td>';
                itemLawyerRelated += '<td><a onClick="loadLawyerDetail(' + index + ')" data-toggle="modal" href="#modalLawyerRelated">' + lr.Staff.StaffName + '</a></td>';
                itemLawyerRelated += '<td>' + lr.Staff.Accounts[0].Username + '</td>';
                itemLawyerRelated += '<td>' + lr.Staff.Position + '</td>';
                
                //itemLawyerRelated += '<td>' + lr.Staff.StaffGroup.StaffGroupName + '</td>';
                if (lr.Staff.Active == false) {
                    itemLawyerRelated += '<td><span class="label label-lg label-danger arrowed">Ngưng hoạt động</span></td>';
                }
                else if (lr.Staff.Active == true) {
                    itemLawyerRelated += '<td><span class="label label-lg label-success arrowed">Đang hoạt động</span></td>';
                }
                itemLawyerRelated += '<td>' + lr.Staff.Mobile + '</td>';
                itemLawyerRelated += '<td>' + lr.Staff.Email + '</td>';
                itemLawyerRelated += '<td style="display: none" class="center showHideColumnLawyer action-buttons">' +
                    '<a onClick="removeLawyerRelated(' + lr.CaseStaffId + ')" class="red" title="Loại bỏ" href="#"><i class="icon-trash bigger-130"></i></a></td>';
                itemLawyerRelated += '</tr>';
            });
            itemLawyerRelated += '</tbody>';
            $('#tblLawyerRelated').append(itemLawyerRelated);

            $('[data-rel=tooltip]').tooltip();

            $("#selectLawyerRelated").chosen();
            $("#selectLawyerRelated_chosen").css("width", "100%");
            $('.chosen-single').css("height", "40px");
            $("#cboOffice2").chosen();
            $("#cboOffice2_chosen").css("width", "100%");
            loadSelectOffices();
            if (tableUpdate) {
                showEditLawyer();
            }
            $("#bodyContent").html("");
            
        });

    }

    function loadLawyerDetail(index) {
        resetLawyerDetail();


        var array = new Array();
        $.each(law[index].Staff.Office_Staff, function (i, office) {
            array.push(office.OfficeId);
        });
        $("#cboOffice2").val(array);
        $("#cboOffice2").trigger("chosen:updated");

        $('#imgStaffAvatar').attr("src", law[index].Staff.Avatar);
        $('#txtStaffName').val(law[index].Staff.StaffName);
        $('#txtStaffUsername').val(law[index].Staff.Accounts[0].Username);
        $('#txtStaffPosition').val(law[index].Staff.Position);
        $('#txtStaffSex').val(law[index].Staff.Sex);
        $('#txtStaffGroupName').val(law[index].Staff.StaffGroup.StaffGroupName);
        if (law[index].Staff.DateOfBirth != null) {
            var dateBirth = convertNETDateTime(law[index].Staff.DateOfBirth).toLocaleFormat('%d/%m/%Y');
            $('#txtStaffDateOfBirth').val(dateBirth);
        }
        $('#txtStaffPlaceOfBirth').val(law[index].Staff.PlaceOfBirth);
        $('#txtStaffMobile').val(law[index].Staff.Mobile);
        $('#txtStaffTelephone').val(law[index].Staff.Telephone);
        $('#txtStaffEmail').val(law[index].Staff.Email);
        $('#txtStaffAddress').val(law[index].Staff.Address);
        $('#txtStaffRole').val(law[index].Staff.Role.RoleName);
        if (law[index].Staff.RoleId==1) {
            $("#listOfficeDiv").hide();
        } else $("#listOfficeDiv").show();
        $('#txtStaffIdentityNumber').val(law[index].Staff.IdentityNumber);
        if (law[index].Staff.IdentityDate != null) {
            var dateIdentity = convertNETDateTime(law[index].Staff.IdentityDate).toLocaleFormat('%d/%m/%Y');
            $('#txtStaffIdentityDate').val(dateIdentity);
        }
        $('#txtStaffIdentityPlace').val(law[index].Staff.IdentityPlace);
        $('#txtStaffTaxCode').val(law[index].Staff.TaxCode);
        $('#txtStaffBankAccount').val(law[index].Staff.BankAccount);
        $('#txtStaffBankBranch').val(law[index].Staff.BankBranch);
    }

    function resetLawyerDetail() {
        $('#imgStaffAvatar').val('');
        $('#txtStaffName').val('');
        $('#txtStaffUsername').val('');
        $('#txtStaffPosition').val('');
        $('#txtStaffSex').val('');
        $('#txtStaffGroupName').val('');
        $('#txtStaffDateOfBirth').val('');
        $('#txtStaffPlaceOfBirth').val('');
        $('#txtStaffMobile').val('');
        $('#txtStaffTelephone').val('');
        $('#txtStaffEmail').val('');
        $('#txtStaffAddress').val('');
        $('#txtStaffRole').val('');
        $('#txtStaffIdentityNumber').val('');
        $('#txtStaffIdentityDate').val('');
        $('#txtStaffIdentityPlace').val('');
        $('#txtStaffTaxCode').val('');
        $('#txtStaffBankAccount').val('');
        $('#txtStaffBankBranch').val('');
    }

    function showEditLawyer() {
        var authorize = $("#IsAuthorize").attr("value");
        if (authorize == "true") {

            if ($("#CanEditLawyer").attr("value") == 'true') {
                $(".showHideColumnLawyer").show();
                $("#btnEditGroupLawyer").show();

                $.post("/Case/GetLawyerByOffice", { officeId: offId }, function (out) {
                    var staffItem = '<option value=""></option>';
                    $.each(out, function (index, staff) {
                        staffItem += '<option value=' + staff.StaffId + '>' + staff.StaffName + ' (' + staff.Accounts[0].Username + ')</option>';
                    });
                    $("#selectLawyerRelated").html(staffItem);
                    $("#selectLawyerRelated").trigger("chosen:updated");
                });
            }else notification("Bạn không có quyền thay đổi luật sư!", "Liên hệ với quản lý hoặc người tạo hồ sơ.", 3000, "gritter-error center");
        } else {
            if ($("#StatusDiv").attr("value") == "Đã thụ lý") {
                notification("Bạn không có quyền sửa hồ sơ này!", "Hồ sơ đang trong trạng thái đã thụ lý.", 3000, "gritter-error center");
            } else if ($("#OfficeStatusDiv").attr("value")== "false") {
                notification("Bạn không có quyền sửa hồ sơ này!", "Văn phòng đang tạm thời ngừng hoạt động.", 3000, "gritter-error center");
            } else notification("Bạn không có quyền sửa hồ sơ này!", "Liên hệ với quản lý hoặc luật sư trưởng.", 3000, "gritter-error center");
        }
    }

    function hideEditLawyer() {
        $(".showHideColumnLawyer").hide();
        $("#btnEditGroupLawyer").hide();
    }

    function removeLawyerRelated(caseStaffId) {
        $(ace.click_event, function () {

            bootbox.confirm("Bạn thực sự muốn loại bỏ luật sư này?", function (result) {
                if (result) {
                    $.post("/Case/RemoveLawyerRelated", { caseStaffId: caseStaffId }, function (out) {
                        if (out == "success") {
                            GetLawyerRelated($("#caseIdDiv").attr("value"), true);
                            notification("Loại bỏ luật sư thành công!", "", 2000, "btn-primary center");
                        } else if (out == "error") {
                            notification("Loại bỏ luật sư thất bại!", "Hãy kiểm tra lại kết nối database.", 3000, "gritter-error center");
                        } else if (out == "creator") {
                            notification("Không thể loại bỏ luật sư khởi tạo!", "Liên hệ với quản lý hoặc người tạo hồ sơ.", 3000, "gritter-error center");
                        }
                    }).error(function () {
                        notification("Loại bỏ luật sư thất bại!", "Hãy kiểm tra lại kết nối database.", 3000, "gritter-error center");
                    });
                }
            });

        });
    }

    function addLawyerRelated() {
        var caseId = $("#caseIdDiv").attr("value");
        var staffId = $("#selectLawyerRelated option:selected").val();
        if (staffId != "" && staffId != null) {

            $.post("/Case/AddLawyerRelated", { caseId: caseId, staffId: staffId }, function (result) {
                if (result == "success") {
                    GetLawyerRelated(caseId, true);
                    notification("Đã phân công luật sư!", "", 2000, "btn-primary center");
                } else if (result == "error") {
                    notification("Phân công luật sư thất bại!", "Hãy kiểm tra lại kết nối database.", 3000, "gritter-error center");
                } else if (result == "exist") {
                    notification("Đã tồn tại luật sư!", "Vui lòng chọn luật sư khác.", 3000, "gritter-error center");
                    showEditLawyer();
                }
            })
                .error(function () {
                    notification("Phân công luật sư thất bại!", "Hãy kiểm tra lại kết nối database.", 3000, "gritter-error center");
                });

        } else    notification("Hãy chọn 1 luật sư!", "", 3000, "gritter-error center");
    }
</script>



<script>
    var cus;
    function GetCustomerRelated(caseId, tableUpdate) {
        $('.date-picker').datepicker('remove');
        $("#selectCustomerRelated").html('<option value=""></option>');
        $("#selectCustomerRelated").trigger("chosen:updated");

        $('#subPeopleContent').html('');
        $('#lawyerLi').attr('class', '');
        $('#customerLi').attr('class', 'active');
        $('#customerLi').attr('style', 'font-weight: bold');
        $('#lawyerLi').attr('style', '');
        $('#subjectLi').attr('style', '');
        
        $('#subjectLi').attr('class', '');

        $.post("/Case/GetCustomerRelated", { caseId: caseId }, function (out) {
            document.getElementById("subPeopleContent").innerHTML = (out.html);
            cus = out.result.Case_Customer;

            var itemCustomerRelated = '<tbody>';
            $.each(out.result.Case_Customer, function (index, cr) {
                itemCustomerRelated += '<tr>';

                itemCustomerRelated += '<td><a onClick="loadCustomerDetail(' + index + ')" data-toggle="modal" href="#modalCustomerRelated">' + cr.Customer.CustomerName + '</a></td>';
                itemCustomerRelated += '<td>' + cr.Customer.Representative + '</td>';
                itemCustomerRelated += '<td>' + cr.Customer.CustomerGroup.CustomerGroupName + '</td>';
                itemCustomerRelated += '<td>' + cr.Customer.Address + '</td>';
                itemCustomerRelated += '<td>' + cr.Customer.Mobile + '</td>';
                itemCustomerRelated += '<td style="display: none" class="center showHideColumnCustomer action-buttons">' +
                    '<a onClick="removeCustomerRelated(' + cr.CaseCustomerId + ')" class="red" title="Loại bỏ" href="#"><i class="icon-trash bigger-130"></i></a></td>';

                itemCustomerRelated += '</tr>';
            });
            itemCustomerRelated += '</tbody>';
            $('#tblCustomerRelated').append(itemCustomerRelated);

            $('[data-rel=tooltip]').tooltip();
            $('.date-picker').datepicker({ autoclose: true }).next().on(ace.click_event, function () {
                $(this).prev().focus();
            });
            $("#selectCustomerRelated").chosen();
            $("#selectCustomerRelated_chosen").css("width", "100%");
            $('.chosen-single').css("height", "40px");

            if (tableUpdate) {
                prevSearch = "";
                showEditCustomer();
            }
            disablebutton();
            loadSelectCustomerGroup();
        });
    }

    function GetCustomersAutoSearch(searchTxt) {
        if (searchTxt == "") return $("#selectCustomerRelated_chosen").find(".chosen-results").html("");
        $.post("/Case/GetCustomersAutoSearch", { cusName: searchTxt }, function (out) {
            if (out == "") {
                if (prevSearch == "") $("#selectCustomerRelated_chosen").find(".chosen-results").html("");
                else $("#selectCustomerRelated_chosen").find(".chosen-results").html('<li class="no-results">Không tìm thấy: "<span>' + prevSearch + '</span>"</li>');
                return;
            }
            var searchText = ($("#selectCustomerRelated_chosen").find("input")).val();

            var customerItem = '<option value=""></option>';
            $.each(out, function (index, cus) {
                customerItem += '<option value=' + cus.CustomerId + '>' + cus.CustomerName + ' (' + cus.Address + ')</option>';
            });
            $("#selectCustomerRelated").html(customerItem);
            $("#selectCustomerRelated").trigger("chosen:updated");

            ($("#selectCustomerRelated_chosen").find("input")).val(searchText);
        });
    }

    function enablebutton() {
        //Cho phep user edit
        validateCustomer('#updateCustomerValidateForm');
        $('.editableInput').removeAttr("readonly");
        $('.editableSelect').removeAttr("disabled");
        $('.editableGender').removeAttr("disabled");
        $('#txtCustomerDateOfBirth').attr("style", "width: 100%;cursor: pointer; background: none repeat scroll 0 0 #fff !important");
        $('#txtCustomerIdentityDate').attr("style", "width: 100%;cursor: pointer; background: none repeat scroll 0 0 #fff !important");

        $('#savebutton').show();
        $('#enablebutton').hide();
    }

    function disablebutton() {
        //Khong cho user edit cac field
        $('.editableInput').attr("readonly", "");
        $('.editableSelect').attr("disabled", "disabled");
        $('.editableGender').attr("disabled", "disabled");
        $("#txtCustomerDateOfBirth").css("background", "");
        $("#txtCustomerIdentityDate").css("background", "");
        $('#enablebutton').show();
        $('#disablebutton').hide();
    }

    function updateCustomer() {
        if ($('#updateCustomerValidateForm').valid()) {
            var cusId = $('#detailCustomerId').val();
            var cusname = $('#txtCustomerName').val();
            var selectCustomerGroup = $('#txtCustomerGroup option:selected').val();
            var represent = $('#txtCustomerRepresentative').val();
            var sex = "";
            if (document.getElementById('genderMale').checked) {
                sex = document.getElementById('genderMale').value;
            } else if (document.getElementById('genderFemale').checked) {
                sex = document.getElementById('genderFemale').value;
            }
            var birthDay = $('#txtCustomerDateOfBirth').val();
            var identityNum = $('#txtCustomerIdentityNumber').val();
            var identityDate = $('#txtCustomerIdentityDate').val();
            var identityPlace = $('#txtCustomerIdentityPlace').val();
            var bankAccount = $('#txtCustomerBankAccount').val();
            var bankBranch = $('#txtCustomerBankAccount').val();
            var taxCode = $('#txtCustomerTaxCode').val();
            var address = $('#txtCustomerAddress').val();
            var email = $('#txtCustomerEmail').val();
            var mobile = $('#txtCustomerMobile').val();
            var telephone = $('#txtCustomerTelephone').val();
            $("#savebutton").hide();
            $.post("/Case/UpdateCustomer", {
                id: cusId, name: cusname, selectCustomerGroup: selectCustomerGroup, represent: represent, sex: sex,
                birthDay: birthDay, identityNum: identityNum, identityDate: identityDate, identityPlace: identityPlace,
                bankAccount: bankAccount, bankBranch: bankBranch, taxCode: taxCode, address: address, email: email,
                mobile: mobile, telephone: telephone
            }, function (result) {
                if (result == "success") {
                    notification("Chỉnh sửa khách hàng thành công!", "", 3000, "btn-primary center");
                    GetCustomerRelated($("#caseIdDiv").attr("value"), true);
                } else {
                    notification("Chỉnh sửa khách hàng thất bại!", "Hãy kiểm tra lại kết nối database.", 5000, "gritter-error center");
                }
            })
                .error(function () {
                    notification("Chỉnh sửa khách hàng thất bại!", "Có lỗi xảy ra trong quá trình chỉnh sửa khách hàng.", 5000, "gritter-error center");
                });
            $('.close').click();
            validator.resetForm();
        }
    }
    function loadCustomerDetail(index) {
        resetCustomerDetail();
        $("#savebutton").hide();

        validator.resetForm();
        $("#txtCustomerMobile").numeric({ decimal: false, negative: false });
        $("#txtCustomerTelephone").numeric({ decimal: false, negative: false });
        $('#detailCustomerId').val(cus[index].Customer.CustomerId);

        $('#txtCustomerName').val(cus[index].Customer.CustomerName);
        $('#txtCustomerGroup').val(cus[index].Customer.CustomerGroup.CustomerGroupId);
        $('#txtCustomerRepresentative').val(cus[index].Customer.Representative);
        $('#txtCustomerTaxCode').val(cus[index].Customer.TaxCode);
        if (cus[index].Customer.DateOfBirth != null) {
            var dateBirth = convertNETDateTime(cus[index].Customer.DateOfBirth).toLocaleFormat('%d/%m/%Y');
            $('#txtCustomerDateOfBirth').val(dateBirth);
        }
        $("#genderMale").prop("checked", false);
        $("#genderFemale").prop("checked", false);
        if (cus[index].Customer.Sex == 'Nam') {
            $("#genderMale").prop("checked", true);
        } else if (cus[index].Customer.Sex == 'Nữ') {
            $("#genderFemale").prop("checked", true);
        }
        $('#txtCustomerIdentityNumber').val(cus[index].Customer.IdentityNumber);
        if (cus[index].Customer.IdentityDate != null) {
            var identityDate = convertNETDateTime(cus[index].Customer.IdentityDate).toLocaleFormat('%d/%m/%Y');
            $('#txtCustomerIdentityDate').val(identityDate);
        }
        $('#txtCustomerIdentityPlace').val(cus[index].Customer.IdentityPlace);
        $('#txtCustomerBankAccount').val(cus[index].Customer.BankAccount);
        $('#txtCustomerBankBranch').val(cus[index].Customer.BankBranch);
        $('#txtCustomerMobile').val(cus[index].Customer.Mobile);
        $('#txtCustomerTelephone').val(cus[index].Customer.Telephone);
        $('#txtCustomerEmail').val(cus[index].Customer.Email);
        $('#txtCustomerAddress').val(cus[index].Customer.Address);
        disablebutton();
        $('#txtCustomerDateOfBirth').attr("style", "width: 100%;cursor: pointer; background: none repeat scroll 0 0 #f5f5f5 !important");
        $('#txtCustomerIdentityDate').attr("style", "width: 100%;cursor: pointer; background: none repeat scroll 0 0 #f5f5f5 !important");
    }

    function resetCustomerDetail() {
        $('#txtCustomerName').val('');
        $('#txtCustomerRepresentative').val('');
        $('#txtCustomerGroup').val('');
        $('#txtCustomerBankAccount').val('');
        $('#txtCustomerDateOfBirth').val('');
        $('#txtCustomerBankBranch').val('');
        $('#txtCustomerTaxCode').val('');
        $('#txtCustomerIdentityNumber').val('');
        $('#txtCustomerMobile').val('');
        $('#txtCustomerIdentityDate').val('');
        $('#txtCustomerTelephone').val('');
        $('#txtCustomerIdentityPlace').val('');
        $('#txtCustomerEmail').val('');
        $('#txtCustomerAddress').val('');
        $("#genderMale").prop("checked", false);
        $("#genderFemale").prop("checked", false);
        $('#txtCustomerGroup').val("");
    }

    var prevSearch = "";
    function showEditCustomer() {
        var authorize = $("#IsAuthorize").attr("value");
        if (authorize == "true") {
            $(".showHideColumnCustomer").show();
            $("#btnEditGroupCustomer").show();

            // kich hoat su kien tu dong search
            ($("#selectCustomerRelated_chosen").find("input")).keyup(function () {
                var searchTxt = ($("#selectCustomerRelated_chosen").find("input")).val();
                if (searchTxt == prevSearch) return;
                prevSearch = searchTxt;
                if ('<i class="icon-spinner icon-spin orange bigger-200"></i>' != $("#selectCustomerRelated_chosen").find(".chosen-results").html())
                    $("#selectCustomerRelated_chosen").find(".chosen-results").html('<i class="icon-spinner icon-spin orange bigger-200"></i>');
                delaySearch(function () {
                    GetCustomersAutoSearch(searchTxt);
                }, 500);
            });
        } else {
            if ($("#StatusDiv").attr("value") == "Đã thụ lý") {
                notification("Bạn không có quyền sửa hồ sơ này!", "Hồ sơ đang trong trạng thái đã thụ lý.", 3000, "gritter-error center");
            } else if ($("#OfficeStatusDiv").attr("value")== "false") {
                notification("Bạn không có quyền sửa hồ sơ này!", "Văn phòng đang tạm thời ngừng hoạt động.", 3000, "gritter-error center");

            }else notification("Bạn không có quyền sửa hồ sơ này!", "Liên hệ với quản lý hoặc luật sư trưởng.", 3000, "gritter-error center");
        }
    }

    function hideEditCustomer() {
        $(".showHideColumnCustomer").hide();
        $("#btnEditGroupCustomer").hide();
    }

    function removeCustomerRelated(id) {
        $(ace.click_event, function () {
            bootbox.confirm("Bạn thực sự muốn loại bỏ khách hàng này?", function (result) {
                if (result) {
                    $.post("/Case/RemoveCustomerRelated", { caseCustomerId: id }, function (out) {
                        if (out == "success") {
                            GetCustomerRelated($("#caseIdDiv").attr("value"), true);
                            notification("Loại bỏ khách hàng thành công!", "", 2000, "btn-primary center");
                        } else if (out == "error") {
                            notification("Loại bỏ khách hàng thất bại!", "Hãy kiểm tra lại kết nối database.", 3000, "gritter-error center");
                        }
                    })
                        .error(function () {
                            notification("Loại bỏ khách hàng thất bại!", "Hãy kiểm tra lại kết nối database.", 3000, "gritter-error center");
                        });
                }
            });
        });
    }

    function addCustomerRelated() {
        var caseId = $("#caseIdDiv").attr("value");
        var customerId = $("#selectCustomerRelated option:selected").val();
        if (customerId != "" && customerId != null) {

            $.post("/Case/AddCaseCustomer", { caseId: caseId, customerId: customerId }, function (result) {
                if (result == "success") {
                    GetCustomerRelated(caseId, true);

                    notification("Thêm khách hàng thành công!", "", 2000, "btn-primary center");
                } else if (result == "error") {
                    notification("Thêm khách hàng thất bại!", "Hãy kiểm tra lại kết nối database.", 3000, "gritter-error center");
                } else if (result == "exist") {
                    notification("Đã tồn tại khách hàng!", "Vui lòng chọn khách hàng khác.", 3000, "gritter-error center");
                    showEditCustomer();

                }
            }).error(function () {
                notification("Thêm khách hàng thất bại!", "Hãy kiểm tra lại kết nối database.", 3000, "gritter-error center");
            });
        } else notification("Hãy chọn 1 khách hàng!", "", 3000, "gritter-error center");
    }
</script>

<script>
    function clearFieldCustomer() {
        $('#txtName').val("");
        $('#selectCustomerGroup').val("0");
        $('#txtRepresent').val("");
        $('#sexMale').removeAttr("checked");
        $('#sexFemale').removeAttr("checked");
        $('#datePickerBD').val("");
        $('#txtIdentityNum').val("");
        $('#datePickerNC').val("");
        $('#txtIdentityPlace').val("");
        $('#txtBankAccount').val("");
        $('#txtBankBranch').val("");
        $('#txtTaxCode').val("");
        $('#txtAddress').val("");
        $('#txtEmail').val("");
        $('#txtMobile').val("");
        $('#txtTelephone').val("");
    }

    function prepareAddCustomer() {
        validateCustomer('#addCustomerValidateForm');
        $("#txtMobile").numeric({ decimal: false, negative: false });
        $("#txtTelephone").numeric({ decimal: false, negative: false });
    }

    function addCustomer() {
        if ($('#addCustomerValidateForm').valid()) {
            var caseId = $("#caseIdDiv").attr("value");
            var cusname = $('#txtName').val();
            var selectCustomerGroup = $('#selectCustomerGroup').val();
            var represent = $('#txtRepresent').val();
            var sex = "";
            if (document.getElementById('sexMale').checked) {
                sex = document.getElementById('sexMale').value;
            } else if (document.getElementById('sexFemale').checked) {
                sex = document.getElementById('sexFemale').value;
            }
            var birthDay = $('#datePickerBD').val();
            var identityNum = $('#txtIdentityNum').val();
            var identityDate = $('#datePickerNC').val();
            var identityPlace = $('#txtIdentityPlace').val();
            var bankAccount = $('#txtBankAccount').val();
            var bankBranch = $('#txtBankBranch').val();
            var taxCode = $('#txtTaxCode').val();
            var address = $('#txtAddress').val();
            var email = $('#txtEmail').val();
            var mobile = $('#txtMobile').val();
            var telephone = $('#txtTelephone').val();
            $("#tblAddCustomer").find('.close').click();

            $.post("/Case/CreateCusAndAddToCase", {
                cusname: cusname, selectCustomerGroup: selectCustomerGroup, represent: represent, sex: sex,
                birthDay: birthDay, identityNum: identityNum, identityDate: identityDate, identityPlace: identityPlace,
                bankAccount: bankAccount, bankBranch: bankBranch, taxCode: taxCode, address: address, email: email,
                mobile: mobile, telephone: telephone, caseId: caseId
            }, function (result) {
                if (result == "success") {
                    clearFieldCustomer();
                    notification("Tạo khách hàng thành công!", "", 2000, "btn-primary center");
                    GetCustomerRelated($("#caseIdDiv").attr("value"), true);
                } else {
                    $('.close').click();
                    notification("Tạo khách hàng thất bại!", "Hãy kiểm tra lại kết nối database.", 3000, "gritter-error center");
                }
            }).error(function () {
                $('.close').click();
                notification("Tạo khách hàng thất bại!", "Có lỗi xảy ra trong quá trình tạo khách hàng.", 3000, "gritter-error center");
            });
        }
    }

    function loadSelectCustomerGroup() {
        $.ajax({
            url: "/Case/GetAllCustomerGroupJson",
            type: 'POST',
            async: false,
            success: function (data) {
                if (data != "") {
                    var item = '';
                    $.each(data, function (index, customer) {
                        item += '<option value="' + customer.CustomerGroupId + '">' + customer.CustomerGroupName + '</option>';
                    });
                    $('#selectCustomerGroup').html(item);

                    $('#txtCustomerGroup').html(item);

                    $('#selectCustomerGroup').val('');
                }
            },
            error: function (errMsg) {
                alert(errMsg.responseText);
            }
        });
        validateCustomer('#addCustomerValidateForm');
    }

    var validator;
    function validateCustomer(validateform) {
        validator = $(validateform).validate({
            errorElement: 'div',
            errorClass: 'help-block',
            focusInvalid: false,
            rules: {
                txtName: {
                    required: true
                },
                txtRepresent: {
                    required: true
                },
                selectCustomerGroup: {
                    required: true

                },
                txtAddress: {
                    required: true
                },
                txtEmail: {
                    email: true
                },
                txtMobile: {
                    required: true,
                }
            },
            messages: {
                txtName: {
                    required: "Nhập tên khách hàng!"
                },
                txtRepresent: {
                    required: "Nhập tên người đại diện!"
                },
                selectCustomerGroup: {
                    required: "Chọn nhóm khách hàng!"
                },
                txtAddress: {
                    required: "Nhập địa chỉ!"
                },
                txtEmail: {
                    email: "Email chưa đúng định dạng!"
                },
                txtMobile: {
                    required: "Nhập số điện thoại di động!"
                }
            },
            highlight: function (e) {
                $(e).closest('.form-group').removeClass('has-info').addClass('has-error');
            },

            success: function (e) {
                $(e).closest('.form-group').removeClass('has-error').addClass('has-info');
                $(e).remove();
            },
            errorPlacement: function (error, element) {
                if (element.is(':checkbox') || element.is(':radio')) {
                    var controls = element.closest('div[class*="col-"]');
                    if (controls.find(':checkbox,:radio').length > 1) controls.append(error);
                    else error.insertAfter(element.nextAll('.lbl:eq(0)').eq(0));
                } else error.insertAfter(element.parent());
            }
        });
    }
</script>



<script>
    var sub;
    function GetSubjectRelated(caseId, tableUpdate) {
        $('.date-picker').datepicker('remove');
        $('#subPeopleContent').html('');
        $('#lawyerLi').attr('class', '');
        $('#customerLi').attr('class', '');
        $('#subjectLi').attr('class', 'active');
        $('#subjectLi').attr('style', 'font-weight: bold');
        $('#customerLi').attr('style', '');
        $('#lawyerLi').attr('style', '');
        $.post("/Case/GetSubjectRelated", { caseId: caseId }, function (out) {
            document.getElementById("subPeopleContent").innerHTML = (out.html);
            sub = out.result;

            var itemSubjectRelated = '<tbody>';
            $.each(out.result, function (index, sr) {
                itemSubjectRelated += '<tr>';

                itemSubjectRelated += '<td>' + sr.subjectName + '</td>';
                itemSubjectRelated += '<td>' + sr.litigationCapacity + '</td>';
                itemSubjectRelated += '<td>' + sr.address + '</td>';
                itemSubjectRelated += '<td>' + sr.phoneNumber + '</td>';
                itemSubjectRelated += '<td>' + sr.email + '</td>';
                itemSubjectRelated += '<td style="display: none" class="center showHideColumnSubject action-buttons">' +
                    '<a onClick="loadSubjectDetail(' + index + ')" data-toggle="modal" href="#modalSubjectRelated" class="green" title="Chỉnh sửa"><i class="icon-pencil bigger-130"></i></a>' +
                    '<a onClick="deleteSubject(' + sr.subjectId + ')" class="red" title="Xóa" href="#"><i class="icon-trash bigger-130"></i></a></td>';

                itemSubjectRelated += '</tr>';
            });
            itemSubjectRelated += '</tbody>';
            itemSubjectRelated = itemSubjectRelated.split("null").join("");
            $('#tblSubjectRelated').append(itemSubjectRelated);

            if (tableUpdate) {
                showEditSubject();
            }

            $('[data-rel=tooltip]').tooltip();

            // validate
            $("#txtSubjectPhoneNumber").numeric({ decimal: false, negative: false });
            validateSubjectForm('#subjectValidateForm');
        });
    }

    function loadSubjectDetail(index) {
        prepareForUpdateSubject();

        $('#txtSubjectId').val(sub[index].subjectId);
        $('#txtSubjectName').val(sub[index].subjectName);
        $('#txtLitigationCapacity').val(sub[index].litigationCapacity);
        $('#txtSubjectPhoneNumber').val(sub[index].phoneNumber);
        $('#txtSubjectEmail').val(sub[index].email);
        $('#txtSubjectAddress').val(sub[index].address);
    }

    function resetSubjectDetail() {
        $('#txtSubjectId').val('');
        $('#txtSubjectName').val('');
        $('#txtLitigationCapacity').val('');
        $('#txtSubjectPhoneNumber').val('');
        $('#txtSubjectEmail').val('');
        $('#txtSubjectAddress').val('');
    }

    function showEditSubject() {
        var authorize = $("#IsAuthorize").attr("value");
        if (authorize == "true") {
            $(".showHideColumnSubject").show();
            $("#btnEditGroupSubject").show();
        } else {
            if ($("#StatusDiv").attr("value") == "Đã thụ lý") {
                notification("Bạn không có quyền sửa hồ sơ này!", "Hồ sơ đang trong trạng thái đã thụ lý.", 3000, "gritter-error center");
            } else if ($("#OfficeStatusDiv").attr("value")== "false") {
                notification("Bạn không có quyền sửa hồ sơ này!", "Văn phòng đang tạm thời ngừng hoạt động.", 3000, "gritter-error center");

            }else notification("Bạn không có quyền sửa hồ sơ này!", "Liên hệ với quản lý hoặc luật sư trưởng.", 3000, "gritter-error center");
        }

    }

    function hideEditSubject() {
        $(".showHideColumnSubject").hide();
        $("#btnEditGroupSubject").hide();
    }

    function prepareForAddSubject() {
        resetSubjectDetail();
        $('#btnAddSubject').show();
        $('#btnUpdateSubject').hide();
    }

    function prepareForUpdateSubject() {
        resetSubjectDetail();
        $('#btnAddSubject').hide();
        $('#btnUpdateSubject').show();
    }

    function deleteSubject(id) {
        $(ace.click_event, function () {
            bootbox.confirm("Bạn thực sự muốn xóa chủ thể này?", function (result) {
                if (result) {
                    $.post("/Case/DeleteSubject", { subjectId: id }, function (out) {
                        if (out == "success") {
                            GetSubjectRelated($("#caseIdDiv").attr("value"), true);
                            notification("Xóa chủ thể thành công!", "", 2000, "btn-primary center");
                        } else if (out == "error") {
                            notification("Xóa chủ thể thất bại!", "Hãy kiểm tra lại kết nối database.", 3000, "gritter-error center");
                        }
                    })
                        .error(function () {
                            notification("Xóa chủ thể thất bại!", "Hãy kiểm tra lại kết nối database.", 3000, "gritter-error center");
                        });
                }
            });
        });
    }

    function addSubject() {
        if ($('#subjectValidateForm').valid()) {
            var subjectName = $('#txtSubjectName').val();
            var litigationCapacity = $('#txtLitigationCapacity').val();
            var address = $('#txtSubjectAddress').val();
            var phoneNumber = $('#txtSubjectPhoneNumber').val();
            var email = $('#txtSubjectEmail').val();
            var caseId = $("#caseIdDiv").attr("value");

            $.post("/Case/AddSubject", {
                subjectName: subjectName, litigationCapacity: litigationCapacity, address: address,
                phoneNumber: phoneNumber, email: email, caseId: caseId
            }, function (result) {
                if (result == "success") {
                    GetSubjectRelated($("#caseIdDiv").attr("value"), true);
                    notification("Thêm chủ thể mới thành công!", "", 2000, "btn-primary center");
                } else if (result == "error") {
                    notification("Thêm chủ thể mới thất bại!", "Hãy kiểm tra lại kết nối database.", 3000, "gritter-error center");
                }
            })
                .error(function () {
                    notification("Thêm chủ thể mới thất bại!", "Hãy kiểm tra lại kết nối database.", 3000, "gritter-error center");
                });
            $('#btnCloseSubject').click();
            $(".modal-backdrop").remove();
        }
    }

    function updateSubject() {
        if ($('#subjectValidateForm').valid()) {
            var subjectId = $('#txtSubjectId').val();
            var subjectName = $('#txtSubjectName').val();
            var litigationCapacity = $('#txtLitigationCapacity').val();
            var address = $('#txtSubjectAddress').val();
            var phoneNumber = $('#txtSubjectPhoneNumber').val();
            var email = $('#txtSubjectEmail').val();
            $.post("/Case/UpdateSubject", {

                subjectId: subjectId, subjectName: subjectName, litigationCapacity: litigationCapacity, address: address,
                phoneNumber: phoneNumber, email: email
            }, function (result) {
                if (result == "success") {
                    GetSubjectRelated($("#caseIdDiv").attr("value"), true);
                    notification("Cập nhật chủ thể thành công!", "", 2000, "btn-primary center");
                } else if (result == "error") {
                    notification("Cập nhật chủ thể thất bại!", "Hãy kiểm tra lại kết nối database.", 3000, "gritter-error center");
                }
            }).error(function () {
                notification("Cập nhật chủ thể thất bại!", "Hãy kiểm tra lại kết nối database.", 3000, "gritter-error center");
            });
            $('#btnCloseSubject').click();
            $(".modal-backdrop").remove();
        }
    }

    function validateSubjectForm(validateform) {
        $(validateform).validate({
            errorElement: 'div',
            errorClass: 'help-block',
            focusInvalid: false,
            rules: {
                txtSubjectName: {
                    required: true
                },
                txtLitigationCapacity: {
                    required: true
                },
                txtSubjectEmail: {
                    email: true
                }
            },
            messages: {
                txtSubjectName: {
                    required: "Nhập tên chủ thể!"
                },
                txtLitigationCapacity: {
                    required: "Nhập tư cách tố tụng!"
                },
                txtSubjectEmail: {
                    email: "Email chưa đúng định dạng!"
                }
            },
            highlight: function (e) {
                $(e).closest('.form-group').removeClass('has-info').addClass('has-error');
            },
            success: function (e) {
                $(e).closest('.form-group').removeClass('has-error').addClass('has-info');
                $(e).remove();
            },
            errorPlacement: function (error, element) {
                if (element.is(':checkbox') || element.is(':radio')) {
                    var controls = element.closest('div[class*="col-"]');
                    if (controls.find(':checkbox,:radio').length > 1) controls.append(error);
                    else error.insertAfter(element.nextAll('.lbl:eq(0)').eq(0));
                }
                else error.insertAfter(element.parent());
            }
        });
    }
</script>



<script>
    function getPeople(caseId) {
        removeEditor();
        $('#peopleContent').show();
        $('#subPeopleContent').html('');
        GetLawyerRelated(caseId, false);

    }
</script>


<script>
    var xhr = "";
    $('#id-date-range-picker').daterangepicker(
        { showDropdowns: true, startDate: "1/1/1945", endDate: moment(), minDate: "1/1/1945", maxDate: moment(), format: "DD/MM/YYYY", separator: " đến " }).prev().on(ace.click_event, function () {
            $(this).next().focus();
        });
    $('#id-date-range-picker').val($('input[name=daterangepicker_start]').val() + ' đến ' + $('input[name=daterangepicker_end]').val());
    $(".cv-tcvn").hide();
    $(".hideSearch").hide();

    function hideSearchMethod() {
        if ($("#hideSearchMethodBtn").text() == "+ Thêm điều kiện") {
            $(".hideSearch").show();
            $("#hideSearchMethodBtn").text("- Bớt điều kiện");
        } else {
            $(".hideSearch").hide();
            $("#hideSearchMethodBtn").text("+ Thêm điều kiện");
        }
    }

    var isSearchLab = false;
    $('#searchBtn').click(function () {
        if (!isSearchLab) {
            $("#searchBtn").find("i").appendTo($("#searchBtn").find("button"));
            $("#searchBtn").find("span").text("Đóng");
            $($("#searchBtn").find("i")).attr("class", "icon-arrow-right icon-on-right");

            $("#searchtvplContent").show();

            $("#searchBtn").css("right", "900px");
            isSearchLab = true;
        } else {
            $("#searchBtn").find("span").text(" Thư Viện");
            $("#searchBtn").find("span").appendTo($("#searchBtn").find("button"));
            $($("#searchBtn").find("i")).attr("class", "icon-arrow-left icon-on-right");

            $("#searchtvplContent").hide();
            $("#searchBtn").css("right", "0");
            isSearchLab = false;
        }
    });
    var valType = "VB";

    function changeSearch(typeSearch) {
        $("#tabSearchtvpl").find("li").attr("class", "");
        $("#tabSearchtvpl").find("a").css({ 'font-weight': '' });
        $(typeSearch).attr("class", "active");
        $(typeSearch).find("a").css({ 'font-weight': 'bold' });
        if ($(typeSearch).is($("#vbplLi"))) {
            valType = "VB";
            $("#documentTypeDropDownListVbpl").show();
            $("#documentTypeDropDownListTcvn").hide();
            $(".vbpl-tcvn").show();
            $("#searchText").attr("placeholder", "Tìm kiếm văn bản pháp luật...");
        } else if ($(typeSearch).is($("#cvLi"))) {
            valType = "CV";
            $(".vbpl-tcvn").hide();
            $("#searchText").attr("placeholder", "Tìm kiếm công văn...");
        } else if ($(typeSearch).is($("#tcvnLi"))) {
            valType = "TC";
            $("#documentTypeDropDownListTcvn").show();
            $("#documentTypeDropDownListVbpl").hide();
            $(".vbpl-tcvn").show();
            $("#searchText").attr("placeholder", "Tìm kiếm tiêu chuẩn Việt Nam...");

        }
    }

    function searchKeyWord() {
        $("#searchWait").css("visibility","visible");
        var keyword = $('#searchText').val();
        keyword = encodeURIComponent(keyword);
        var area = $('#searchArea input:checked').val();
        var bdate = $("#id-date-range-picker").val().split(" đến ")[0];
        var edate = $("#id-date-range-picker").val().split(" đến ")[1];
        var signer = 0;
        var org = 0;

        var type = 3;
        if (valType == 'VB') {
            type = $('#documentTypeDropDownListVbpl').val();
        } else if (valType == 'TC') {
            type = $('#documentTypeDropDownListTcvn').val();
        }
        var status = 0;

        if (valType == 'VB' || valType == 'TC') {
            status = $('#ddlStatus').val();
        }
        var ngonngu = 1;
        var match = $('#searchMath input:checked').val();
        var sort = $('#sortDropDownList').val();
        if ($("#hideSearchMethodBtn").text() == "+ Thêm điều kiện") {
            type = 3;
            if (valType == 'VB') {
                type = 0;
            } else if (valType == 'TC') {
                type = 39;
            }
            status = 0;
            ngonngu = 1;
            match = "True";
            sort = 1;
        }
        $("#searchDocBtn").attr("disabled","disabled");
        if (xhr != "") xhr.abort();
        xhr = $.ajax({
            url: '/Proxy/SearchDoc',
            method: 'POST',
            async:true,
            data: {
                keyword: keyword,
                area: area,
                type: type,
                status: status,
                lan: ngonngu,
                org: org,
                signer: signer,
                match: match,
                sort: sort,
                bdate: bdate,
                edate: edate,
                scan: 0,
                fields: 0,
                page: 0
            },
            success: function (out) {
                showSearchResult(out);
                $("#searchDocBtn").removeAttr("disabled");
            }

        });
    }
    $("#searchDocBtn").removeAttr("disabled");
    function searchFieldAndPage(searchString) {
        $("#searchWait").css("visibility","visible");
        field = searchString.split("fields=")[1];
        field = field.split("&page=")[0];
        $("#searchDocBtn").attr("disabled","disabled");
        xhr = $.post("/Proxy/SearchFieldAndPage", { searchString: searchString }, function (out) {
            showSearchResult(out);
            $("#searchDocBtn").removeAttr("disabled");
        });

    }

    var field = 0;
    function showSearchResult(result) {
        $("#searchResult").html(result);
        $("#searchWait").css("visibility","hidden");
        $.each($("#tree").find("li"), function (element, index) {
            var link = $(this).find("a").attr("href").split('http://thuvienphapluat.vn/phap-luat/tim-van-ban.aspx?').join("");
            $($(this).find("a")[0]).attr("onClick", 'searchFieldAndPage("' + link + '")');
            $($(this).find("a")[1]).attr("onClick", 'searchFieldAndPage("' + link + '")');
            $($(this).find("a")[1]).removeAttr("href");
            $($(this).find("a")[0]).removeAttr("href");

            if ($($(this).find("a")[0]).attr("atr") == field) {
                $($(this).find("a")[0]).css({ fontWeight: 'bold', color: '#F79A18' });
            }

        });


        $.each($(".cmPager").find("a"), function (element, index) {
            var link = $(this).attr("href");
            $(this).attr("onClick", 'searchFieldAndPage("' + link + '")');
            $(this).removeAttr("href");
        });
        $("#block-info-advan").css("width", "100%");
        $($("#block-info-advan").children()[1]).css("width", "710px");
        $($("#block-info-advan").children()[1]).attr("class", "jscrollPanelDiv");
        $($("#block-info-advan").children()[1]).jScrollPane({ mouseWheelSpeed: 30 });
        $('.jspContainer').on('mousewheel', function (event) {
            $(".jspDrag").attr("class", "jspDrag jspActive");
            clearTimeout($.data(this, 'timer'));
            $.data(this, 'timer', setTimeout(function () {
                $(".jspDrag").attr("class", "jspDrag");
            }, 600));
        });
        $(".cmPager").appendTo(".jscrollPanelDiv");
        $(".jspPane").find(".nqTitle a").removeAttr("href onClick");
        $.each($(".links-bot"), function (element, index) {
            $(this).find("a").removeAttr("onmouseout onmouseover onClick style");
            var review = $($(this).find("a")[5]).attr("href");
            var downLink = $($(this).find("a")[4]).attr("href");
            $($(this).find("a")[0]).text("Xem trước nội dung").attr("onClick", 'reviewDoc("' + review + '")').attr("href","#reviewPopup").attr( "data-toggle","modal");
            $($(this).find("a")[1]).text("Tải về").attr("onClick", 'downloadFile("' + downLink + '")').removeAttr("href");

            var text = $(this).html().split("|")[0] + "|" + $(this).html().split("|")[1];
            $(this).html(text);
        });

    }

    function reviewDoc(review) {
        $("#reviewWait").show();
        $("#reviewContent").html("");
        $.post("/Proxy/ReviewDoc", { url: review }, function(out) {
            $("#reviewWait").hide();
            if (out.indexOf("đang cập nhật nội dung") != -1) {
                $("#reviewContent").html('<div style=" text-align: center;"><p>Văn bản này<span id="mainContentPlaceHolder_lbms"> đang cập nhật nội dung </span>nên để xem được văn bản, bạn phải tải về.</p></div>');
            } else if (out.indexOf("có nội dung tương đối lớn") != -1) {
                $("#reviewContent").html('<div style=" text-align: center;"><p>Văn bản này<span id="mainContentPlaceHolder_lbms"> có nội dung tương đối lớn </span>nên để xem được văn bản, bạn phải tải về.</p></div>');
            } else if (out=="LoginError") {
                $("#reviewContent").html('<div style=" text-align: center;"><br/><b>Không thể login vào thuvienphapluat.vn, hãy kiểm tra kết nối mạng!</b></div>');
            }
            else {
                $("#reviewContent").html('<div style="margin:10px">'+out);
                $($("#reviewContent").children()[1]).remove();
            }
        });
    }

    function downloadFile(url) {
        notification("Hệ thống đang tải văn bản", 'Xin hãy đợi 1 lát ... <i class="icon-spinner icon-spin orange bigger-220"></i>', 5000000, "btn-purple center");

        $.post("/Proxy/DownloadFile", { url: url,caseCode:  $("#breadcrumbsCaseCode").text() }, function(out) {
            if ($('.gritter-item-wrapper').length > 0) {
                $('#gritter-notice-wrapper')[0].removeChild($(".gritter-item-wrapper")[$('.gritter-item-wrapper').length-1]);
            }
            if (out == "Exist") {
                notification("Đã tồn tại văn bản này trong hồ sơ", 'Xin hãy kiểm tra lại', 3000, "btn-danger center");
            } else if (out == "Maintain") {
                notification("thuvienphapluat.vn đang bảo trì", 'Xin hãy thử lại sau', 3000, "btn-danger center");
            } else if (out == "LoginError") {
                notification("không thể đăng nhập vào thuvienphapluat.vn", 'Xin hãy kiểm tra kết nối mạng hoặc tài khoản đã hết hạn', 3000, "btn-danger center");
            } else if(out.indexOf("success,")!=-1) {
                out = out.split("success,")[1];
                notification("Tải văn bản "+out+" thành công!", "Hãy kiểm tra trong hồ sơ", 5000, "btn-primary center");
            } else if (out == "Error") {
                notification("không thể đăng nhập vào thuvienphapluat.vn", 'Xin hãy kiểm tra kết nối mạng', 3000, "btn-danger center");
            } else if (out == "DoneCase") {
                notification("Không thể tải tài liệu vì hồ sơ đã thụ lý xong", 'Xin hãy chuyển hồ sơ khác hoặc liên hệ với quản lý', 3000, "btn-danger center");
            }else if (out == "PermissionError") {
                notification("Không thể tải tài liệu vì không có quyền", 'Hãy liên hệ với người tạo hoặc quản lý để cấp quyền', 3000, "btn-danger center");
            }
        });
    }

</script>
                            <!-- PAGE CONTENT ENDS -->
                        </div><!-- /.col -->
                    </div><!-- /.row -->
                </div><!-- /.page-content -->
            </div><!-- /.main-content -->

        </div><!-- /.main-container-inner -->

        <a href="#" id="btn-scroll-up" class="btn-scroll-up btn btn-sm btn-inverse">
            <i class="icon-double-angle-up icon-only bigger-110"></i>
        </a>
    </div><div class="daterangepicker dropdown-menu show-calendar opensright"><div class="calendar right"><div class="calendar-date"><table class="table-condensed"><thead><tr><th class="prev available"><i class="fa fa-arrow-left icon-arrow-left glyphicon glyphicon-arrow-left"></i></th><th colspan="5" class="month"><select class="monthselect"><option value="0">Jan</option><option value="1">Feb</option><option value="2">Mar</option><option value="3">Apr</option><option value="4">May</option><option value="5">Jun</option><option value="6">Jul</option><option value="7">Aug</option><option value="8" selected="selected">Sep</option><option value="9">Oct</option><option value="10">Nov</option><option value="11">Dec</option></select><select class="yearselect"><option value="1945">1945</option><option value="1946">1946</option><option value="1947">1947</option><option value="1948">1948</option><option value="1949">1949</option><option value="1950">1950</option><option value="1951">1951</option><option value="1952">1952</option><option value="1953">1953</option><option value="1954">1954</option><option value="1955">1955</option><option value="1956">1956</option><option value="1957">1957</option><option value="1958">1958</option><option value="1959">1959</option><option value="1960">1960</option><option value="1961">1961</option><option value="1962">1962</option><option value="1963">1963</option><option value="1964">1964</option><option value="1965">1965</option><option value="1966">1966</option><option value="1967">1967</option><option value="1968">1968</option><option value="1969">1969</option><option value="1970">1970</option><option value="1971">1971</option><option value="1972">1972</option><option value="1973">1973</option><option value="1974">1974</option><option value="1975">1975</option><option value="1976">1976</option><option value="1977">1977</option><option value="1978">1978</option><option value="1979">1979</option><option value="1980">1980</option><option value="1981">1981</option><option value="1982">1982</option><option value="1983">1983</option><option value="1984">1984</option><option value="1985">1985</option><option value="1986">1986</option><option value="1987">1987</option><option value="1988">1988</option><option value="1989">1989</option><option value="1990">1990</option><option value="1991">1991</option><option value="1992">1992</option><option value="1993">1993</option><option value="1994">1994</option><option value="1995">1995</option><option value="1996">1996</option><option value="1997">1997</option><option value="1998">1998</option><option value="1999">1999</option><option value="2000">2000</option><option value="2001">2001</option><option value="2002">2002</option><option value="2003">2003</option><option value="2004">2004</option><option value="2005">2005</option><option value="2006">2006</option><option value="2007">2007</option><option value="2008">2008</option><option value="2009">2009</option><option value="2010">2010</option><option value="2011">2011</option><option value="2012">2012</option><option value="2013">2013</option><option value="2014" selected="selected">2014</option></select></th><th class="next available"><i class="fa fa-arrow-right icon-arrow-right glyphicon glyphicon-arrow-right"></i></th></tr><tr><th>Su</th><th>Mo</th><th>Tu</th><th>We</th><th>Th</th><th>Fr</th><th>Sa</th></tr></thead><tbody><tr><td class="available off in-range" data-title="r0c0">31</td><td class="available in-range" data-title="r0c1">1</td><td class="available in-range" data-title="r0c2">2</td><td class="available in-range" data-title="r0c3">3</td><td class="available in-range" data-title="r0c4">4</td><td class="available in-range" data-title="r0c5">5</td><td class="available in-range" data-title="r0c6">6</td></tr><tr><td class="available in-range" data-title="r1c0">7</td><td class="available in-range" data-title="r1c1">8</td><td class="available in-range" data-title="r1c2">9</td><td class="available in-range" data-title="r1c3">10</td><td class="available in-range" data-title="r1c4">11</td><td class="available in-range" data-title="r1c5">12</td><td class="available in-range" data-title="r1c6">13</td></tr><tr><td class="available in-range" data-title="r2c0">14</td><td class="available in-range" data-title="r2c1">15</td><td class="available in-range" data-title="r2c2">16</td><td class="available in-range" data-title="r2c3">17</td><td class="available in-range" data-title="r2c4">18</td><td class="available active end-date" data-title="r2c5">19</td><td class="off disabled" data-title="r2c6">20</td></tr><tr><td class="off disabled" data-title="r3c0">21</td><td class="off disabled" data-title="r3c1">22</td><td class="off disabled" data-title="r3c2">23</td><td class="off disabled" data-title="r3c3">24</td><td class="off disabled" data-title="r3c4">25</td><td class="off disabled" data-title="r3c5">26</td><td class="off disabled" data-title="r3c6">27</td></tr><tr><td class="off disabled" data-title="r4c0">28</td><td class="off disabled" data-title="r4c1">29</td><td class="off disabled" data-title="r4c2">30</td><td class="off disabled" data-title="r4c3">1</td><td class="off disabled" data-title="r4c4">2</td><td class="off disabled" data-title="r4c5">3</td><td class="off disabled" data-title="r4c6">4</td></tr><tr><td class="off disabled" data-title="r5c0">5</td><td class="off disabled" data-title="r5c1">6</td><td class="off disabled" data-title="r5c2">7</td><td class="off disabled" data-title="r5c3">8</td><td class="off disabled" data-title="r5c4">9</td><td class="off disabled" data-title="r5c5">10</td><td class="off disabled" data-title="r5c6">11</td></tr></tbody></table></div></div><div class="calendar left"><div class="calendar-date"><table class="table-condensed"><thead><tr><th class="prev available"><i class="fa fa-arrow-left icon-arrow-left glyphicon glyphicon-arrow-left"></i></th><th colspan="5" class="month"><select class="monthselect"><option value="0" selected="selected">Jan</option><option value="1">Feb</option><option value="2">Mar</option><option value="3">Apr</option><option value="4">May</option><option value="5">Jun</option><option value="6">Jul</option><option value="7">Aug</option><option value="8">Sep</option><option value="9">Oct</option><option value="10">Nov</option><option value="11">Dec</option></select><select class="yearselect"><option value="1945" selected="selected">1945</option><option value="1946">1946</option><option value="1947">1947</option><option value="1948">1948</option><option value="1949">1949</option><option value="1950">1950</option><option value="1951">1951</option><option value="1952">1952</option><option value="1953">1953</option><option value="1954">1954</option><option value="1955">1955</option><option value="1956">1956</option><option value="1957">1957</option><option value="1958">1958</option><option value="1959">1959</option><option value="1960">1960</option><option value="1961">1961</option><option value="1962">1962</option><option value="1963">1963</option><option value="1964">1964</option><option value="1965">1965</option><option value="1966">1966</option><option value="1967">1967</option><option value="1968">1968</option><option value="1969">1969</option><option value="1970">1970</option><option value="1971">1971</option><option value="1972">1972</option><option value="1973">1973</option><option value="1974">1974</option><option value="1975">1975</option><option value="1976">1976</option><option value="1977">1977</option><option value="1978">1978</option><option value="1979">1979</option><option value="1980">1980</option><option value="1981">1981</option><option value="1982">1982</option><option value="1983">1983</option><option value="1984">1984</option><option value="1985">1985</option><option value="1986">1986</option><option value="1987">1987</option><option value="1988">1988</option><option value="1989">1989</option><option value="1990">1990</option><option value="1991">1991</option><option value="1992">1992</option><option value="1993">1993</option><option value="1994">1994</option><option value="1995">1995</option><option value="1996">1996</option><option value="1997">1997</option><option value="1998">1998</option><option value="1999">1999</option><option value="2000">2000</option><option value="2001">2001</option><option value="2002">2002</option><option value="2003">2003</option><option value="2004">2004</option><option value="2005">2005</option><option value="2006">2006</option><option value="2007">2007</option><option value="2008">2008</option><option value="2009">2009</option><option value="2010">2010</option><option value="2011">2011</option><option value="2012">2012</option><option value="2013">2013</option><option value="2014">2014</option></select></th><th class="next available"><i class="fa fa-arrow-right icon-arrow-right glyphicon glyphicon-arrow-right"></i></th></tr><tr><th>Su</th><th>Mo</th><th>Tu</th><th>We</th><th>Th</th><th>Fr</th><th>Sa</th></tr></thead><tbody><tr><td class="off disabled" data-title="r0c0">31</td><td class="available active start-date" data-title="r0c1">1</td><td class="available in-range" data-title="r0c2">2</td><td class="available in-range" data-title="r0c3">3</td><td class="available in-range" data-title="r0c4">4</td><td class="available in-range" data-title="r0c5">5</td><td class="available in-range" data-title="r0c6">6</td></tr><tr><td class="available in-range" data-title="r1c0">7</td><td class="available in-range" data-title="r1c1">8</td><td class="available in-range" data-title="r1c2">9</td><td class="available in-range" data-title="r1c3">10</td><td class="available in-range" data-title="r1c4">11</td><td class="available in-range" data-title="r1c5">12</td><td class="available in-range" data-title="r1c6">13</td></tr><tr><td class="available in-range" data-title="r2c0">14</td><td class="available in-range" data-title="r2c1">15</td><td class="available in-range" data-title="r2c2">16</td><td class="available in-range" data-title="r2c3">17</td><td class="available in-range" data-title="r2c4">18</td><td class="available in-range" data-title="r2c5">19</td><td class="available in-range" data-title="r2c6">20</td></tr><tr><td class="available in-range" data-title="r3c0">21</td><td class="available in-range" data-title="r3c1">22</td><td class="available in-range" data-title="r3c2">23</td><td class="available in-range" data-title="r3c3">24</td><td class="available in-range" data-title="r3c4">25</td><td class="available in-range" data-title="r3c5">26</td><td class="available in-range" data-title="r3c6">27</td></tr><tr><td class="available in-range" data-title="r4c0">28</td><td class="available in-range" data-title="r4c1">29</td><td class="available in-range" data-title="r4c2">30</td><td class="available in-range" data-title="r4c3">31</td><td class="available off in-range" data-title="r4c4">1</td><td class="available off in-range" data-title="r4c5">2</td><td class="available off in-range" data-title="r4c6">3</td></tr><tr><td class="available off in-range" data-title="r5c0">4</td><td class="available off in-range" data-title="r5c1">5</td><td class="available off in-range" data-title="r5c2">6</td><td class="available off in-range" data-title="r5c3">7</td><td class="available off in-range" data-title="r5c4">8</td><td class="available off in-range" data-title="r5c5">9</td><td class="available off in-range" data-title="r5c6">10</td></tr></tbody></table></div></div><div class="ranges"><div class="range_inputs"><div class="daterangepicker_start_input"><label for="daterangepicker_start">Từ</label><input class="input-mini" name="daterangepicker_start" value="01/01/1945" disabled="disabled" type="text"></div><div class="daterangepicker_end_input"><label for="daterangepicker_end">Đến</label><input class="input-mini" name="daterangepicker_end" value="19/09/2014" disabled="disabled" type="text"></div><button class="applyBtn btn btn-small btn-success">Chọn</button>&nbsp;<button class="cancelBtn btn btn-small btn-default">Đóng</button></div></div></div><!-- /.main-container -->
    
    


<textarea class="autosizejs" tabindex="-1" style="position: absolute; top: -999px; left: 0px; right: auto; bottom: auto; border: 0px none; padding: 0px; box-sizing: content-box; word-wrap: break-word; height: 0px ! important; min-height: 0px ! important; overflow: hidden; transition: none 0s ease 0s ; font-family: &quot;Helvetica Neue&quot;,&quot;Segoe UI&quot;,Helvetica,Arial,&quot;Lucida Grande&quot;,sans-serif; font-size: 14px; font-weight: 400; font-style: normal; letter-spacing: 0px; text-transform: none; word-spacing: 0px; text-indent: 0px; line-height: 20px; width: 336.983px;">
</textarea><div class="daterangepicker dropdown-menu show-calendar opensright"><div class="calendar right"><div class="calendar-date"><table class="table-condensed"><thead><tr><th></th><th colspan="5" class="month">Sep 2014</th><th class="next available"><i class="fa fa-arrow-right icon-arrow-right glyphicon glyphicon-arrow-right"></i></th></tr><tr><th>Su</th><th>Mo</th><th>Tu</th><th>We</th><th>Th</th><th>Fr</th><th>Sa</th></tr></thead><tbody><tr><td class="off disabled" data-title="r0c0">31</td><td class="off disabled" data-title="r0c1">1</td><td class="off disabled" data-title="r0c2">2</td><td class="off disabled" data-title="r0c3">3</td><td class="off disabled" data-title="r0c4">4</td><td class="off disabled" data-title="r0c5">5</td><td class="off disabled" data-title="r0c6">6</td></tr><tr><td class="off disabled" data-title="r1c0">7</td><td class="off disabled" data-title="r1c1">8</td><td class="off disabled" data-title="r1c2">9</td><td class="off disabled" data-title="r1c3">10</td><td class="off disabled" data-title="r1c4">11</td><td class="off disabled" data-title="r1c5">12</td><td class="off disabled" data-title="r1c6">13</td></tr><tr><td class="off disabled" data-title="r2c0">14</td><td class="off disabled" data-title="r2c1">15</td><td class="off disabled" data-title="r2c2">16</td><td class="off disabled" data-title="r2c3">17</td><td class="off disabled" data-title="r2c4">18</td><td class="available active start-date end-date" data-title="r2c5">19</td><td class="available" data-title="r2c6">20</td></tr><tr><td class="available" data-title="r3c0">21</td><td class="available" data-title="r3c1">22</td><td class="available" data-title="r3c2">23</td><td class="available" data-title="r3c3">24</td><td class="available" data-title="r3c4">25</td><td class="available" data-title="r3c5">26</td><td class="available" data-title="r3c6">27</td></tr><tr><td class="available" data-title="r4c0">28</td><td class="available" data-title="r4c1">29</td><td class="available" data-title="r4c2">30</td><td class="available off" data-title="r4c3">1</td><td class="available off" data-title="r4c4">2</td><td class="available off" data-title="r4c5">3</td><td class="available off" data-title="r4c6">4</td></tr><tr><td class="available off" data-title="r5c0">5</td><td class="available off" data-title="r5c1">6</td><td class="available off" data-title="r5c2">7</td><td class="available off" data-title="r5c3">8</td><td class="available off" data-title="r5c4">9</td><td class="available off" data-title="r5c5">10</td><td class="available off" data-title="r5c6">11</td></tr></tbody></table></div><div class="calendar-time"><select class="hourselect"><option value="0" selected="selected">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option></select> : <select class="minuteselect"><option value="0" selected="selected">00</option><option value="15">15</option><option value="30">30</option><option value="45">45</option></select> </div></div><div class="calendar left"><div class="calendar-date"><table class="table-condensed"><thead><tr><th class="prev available"><i class="fa fa-arrow-left icon-arrow-left glyphicon glyphicon-arrow-left"></i></th><th colspan="5" class="month">Sep 2014</th><th class="next available"><i class="fa fa-arrow-right icon-arrow-right glyphicon glyphicon-arrow-right"></i></th></tr><tr><th>Su</th><th>Mo</th><th>Tu</th><th>We</th><th>Th</th><th>Fr</th><th>Sa</th></tr></thead><tbody><tr><td class="available off" data-title="r0c0">31</td><td class="available" data-title="r0c1">1</td><td class="available" data-title="r0c2">2</td><td class="available" data-title="r0c3">3</td><td class="available" data-title="r0c4">4</td><td class="available" data-title="r0c5">5</td><td class="available" data-title="r0c6">6</td></tr><tr><td class="available" data-title="r1c0">7</td><td class="available" data-title="r1c1">8</td><td class="available" data-title="r1c2">9</td><td class="available" data-title="r1c3">10</td><td class="available" data-title="r1c4">11</td><td class="available" data-title="r1c5">12</td><td class="available" data-title="r1c6">13</td></tr><tr><td class="available" data-title="r2c0">14</td><td class="available" data-title="r2c1">15</td><td class="available" data-title="r2c2">16</td><td class="available" data-title="r2c3">17</td><td class="available" data-title="r2c4">18</td><td class="available active start-date end-date" data-title="r2c5">19</td><td class="available" data-title="r2c6">20</td></tr><tr><td class="available" data-title="r3c0">21</td><td class="available" data-title="r3c1">22</td><td class="available" data-title="r3c2">23</td><td class="available" data-title="r3c3">24</td><td class="available" data-title="r3c4">25</td><td class="available" data-title="r3c5">26</td><td class="available" data-title="r3c6">27</td></tr><tr><td class="available" data-title="r4c0">28</td><td class="available" data-title="r4c1">29</td><td class="available" data-title="r4c2">30</td><td class="available off" data-title="r4c3">1</td><td class="available off" data-title="r4c4">2</td><td class="available off" data-title="r4c5">3</td><td class="available off" data-title="r4c6">4</td></tr><tr><td class="available off" data-title="r5c0">5</td><td class="available off" data-title="r5c1">6</td><td class="available off" data-title="r5c2">7</td><td class="available off" data-title="r5c3">8</td><td class="available off" data-title="r5c4">9</td><td class="available off" data-title="r5c5">10</td><td class="available off" data-title="r5c6">11</td></tr></tbody></table></div><div class="calendar-time"><select class="hourselect"><option value="0" selected="selected">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option></select> : <select class="minuteselect"><option value="0" selected="selected">00</option><option value="15">15</option><option value="30">30</option><option value="45">45</option></select> </div></div><div class="ranges"><div class="range_inputs"><div class="daterangepicker_start_input"><label for="daterangepicker_start">Từ</label><input class="input-mini" name="daterangepicker_start" value="19/09/2014 00:00" disabled="disabled" type="text"></div><div class="daterangepicker_end_input"><label for="daterangepicker_end">Đến</label><input class="input-mini" name="daterangepicker_end" value="19/09/2014 00:00" disabled="disabled" type="text"></div><button class="applyBtn btn btn-small btn-success">Chọn</button>&nbsp;<button class="cancelBtn btn btn-small btn-default">Đóng</button></div></div></div></body></html>