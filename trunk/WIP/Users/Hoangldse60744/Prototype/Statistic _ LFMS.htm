<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Statistic | LFMS</title>
    <link href="http://localhost:19442/Content/logo/LFMS-icon-48.png" rel="icon">

    

    <!-- basic styles -->
    <link href="Statistic%20_%20LFMS_files/main.css" rel="stylesheet" type="text/css">
    <link href="Statistic%20_%20LFMS_files/bootstrap.css" rel="stylesheet" type="text/css">
    <link href="Statistic%20_%20LFMS_files/font-awesome.css" rel="stylesheet" type="text/css">

    <!-- ace styles -->
    <link href="Statistic%20_%20LFMS_files/ace.css" rel="stylesheet" type="text/css">
    <link href="Statistic%20_%20LFMS_files/ace-rtl.css" rel="stylesheet" type="text/css">
    <link href="Statistic%20_%20LFMS_files/ace-skins.css" rel="stylesheet" type="text/css">

    <!-- ace settings handler -->
    <script src="Statistic%20_%20LFMS_files/ace-extra.js" type="text/javascript"></script>

    <!-- basic scripts -->
    <!--[if !IE]> -->
    <script src="Statistic%20_%20LFMS_files/jquery-2.js" type="text/javascript"></script>
    <!-- <![endif]-->
    <script src="Statistic%20_%20LFMS_files/main.js" type="text/javascript"></script>

    <!--[if !IE]> -->
    <script type="text/javascript">
        window.jQuery || document.write("<script src='~/Content/js/jquery-2.0.3.min.js'>" + "<" + "/script>");
    </script>
    <!-- <![endif]-->

    <script type="text/javascript">
        if ("ontouchend" in document && document.ontouchend != null) document.write("<script src='~/Content/js/jquery.mobile.custom.min.js'>" + "<" + "/script>");
    </script>
    <script src="Statistic%20_%20LFMS_files/bootstrap.js" type="text/javascript"></script>

    <!-- ace scripts -->
    <script src="Statistic%20_%20LFMS_files/ace-elements.js" type="text/javascript"></script>
    <script src="Statistic%20_%20LFMS_files/ace.js" type="text/javascript"></script>
    <script src="Statistic%20_%20LFMS_files/md5.js" type="text/javascript"></script>


<style>.cke{visibility:hidden;}</style></head>

<body>
    <div class="navbar navbar-default" id="navbar">
        <script type="text/javascript">
            try { ace.settings.check('navbar', 'fixed') } catch (e) { }
        </script>

        <div class="navbar-container" id="navbar-container">
            <div class="navbar-header pull-left">
                <a href="http://localhost:19442/Home/Index" class="navbar-brand" title="Trang chủ">
                    <small>
                        <img src="Statistic%20_%20LFMS_files/LFMS-logo-big.png" style="border: none; height: 22px">
                    </small>
                </a><!-- /.brand -->
            </div><!-- /.navbar-header -->

            <div id="staffIdDiv" value="1" style="display:none"></div>

<div class="navbar-header pull-right" role="navigation">
    <ul class="nav ace-nav">
        <li class="green" id="notificationArea" style="display: block"><a data-toggle="dropdown" class="dropdown-toggle" href="#"><i class="icon-bell-alt icon-animated-bell" id="bellIcon"></i><span class="badge badge-important" id="countCalender1">1</span></a><ul class="pull-right dropdown-navbar dropdown-menu dropdown-caret dropdown-close"><li class="dropdown-header"><i class="icon-calendar"></i>Hôm nay có <span id="countCalender2">1</span> sự kiện</li><li><a><span class="label label-lg label-success" style="margin-right: 10px"><i class="icon-info-sign"></i></span><span class="msg-body"><span class="msg-title" style="font-weight: bold">Gặp anh Nam</span><span class="msg-time"><span> Từ ngày: 19/09/2014</span></span><span class="msg-time"><span> Đến ngày: 20/09/2014</span></span></span></a></li><li></li></ul></li>

        <li class="light-green">
            <a data-toggle="dropdown" href="#" class="dropdown-toggle">
                <img class="nav-user-photo" src="Statistic%20_%20LFMS_files/thuannh.jpg" alt="">
                <span class="user-info">
                    <small>Xin chào,</small>
                    <p>Nguyễn Hòa Thuận</p>
                </span>

                <i class="icon-caret-down"></i>
            </a>

            <ul class="user-menu pull-right dropdown-menu dropdown-yellow dropdown-caret dropdown-close">
                <li>
                    <a href="http://localhost:19442/Case/ListCase" onclick="">
                        <i class="icon-folder-open"></i>
                        Danh sách hồ sơ
                    </a>
                </li>

                <li class="divider"></li>

                    <li>
                        <a href="http://localhost:19442/Customer/Customer" onclick="">
                            <i class="icon-group"></i>
                            Quản lý khách hàng
                        </a>
                    </li>
                    <li class="divider"></li>
                    <li>
                        <a href="http://localhost:19442/Staff/Staff">
                            <i class="icon-user"></i>
                            Quản lý nhân viên
                        </a>
                    </li>
                    <li class="divider"></li>
                    <li>
                        <a href="http://localhost:19442/Service/Service" onclick="">
                            <i class="icon-cog"></i>
                            Quản lý dịch vụ
                        </a>
                    </li>
                    <li class="divider"></li>
                    <li>
                        <a href="http://localhost:19442/Office/Office">
                            <i class="icon-home"></i>
                            Quản lý văn phòng
                        </a>
                    </li>
                    <li class="divider"></li>
                    <li>
                        <a href="http://localhost:19442/Salary/Salary">
                            <i class=" icon-globe"></i>
                            Quản lí lương nhân viên
                        </a>
                    </li>
                    <li class="divider"></li>
                    <li>
                        <a href="http://localhost:19442/Statistic/Statistic">
                            <i class="icon-home"></i>
                            Thống kê
                        </a>
                    </li>
                     <li class="divider"></li>
                    <li>
                        <a href="http://localhost:19442/OtherCost/OtherCost">
                            <i class="icon-cog"></i>
                            Chi phí khác
                        </a>
                    </li>
                    <li class="divider"></li>

                <li>
                    <a data-toggle="modal" href="#tblPassChange" onclick='$("#PassChangeDiv").appendTo("#bodyChangePass"); validatePassword("#validatPassForm"); clearFieldPassword();'>
                        <i class="icon-key"></i>
                        Đổi mật khẩu
                    </a>
                </li>

                <li class="divider"></li>

                <li>
                    <a href="#" onclick="logOut()">
                        <i class="icon-off"></i>
                        Đăng xuất
                    </a>
                </li>
            </ul>
        </li>
    </ul><!-- /.ace-nav -->
</div><!-- /.navbar-header -->

<script>
    $(document).ready(function () {
        GetCalendarsByStaffId();
    });

    function GetCalendarsByStaffId() {
        $.post("/UserControl/GetCalendarsByStaffId", { staffId: $("#staffIdDiv").attr("value") }, function (out) {
            var item = '<a data-toggle="dropdown" class="dropdown-toggle" href="#"><i class="icon-bell-alt" id="bellIcon"></i><span class="badge badge-success" id="countCalender1"></span></a>';
            item += '<ul class="pull-right dropdown-navbar dropdown-menu dropdown-caret dropdown-close"><li class="dropdown-header"><i class="icon-calendar"></i>Hôm nay có <span id="countCalender2"></span> sự kiện</li>';
            var count = 0;

            $.each(out, function (index, ca) {
                var casecode = "";
                var priority;
                if (typeof (ca.Case) != "undefined") {
                    casecode = " (" + ca.Case.CaseCode + ")";
                    priority = "";
                } else priority = ca.Priority;
                count += 1;

                item += '<li><a>';
                item += '<span class="label label-lg ' + priority + '" style="margin-right: 10px"><i class="icon-info-sign"></i></span>';
                item += '<span class="msg-body">';
                item += '<span class="msg-title" style="font-weight: bold">' + ca.Title + casecode + '</span>';

                var date1 = convertNETDateTime(ca.BeginTime).toLocaleFormat('%d/%m/%Y');
                var time1 = convertNETDateTime(ca.BeginTime).toLocaleTimeString();
                var date2 = convertNETDateTime(ca.EndTime).toLocaleFormat('%d/%m/%Y');
                var time2 = convertNETDateTime(ca.EndTime).toLocaleTimeString();

                if (date1 == date2) {
                    if (time1 == "12:00:00 AM" && time2 == "12:00:00 AM") {
                        item += '<span class="msg-time"><span>Cả ngày</span></span>';
                    } else {
                        item += '<span class="msg-time"><span> Bắt đầu: ' + time1 + '</span></span>';
                        item += '<span class="msg-time"><span> Kết thúc: ' + time2 + '</span></span>';
                    }
                } else {
                    item += '<span class="msg-time"><span> Từ ngày: ' + date1 + '</span></span>';
                    item += '<span class="msg-time"><span> Đến ngày: ' + date2 + '</span></span>';
                }

                item += '</span>'; // span body
                item += '</a></li>';
            });

            item += '<li></li></ul>';
            $('#notificationArea').html(item);
            $('#countCalender1').text(count);
            $('#countCalender2').text(count);

            if (count != 0) {
                $('#countCalender1').attr('class', 'badge badge-important');
                $('#bellIcon').attr('class', 'icon-bell-alt icon-animated-bell');
            }
        });
    }

</script>

<div id="PassChangeDiv">
    <div id="tblPassChange" class="modal fade" tabindex="-1">
        <div class="modal-dialog" style="width: 100%; min-width: 600px; max-width: 600px">
            <div class="modal-content">
                <div class="modal-header no-padding">
                    <div class="table-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                            <span class="white">×</span>
                        </button>
                        Thay đổi mật khẩu
                    </div>
                </div>
                <form class="modal-body no-padding" id="validatPassForm">
                    <div class="modal-body no-padding">
                        <div class="col-xs-12 form-horizontal" style="padding-top: 20px; margin-left: 10px">
                            <div class="row">
                                <div class="form-group col-sm-12">
                                    <label class="col-sm-4 ">Mật khẩu cũ: <span style="color: red"> *</span></label>
                                    <div class="col-sm-8">
                                        
                                        <div>
                                            <input name="Oldpassword" id="Oldpassword" style="width:100%" type="password">
                                        </div>
                                        <div id="checkPass" style="display: none">
                                            <span style="color: #D16E6C">Mật khẩu cũ không đúng ! </span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="form-group col-sm-12">
                                    <label class="col-sm-4 ">Mật khẩu mới: <span style="color: red"> *</span></label>
                                    <div class="col-sm-8">
                                        <div>
                                            <input name="password" id="password" style="width:100%" type="password">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="form-group col-sm-12">
                                    <label class="col-sm-4 ">Lặp lại mật khẩu mới: <span style="color: red"> *</span></label>
                                    <div class="col-sm-8">
                                        <div>
                                            <input name="password2" id="password2" style="width:100%" type="password">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>

                <div class="modal-footer no-margin-top"></div>
                <div class="modal-footer no-margin-top">
                    <button class="btn btn-grey pull-left" type="button" data-dismiss="modal" id="btnCloseChange">
                        <i class="icon-remove"></i>
                        Đóng
                    </button>
                    <button class="btn btn-success" type="button" data-bb-handler="confirm" id="btnUpdatePass" onclick="updateStaffPass()">
                        <i class="icon-ok"></i>
                        Đổi mật khẩu
                    </button>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div>
</div>
<script type="text/javascript">
    function updateStaffPass() {
        if ($('#validatPassForm').valid()) {
            editFr = $('#tblPassChange');
            var oldPassword = $.md5($('#Oldpassword', editFr).val());
            var staffPassword = $.md5($('#password2', editFr).val());
            $.post("/UserControl/UpdateStaffPass", {
                oldPassword: oldPassword, staffPassword2: staffPassword
            }, function (result) {
                if (result == "successful") {
                    $('.close').click();
                    $('#checkPass').attr("style", "display: none");
                    notification("Cập nhật mật khẩu nhân viên thành công!", "", 3000, "btn-primary center");
                } else if (result == 'error') {
                    $('.close').click();
                    $('#checkPass').attr("style", "display: none");
                    notification("Cập nhật mật khẩu nhân viên nhân viên thất bại!", "Hãy kiểm tra lại kết nối database.", 5000, "gritter-error center");
                } else if (result == "notMatch") {
                    $('#checkPass').attr("style", "display: block");
                }
            })
                .error(function () {
                    $('.close').click();
                    $('#checkPass').attr("style", "display: none");
                    notification("Cập nhật mật khẩu nhân viên thất bại", "Hãy kiểm tra lại kết nối database.", 5000, "gritter-error center");
                });
        }
    }

    function validatePassword(validateform) {
        $(validateform).validate({
            errorElement: 'div',
            errorClass: 'help-block',
            focusInvalid: false,
            rules: {
                password: {
                    required: true,
                    alphanumeric: true,
                    minlength: 6


                },
                password2: {
                    required: true,
                    alphanumeric: true,
                    minlength: 6,
                    equalTo: "#password"
                },
                Oldpassword: {
                    required: true,
                    alphanumeric: true
                }
            },
            messages: {
                password: {
                    required: "Hãy nhập mật khẩu mới.",
                    alphanumeric: "Mật khẩu không được có kí tự đặc biệt",
                    minlength: "Mật khẩu mới phải có ít nhất 6 kí tự.",
                },
                password2: {
                    required: "Hãy nhập lại mật khẩu mới.",
                    alphanumeric: "Mật khẩu không được có kí tự đặc biệt",
                    minlength: "Mật khẩu mới phải có ít nhất 6 kí tự.",
                    equalTo: "Mật khẩu 2 không trùng khớp.",
                },
                Oldpassword: {
                    required: "Hãy nhập lại mật khẩu cũ.",
                    alphanumeric: "Mật khẩu không được có kí tự đặc biệt",
                }
            },
            highlight: function (e) {
                $(e).closest('.form-group').removeClass('has-info').addClass('has-error');
            },

            success: function (e) {
                $(e).closest('.form-group').removeClass('has-error').addClass('has-info');
                $(e).remove();
            },
            errorPlacement: function (error, element) {
                if (element.is(':checkbox') || element.is(':radio')) {
                    var controls = element.closest('div[class*="col-"]');
                    if (controls.find(':checkbox,:radio').length > 1) controls.append(error);
                    else error.insertAfter(element.nextAll('.lbl:eq(0)').eq(0));
                }
                else error.insertAfter(element.parent());
            }
        });
    }

    function clearFieldPassword() {
        editFr = $('#tblPassChange');
        $('#Oldpassword', editFr).val("");
        $('#password', editFr).val("");
        $('#password2', editFr).val("");

    }

    function logOut() {
        $.post("/Login/LogOut", {}, function (out) {
            if (out != "success") {
                alert(out);
            }
            window.location = ("/Login/Login");
        });
    }
</script>


        </div><!-- /.container -->
    </div>

    <div class="main-container" id="main-container">
        <script type="text/javascript">
            try { ace.settings.check('main-container', 'fixed') } catch (e) { }
        </script>

        <div class="main-container-inner">
            <a class="menu-toggler" id="menu-toggler" href="#">
                <span class="menu-text"></span>
            </a>


    <div class=" sidebar" id="sidebar">
        <script type="text/javascript">
            try { ace.settings.check('sidebar', 'fixed') } catch (e) { }
        </script>

        <ul class="nav nav-list">


            <li class="active" id="liRevenue" onclick="get12MonthRevenue(officeVal)">
                <a href="#" onclick="setLiActiveClass('#liRevenue')">
                    <i class="icon-bar-chart"></i>
                    <span class="menu-text"> Doanh thu</span>
                </a>
            </li>

            <li class="" id="liOffice" onclick="get12MonthCase(officeVal)">
                <a href="#" onclick="setLiActiveClass('#liOffice')">
                    <i class="icon-home"></i>
                    <span class="menu-text"> Văn phòng</span>
                </a>
            </li>

            <li class="" id="liStaff" onclick="get12MonthStaffRevenue(staffVal)">
                <a href="#" onclick="setLiActiveClass('#liStaff')">
                    <i class="icon-group"></i>
                    <span class="menu-text"> Nhân viên</span>
                </a>
            </li>
        </ul><!-- /.nav-list -->

        <div class="sidebar-collapse" id="sidebar-collapse">
            <i class="icon-double-angle-left" data-icon1="icon-double-angle-left" data-icon2="icon-double-angle-right"></i>
        </div>

        <script type="text/javascript">
            try { ace.settings.check('sidebar', 'collapsed') } catch (e) { }
        </script>
    </div>

            <div class="main-content">

    <div class="breadcrumbs" id="breadcrumbs">
        <script type="text/javascript">
            try { ace.settings.check('breadcrumbs', 'fixed') } catch (e) { }
        </script>

        <ul class="breadcrumb">
            <li>
                <i class="icon-home home-icon"></i>

                <a href="http://localhost:19442/Home/Index">Trang chủ</a> | Quản lý khách hàng
            </li>

            <li>
                <span id="breadcrumbsMenu" style="font-weight: bold"></span>
            </li>
        </ul><!-- .breadcrumb -->
    </div>

                <div class="page-content">
                    <div class="row">
                        <div class="col-xs-12">
                            <!-- PAGE CONTENT BEGINS -->
                            
<script src="Statistic%20_%20LFMS_files/Chart.js"></script>
<link rel="stylesheet" href="Statistic%20_%20LFMS_files/jquery.css">
<link rel="stylesheet" href="Statistic%20_%20LFMS_files/jquery-ui-1.css">

<link rel="stylesheet" href="Statistic%20_%20LFMS_files/chosen.css">
<link rel="stylesheet" href="Statistic%20_%20LFMS_files/bootstrap.css">
<link rel="stylesheet" href="Statistic%20_%20LFMS_files/font-awesome.css">
<link rel="stylesheet" href="Statistic%20_%20LFMS_files/ace.css">
<link rel="stylesheet" href="Statistic%20_%20LFMS_files/datepicker.css">
<link rel="stylesheet" href="Statistic%20_%20LFMS_files/screen.css">

<script src="Statistic%20_%20LFMS_files/ckeditor.js" type="text/javascript"></script>
<script src="Statistic%20_%20LFMS_files/ckfinder.js" type="text/javascript"></script>
<script src="Statistic%20_%20LFMS_files/jquery-ui-1.js" type="text/javascript"></script>
<script src="Statistic%20_%20LFMS_files/timeliner.js" type="text/javascript"></script>
<script src="Statistic%20_%20LFMS_files/bootbox.js" type="text/javascript"></script>
<script src="Statistic%20_%20LFMS_files/jquery_006.js" type="text/javascript"></script>
<script src="Statistic%20_%20LFMS_files/jquery.js" type="text/javascript"></script>



<script src="Statistic%20_%20LFMS_files/bootstrap-datepicker.js" type="text/javascript"></script>
<script src="Statistic%20_%20LFMS_files/jquery_004.js" type="text/javascript"></script>
<script src="Statistic%20_%20LFMS_files/jquery_005.js" type="text/javascript"></script>
<script src="Statistic%20_%20LFMS_files/jquery_002.js" type="text/javascript"></script>
<script src="Statistic%20_%20LFMS_files/typeahead-bs2.js" type="text/javascript"></script>
<script src="Statistic%20_%20LFMS_files/chosen.js" type="text/javascript"></script>
<script src="Statistic%20_%20LFMS_files/jquery_003.js"></script>
<script src="Statistic%20_%20LFMS_files/additional-methods.js"></script>


<div id="bodyContent"><div class="widget-box transparent">
    <div class="widget-header">
        <div class="widget-toolbar no-border">
            <ul class="nav nav-tabs">
                <li id="12monthLi" class="active">
                    <a onclick='showTabEvent("12month")' href="#" style="font-weight:bold">Trong 12 tháng</a>
                </li>
                <li id="lastyearLi" class="">
                    <a onclick='showTabEvent("lastyear")' href="#">Năm ngoái</a>
                </li>
                <li id="yearsLi" class="">
                    <a onclick='showTabEvent("years")' href="#">Các năm</a>
                </li>
            </ul>
        </div>
    </div>


    <div class="widget-body">
        <div class="space-6"></div>
        <div id="tab12MonthDiv">
            
            <div>
                <span style="font-weight:bold">Chọn văn phòng: </span>
                <select id="selectOffice" name="selectOffice" style="width: 30%; cursor: pointer; margin-left:15px"><option selected="selected" value="0">Tất cả văn phòng</option><option value="1">Luật Thuận Nguyễn Hồ Chí Minh</option><option value="2">Luật Thuận Nguyễn Vĩnh Long</option><option value="3">Thừa Phát Lại Vĩnh Long</option></select>
            </div>
            <div style="margin-left:13%; margin-top:5%">
                <canvas style="width: 800px; height: 400px;" id="12MonthRevenueChart" width="800" height="400"></canvas>
            </div>
            <div style="margin-left: 35%">
                <span class="smaller lighter green" style="font-weight: bold">Doanh thu trong 12 tháng gần nhất</span>
            </div>
            
            <div style="margin-top:10%">
                <div style="margin-left: -5%"><canvas style="width: 800px; height: 400px;" id="12MonthRevenuePieChart" width="800" height="400"></canvas></div>

                <div class="row" style="margin-left: 65%; margin-top: -22%; padding-bottom: 15%;">
                    <span style="background-color: #F38630; display: block; height: 15px; width: 15px; "></span><span>Luật Thuận Nguyễn Hồ Chí Minh</span>
                    <span style="background-color: #E0E4CC; display: block; height: 15px; width: 15px; "></span><span>Luật Thuận Nguyễn Vĩnh Long</span>
                    <span style="background-color: #69D2E7; display: block; height: 15px; width: 15px; "></span><span>Thừa Phát Lại Vĩnh Long</span>
                </div>
            </div>
            <div style="margin-left: 35%">
                <span class="smaller lighter green" style="font-weight: bold">Tỉ trọng doanh thu trong 12 tháng gần nhất</span>
            </div>
            
            <div style="margin-top:10%">
                <span style="font-weight:bold">So sánh: </span>
                <span style="font-weight: bold; color: rgba(220,220,220,1)">Văn phòng: </span>
                <select id="selectOfficeSS1" name="selectOfficeSS1" style="width: 30%; cursor: pointer; margin-left:15px"><option value="0">Tất cả văn phòng</option><option selected="selected" value="1">Luật Thuận Nguyễn Hồ Chí Minh</option><option value="2">Luật Thuận Nguyễn Vĩnh Long</option><option value="3">Thừa Phát Lại Vĩnh Long</option></select>
                <span style="font-weight: bold; color: rgba(151,187,205,1)">và văn phòng: </span>
                <select id="selectOfficeSS2" name="selectOfficeSS2" style="width: 30%; cursor: pointer; margin-left:15px"><option value="0">Tất cả văn phòng</option><option value="1">Luật Thuận Nguyễn Hồ Chí Minh</option><option selected="selected" value="2">Luật Thuận Nguyễn Vĩnh Long</option><option value="3">Thừa Phát Lại Vĩnh Long</option></select>
            </div>
            <div style="margin-left:13%; margin-top:5%">
                <canvas style="width: 800px; height: 400px;" id="12MonthRevenueSSChart" width="800" height="400"></canvas>
            </div>
            <div style="margin-left: 35%">
                <span class="smaller lighter green" style="font-weight: bold">So sánh doanh thu trong 12 tháng gần nhất</span>
            </div>
        </div>
        
        <div id="tabLastYearDiv" style="display: none">
            <div>
                <span style="font-weight:bold">Chọn văn phòng: </span>
                <select id="selectOffice2" name="selectOffice2" style="width: 30%; cursor: pointer; margin-left:15px"><option selected="selected" value="0">Tất cả văn phòng</option><option value="1">Luật Thuận Nguyễn Hồ Chí Minh</option><option value="2">Luật Thuận Nguyễn Vĩnh Long</option><option value="3">Thừa Phát Lại Vĩnh Long</option></select>
            </div>
            <div style="margin-left:13%; margin-top:5%">
                <canvas id="LastYearRevenueChart" width="800" height="400"></canvas>
            </div>
            <div style="margin-left: 35%">
                <span class="smaller lighter green" style="font-weight: bold">Doanh thu trong năm vừa qua</span>
            </div>
            
            <div style="margin-top:10%">
                <div style="margin-left: -5%"><canvas id="LastYearRevenuePieChart" width="800" height="400"></canvas></div>

                <div class="row" style="margin-left: 65%; margin-top: -22%; padding-bottom: 15%;">
                    <span style="background-color: #F38630; display: block; height: 15px; width: 15px; "></span><span>Luật Thuận Nguyễn Hồ Chí Minh</span>
                    <span style="background-color: #E0E4CC; display: block; height: 15px; width: 15px; "></span><span>Luật Thuận Nguyễn Vĩnh Long</span>
                    <span style="background-color: #69D2E7; display: block; height: 15px; width: 15px; "></span><span>Thừa Phát Lại Vĩnh Long</span>
                </div>
            </div>
            <div style="margin-left: 35%">
                <span class="smaller lighter green" style="font-weight: bold">Tỉ trọng doanh thu trong năm vừa qua</span>
            </div>
            
            <div style="margin-top:10%">
                <span style="font-weight:bold">So sánh: </span>
                <span style="font-weight: bold; color: rgba(220,220,220,1)">Văn phòng: </span>
                <select id="selectOfficeSS1LY" name="selectOfficeSS1" style="width: 30%; cursor: pointer; margin-left:15px"><option selected="selected" value="0">Tất cả văn phòng</option><option value="1">Luật Thuận Nguyễn Hồ Chí Minh</option><option value="2">Luật Thuận Nguyễn Vĩnh Long</option><option value="3">Thừa Phát Lại Vĩnh Long</option></select>
                <span style="font-weight: bold; color: rgba(151,187,205,1)">và văn phòng: </span>
                <select id="selectOfficeSS2LY" name="selectOfficeSS2" style="width: 30%; cursor: pointer; margin-left:15px"><option selected="selected" value="0">Tất cả văn phòng</option><option value="1">Luật Thuận Nguyễn Hồ Chí Minh</option><option value="2">Luật Thuận Nguyễn Vĩnh Long</option><option value="3">Thừa Phát Lại Vĩnh Long</option></select>
            </div>
            <div style="margin-left:13%; margin-top:5%">
                <canvas id="LastYearRevenueSSChart" width="800" height="400"></canvas>
            </div>
            <div style="margin-left: 35%">
                <span class="smaller lighter green" style="font-weight: bold">So sánh doanh thu năm vừa qua</span>
            </div>
        </div>
        
        <div id="tabYearsDiv" style="display: none">
            <div>
                <span style="font-weight:bold">Chọn văn phòng: </span>
                <select id="selectOffice3" name="selectOffice3" style="width: 30%; cursor: pointer; margin-left:15px"><option selected="selected" value="0">Tất cả văn phòng</option><option value="1">Luật Thuận Nguyễn Hồ Chí Minh</option><option value="2">Luật Thuận Nguyễn Vĩnh Long</option><option value="3">Thừa Phát Lại Vĩnh Long</option></select>
                <span style="font-weight:bold; margin-left:15px">Từ năm: </span>
                <select id="selectYear" name="selectYear" style="width: 10%; cursor: pointer; margin-left:15px"><option selected="selected" value="0">---</option><option value="2010">2010</option><option value="2011">2011</option><option value="2012">2012</option></select>
                <span id="toLbl" style="font-weight:bold; margin-left:15px; display:none">Đến năm: </span>
                <select id="selectYear2" name="selectYear2" style="width: 10%; cursor: pointer; margin-left:15px; display:none"></select>
            </div>
            <div style="margin-left:13%; margin-top:5%">
                <canvas id="YearsRevenueChart" width="800" height="400"></canvas>
            </div>
            <div style="margin-left: 35%">
                <span class="smaller lighter green" style="font-weight: bold">Doanh thu qua các năm</span>
            </div>
            
            <div style="margin-top:10%">
                <div style="margin-left: -5%"><canvas id="YearsRevenuePieChart" width="800" height="400"></canvas></div>

                <div class="row" style="margin-left: 65%; margin-top: -22%; padding-bottom: 15%;">
                    <span style="background-color: #F38630; display: block; height: 15px; width: 15px; "></span><span>Luật Thuận Nguyễn Hồ Chí Minh</span>
                    <span style="background-color: #E0E4CC; display: block; height: 15px; width: 15px; "></span><span>Luật Thuận Nguyễn Vĩnh Long</span>
                    <span style="background-color: #69D2E7; display: block; height: 15px; width: 15px; "></span><span>Thừa Phát Lại Vĩnh Long</span>
                </div>
            </div>
            <div style="margin-left: 35%">
                <span class="smaller lighter green" style="font-weight: bold">Tỉ trọng doanh thu qua các năm</span>
            </div>
            
            <div style="margin-top:10%">
                <span style="font-weight:bold">So sánh: </span>
                <span style="font-weight: bold; color: rgba(220,220,220,1)">Văn phòng: </span>
                <select id="selectOfficeSS1Y" name="selectOfficeSS1" style="width: 30%; cursor: pointer; margin-left:15px"><option selected="selected" value="0">Tất cả văn phòng</option><option value="1">Luật Thuận Nguyễn Hồ Chí Minh</option><option value="2">Luật Thuận Nguyễn Vĩnh Long</option><option value="3">Thừa Phát Lại Vĩnh Long</option></select>
                <span style="font-weight: bold; color: rgba(151,187,205,1)">và văn phòng: </span>
                <select id="selectOfficeSS2Y" name="selectOfficeSS2" style="width: 30%; cursor: pointer; margin-left:15px"><option selected="selected" value="0">Tất cả văn phòng</option><option value="1">Luật Thuận Nguyễn Hồ Chí Minh</option><option value="2">Luật Thuận Nguyễn Vĩnh Long</option><option value="3">Thừa Phát Lại Vĩnh Long</option></select>
            </div>
            <div style="margin-left:13%; margin-top:5%">
                <canvas id="YearsRevenueSSChart" width="800" height="400"></canvas>
            </div>
            <div style="margin-left: 35%">
                <span class="smaller lighter green" style="font-weight: bold">So sánh doanh thu qua các năm</span>
            </div>
        </div>
    </div>
</div></div>

<div id="bodyChangePass">

</div>

<script type="text/javascript">
    var officeVal = 0;
    var officeVal2 = 0;
    var officeVal3 = 0;
    var officeValSS1 = 0;
    var officeValSS2 = 0;
    var officeValSS1LY = 0;
    var officeValSS2LY = 0;
    var officeValSS1Y = 0;
    var officeValSS2Y = 0;
    var staffVal = 0;
    var staffVal2 = 0;
    var staffVal3 = 0;
    var staffValSS1 = 0;
    var staffValSS2 = 0;
    var staffValSS1LY = 0;
    var staffValSS2LY = 0;
    var staffValSS1Y = 0;
    var staffValSS2Y = 0;
   
    $(document).ready(function ready() {
        setLiActiveClass('#liRevenue');
        renderRevenueHTML();
        loadSelectOffice();
        loadFromYearRevenue();
        get12MonthRevenue('0');

        // bắt sự kiện onchange của combobox sau khi nó dc render
        $("#selectOffice").change(function () {
            var officeId = $('#selectOffice').val();
            officeVal = officeId;
            get12MonthRevenue(officeId);
        });
        $("#selectOffice2").change(function () {
            var officeId = $('#selectOffice2').val();
            officeVal2 = officeId;
            getLastYearRevenue(officeId);
        });
        $("#selectOffice3").change(function () {
            var officeId = $('#selectOffice3').val();
            var from = $('#selectYear').val();
            var to = $('#selectYear2').val();
            officeVal3 = officeId;
            getYearsRevenue(officeId, from, to);
            getYearsRevenuePieChart(officeId, from, to);
            getYearsCase(officeId, from, to);
            getYearsCasePieChart(officeId, from, to);
        });

        $("#selectOfficeSS1").change(function () {
            var officeId1 = $('#selectOfficeSS1').val();
            officeValSS1 = officeId1;
            var officeId2 = $('#selectOfficeSS2').val();
            officeValSS2 = officeId2;
            get12MonthRevenueSS(officeId1, officeId2);
            get12MonthCaseSS(officeId1, officeId2);
        });
        $("#selectOfficeSS2").change(function () {
            var officeId1 = $('#selectOfficeSS1').val();
            officeValSS1 = officeId1;
            var officeId2 = $('#selectOfficeSS2').val();
            officeValSS2 = officeId2;
            get12MonthRevenueSS(officeId1, officeId2);
            get12MonthCaseSS(officeId1, officeId2);
        });
        $("#selectOfficeSS1LY").change(function () {
            var officeId1 = $('#selectOfficeSS1LY').val();
            officeValSS1LY = officeId1;
            var officeId2 = $('#selectOfficeSS2LY').val();
            officeValSS2LY = officeId2;
            getLastYearRevenueSS(officeId1, officeId2);
        });
        $("#selectOfficeSS2LY").change(function () {
            var officeId1 = $('#selectOfficeSS1LY').val();
            officeValSS1LY = officeId1;
            var officeId2 = $('#selectOfficeSS2LY').val();
            officeValSS2LY = officeId2;
            getLastYearRevenueSS(officeId1, officeId2);
        });
        $("#selectOfficeSS1Y").change(function () {
            var officeId1 = $('#selectOfficeSS1Y').val();
            officeValSS1Y = officeId1;
            var officeId2 = $('#selectOfficeSS2Y').val();
            officeValSS2Y = officeId2;
            var from = $('#selectYear').val();
            var to = $('#selectYear2').val();
            getYearsRevenueSS(officeId1, officeId2, from, to);
        });
        $("#selectOfficeSS2Y").change(function () {
            var officeId1 = $('#selectOfficeSS1Y').val();
            officeValSS1Y = officeId1;
            var officeId2 = $('#selectOfficeSS2Y').val();
            officeValSS2Y = officeId2;
            var from = $('#selectYear').val();
            var to = $('#selectYear2').val();
            getYearsRevenueSS(officeId1, officeId2, from, to);
        });

        $("#selectYear").change(function () {
            var officeId = $('#selectOffice3').val();
            var from = $('#selectYear').val();
            officeVal3 = officeId;
            $('#toLbl').show();
            $('#selectYear2').show();
            loadToYearRevenue(from);
        });
        $("#selectYear2").change(function () {
            var officeId = $('#selectOffice3').val();
            var from = $('#selectYear').val();
            var to = $('#selectYear2').val();
            officeVal3 = officeId;
            getYearsRevenue(officeId, from, to);
            getYearsRevenuePieChart(officeId, from, to);
            getYearsCase(officeId, from, to);
            getYearsCasePieChart(officeId, from, to);
        });

        $("#selectStaff").change(function () {
            var staffId = $('#selectStaff').val();
            staffVal = staffId;
            get12MonthStaffRevenue(staffId);
        });
        $("#selectStaff2").change(function () {
            var staffId = $('#selectStaff2').val();
            staffVal2 = staffId;
            getLastYearStaffRevenue(staffId);
        });
        $("#selectStaff3").change(function () {
            var staffId = $('#selectStaff3').val();
            var from = $('#selectYearStaff').val();
            var to = $('#selectYear2Staff').val();
            staffVal3 = staffId;
            getYearsStaffRevenue(staffId, from, to);
        });
        $("#selectYearStaff").change(function () {
            var staffId = $('#selectStaff3').val();
            var from = $('#selectYearStaff').val();
            staffVal3 = staffId;
            $('#toLbl').show();
            $('#selectYear2Staff').show();
            loadToYearRevenue(from);
        });
        $("#selectYear2Staff").change(function () {
            var staffId = $('#selectStaff3').val();
            var from = $('#selectYearStaff').val();
            var to = $('#selectYear2Staff').val();
            staffVal3 = staffId;
            getYearsStaffRevenue(staffId, from, to);
        });

        $("#selectStaff").chosen();
        $("#selectStaff_chosen").css("width", "30%");
    });

    function setLiActiveClass(liId) {
        $('#liRevenue').attr("class", "");
        $('#liOffice').attr("class", "");
        $('#liStaff').attr("class", "");
        $(liId).attr("class", "active");
    }

    function showTabEvent(id) {
        if (id == "12month") {
            $("#12monthLi").find("a").css("font-weight", "bold");
            $("#lastyearLi").find("a").css("font-weight", "");
            $("#yearsLi").find("a").css("font-weight", "");
            $("#12monthLi").attr("class", "active");
            $("#lastyearLi").attr("class", "");
            $("#yearsLi").attr("class", "");
            $("#tab12MonthDiv").show();
            $("#tabLastYearDiv").hide();
            $("#tabYearsDiv").hide();
        } else if (id == "lastyear") {
            $("#12monthLi").find("a").css("font-weight", "");
            $("#lastyearLi").find("a").css("font-weight", "bold");
            $("#yearsLi").find("a").css("font-weight", "");
            $("#12monthLi").attr("class", "");
            $("#lastyearLi").attr("class", "active");
            $("#yearsLi").attr("class", "");
            $("#tab12MonthDiv").hide();
            $("#tabLastYearDiv").show();
            $("#tabYearsDiv").hide();
            getLastYearRevenue(officeVal2);
            getLastYearRevenuePieChart();
            getLastYearCase(officeVal2);
            getLastYearCasePieChart();
            getLastYearStaffRevenue(staffVal2);
        } else if (id == "years") {
            $("#12monthLi").find("a").css("font-weight", "");
            $("#lastyearLi").find("a").css("font-weight", "");
            $("#yearsLi").find("a").css("font-weight", "bold");
            $("#12monthLi").attr("class", "");
            $("#lastyearLi").attr("class", "");
            $("#yearsLi").attr("class", "active");
            $("#tab12MonthDiv").hide();
            $("#tabLastYearDiv").hide();
            $("#tabYearsDiv").show();
        }
    }

    function renderRevenueHTML() {
        $.ajax({
            url: "/Statistic/RenderRevenueHTML",
            type: 'GET',
            async: false,
            success: function (data) {
                document.getElementById("bodyContent").innerHTML = (data.html);//render HTML cua partial view
                get12MonthRevenuePieChart();
                get12MonthRevenueSS(officeId1, officeId2)
            },
            error: function (errMsg) {
                alert(errMsg.responseText);
            }
        });
    }

    function loadSelectOffice() {
        $.ajax({
            url: "/Office/GetAllOfficeJson",
            type: 'GET',
            async: false,
            success: function (data) {
                if (data != null) {
                    var item = '<option value="0">Tất cả văn phòng</option>';
                    $.each(data, function (index, office) {
                        item += '<option value="' + office.OfficeId + '">' + office.OfficeName + '</option>';
                    });
                    $('#selectOffice').html(item);
                    $('#selectOffice').val(officeVal);
                    $('#selectOffice2').html(item);
                    $('#selectOffice2').val(officeVal2);
                    $('#selectOffice3').html(item);
                    $('#selectOffice3').val(officeVal3);
                    $('#selectOfficeSS1').html(item);
                    $('#selectOfficeSS1').val(officeValSS1);
                    $('#selectOfficeSS2').html(item);
                    $('#selectOfficeSS2').val(officeValSS2);
                    $('#selectOfficeSS1LY').html(item);
                    $('#selectOfficeSS1LY').val(officeValSS1LY);
                    $('#selectOfficeSS2LY').html(item);
                    $('#selectOfficeSS2LY').val(officeValSS2LY);
                    $('#selectOfficeSS1Y').html(item);
                    $('#selectOfficeSS1Y').val(officeValSS1Y);
                    $('#selectOfficeSS2Y').html(item);
                    $('#selectOfficeSS2Y').val(officeValSS2Y);
                }
            },
            error: function (errMsg) {
                alert(errMsg.responseText);
            }
        });
    }

    //===================================================================================================================================
    function loadFromYearRevenue() {
        $.ajax({
            url: "/Statistic/GetFromYearRevenue",
            type: 'GET',
            async: false,
            success: function (data) {
                if (data.year != null) {
                    var item = '<option value="0">---</option>';
                    var keys = Object.keys(data.year);
                    for (var key in data.year) {
                        item += '<option value="' + data.year[key] + '">' + data.year[key] + '</option>';
                    }
                    $('#selectYear').html(item);
                    //$('#selectYear').val(officeVal);
                }
            },
            error: function (errMsg) {
                alert(errMsg.responseText);
            }
        });
    }

    function loadToYearRevenue(year) {
        $.ajax({
            url: "/Statistic/GetToYearRevenue",
            type: 'GET',
            async: false,
            data: { year: year },
            success: function (data) {
                if (data.year != null) {
                    var item = '<option value="0">---</option>';
                    var keys = Object.keys(data.year);
                    for (var key in data.year) {
                        item += '<option value="' + data.year[key] + '">' + data.year[key] + '</option>';
                    }
                    $('#selectYear2').html(item);
                    //$('#selectYear').val(officeVal);
                }
            },
            error: function (errMsg) {
                alert(errMsg.responseText);
            }
        });
    }
    //--------------------------------------------------------------------------------
    function get12MonthRevenue(officeId) {
        $.ajax({
            url: "/Statistic/Get12MonthRevenue",
            type: 'GET',
            async: false,
            data: { officeId: officeId },
            success: function (out) {
                renderRevenueHTML();
                loadSelectOffice();
                loadFromYearRevenue();
                // bắt sự kiện onchange của combobox sau khi nó dc render
                $("#selectOffice").change(function () {
                    var officeId = $('#selectOffice').val();
                    //alert(officeId);
                    officeVal = officeId;
                    get12MonthRevenue(officeId);
                });
                $("#selectOffice2").change(function () {
                    var officeId = $('#selectOffice2').val();
                    //alert(officeId);
                    officeVal2 = officeId;
                    getLastYearRevenue(officeId);
                });
                $("#selectOffice3").change(function () {
                    var officeId = $('#selectOffice3').val();
                    var from = $('#selectYear').val();
                    var to = $('#selectYear2').val();
                    officeVal3 = officeId;
                    getYearsRevenue(officeId, from, to);
                });
                
                $("#selectOfficeSS1").change(function () {
                    var officeId1 = $('#selectOfficeSS1').val();
                    officeValSS1 = officeId1;
                    var officeId2 = $('#selectOfficeSS2').val();
                    officeValSS2 = officeId2;
                    get12MonthRevenueSS(officeId1, officeId2);
                });
                $("#selectOfficeSS2").change(function () {
                    var officeId1 = $('#selectOfficeSS1').val();
                    officeValSS1 = officeId1;
                    var officeId2 = $('#selectOfficeSS2').val();
                    officeValSS2 = officeId2;
                    get12MonthRevenueSS(officeId1, officeId2);
                });
                $("#selectOfficeSS1LY").change(function () {
                    var officeId1 = $('#selectOfficeSS1LY').val();
                    officeValSS1LY = officeId1;
                    var officeId2 = $('#selectOfficeSS2LY').val();
                    officeValSS2LY = officeId2;
                    getLastYearRevenueSS(officeId1, officeId2);
                });
                $("#selectOfficeSS2LY").change(function () {
                    var officeId1 = $('#selectOfficeSS1LY').val();
                    officeValSS1LY = officeId1;
                    var officeId2 = $('#selectOfficeSS2LY').val();
                    officeValSS2LY = officeId2;
                    getLastYearRevenueSS(officeId1, officeId2);
                });
                $("#selectOfficeSS1Y").change(function () {
                    var officeId1 = $('#selectOfficeSS1Y').val();
                    officeValSS1Y = officeId1;
                    var officeId2 = $('#selectOfficeSS2Y').val();
                    officeValSS2Y = officeId2;
                    var from = $('#selectYear').val();
                    var to = $('#selectYear2').val();
                    getYearsRevenueSS(officeId1, officeId2, from, to);
                });
                $("#selectOfficeSS2Y").change(function () {
                    var officeId1 = $('#selectOfficeSS1Y').val();
                    officeValSS1Y = officeId1;
                    var officeId2 = $('#selectOfficeSS2Y').val();
                    officeValSS2Y = officeId2;
                    var from = $('#selectYear').val();
                    var to = $('#selectYear2').val();
                    getYearsRevenueSS(officeId1, officeId2, from, to);
                });

                $("#selectYear").change(function () {
                    var officeId = $('#selectOffice3').val();
                    var from = $('#selectYear').val();
                    officeVal3 = officeId;
                    $('#toLbl').show();
                    $('#selectYear2').show();
                    loadToYearRevenue(from);
                });
                $("#selectYear2").change(function () {
                    var officeId = $('#selectOffice3').val();
                    var from = $('#selectYear').val();
                    var to = $('#selectYear2').val();
                    officeVal3 = officeId;
                    getYearsRevenue(officeId, from, to);
                    getYearsRevenuePieChart(officeId, from, to);
                });

                //Get context with jQuery - using jQuery's .get() method.
                var ctx = $("#12MonthRevenueChart").get(0).getContext("2d");
                //This will get the first returned node in the jQuery collection.
                var myNewChart = new Chart(ctx);

                var data = {
                    labels: ["12 Tháng Trước", "11 Tháng Trước", "10 Tháng Trước", "9 Tháng Trước", "8 Tháng Trước", "7 Tháng Trước", "6 Tháng Trước", "5 Tháng Trước", "4 Tháng Trước", "3 Tháng Trước", "2 Tháng Trước", "Tháng Trước"],
                    datasets: [
                        {
                            fillColor: "rgba(151,187,205,0.5)",
                            strokeColor: "rgba(151,187,205,1)",
                            data: [out.chartData.feild12, out.chartData.feild11, out.chartData.feild10, out.chartData.feild9, out.chartData.feild8, out.chartData.feild7, out.chartData.feild6, out.chartData.feild5, out.chartData.feild4, out.chartData.feild3, out.chartData.feild2, out.chartData.feild1]
                        }
                    ]
                }
                new Chart(ctx).Bar(data);
                
            },
            error: function (errMsg) {
                alert(errMsg.responseText);
            }
        });
    }

    function get12MonthRevenuePieChart() {
        $.ajax({
            url: '/Statistic/Get12MonthRevenuePieChart',
            method: 'GET',
            async: false,
            data: {},
            success: function (out) {
                {
                    //Get context with jQuery - using jQuery's .get() method.
                    var ctx = $("#12MonthRevenuePieChart").get(0).getContext("2d");
                    //This will get the first returned node in the jQuery collection.
                    var myNewChart = new Chart(ctx);

                    var data = [
	                            {
	                                value: out.chartData[1],
	                                color: "#F38630",
	                            },
	                            {
	                                value: out.chartData[2],
	                                color: "#E0E4CC",
	                            },
	                            {
	                                value: out.chartData[3],
	                                color: "#69D2E7",
	                            }
                    ]
                    new Chart(ctx).Pie(data);
                };
            }
        });
    }

    function get12MonthRevenueSS(officeId1, officeId2) {
        $.ajax({
            url: '/Statistic/Get12MonthRevenueSS',
            method: 'GET',
            async: false,
            data: { officeId1: officeId1, officeId2: officeId2 },
            success: function (out) {
                {
                    //Get context with jQuery - using jQuery's .get() method.
                    var ctx = $("#12MonthRevenueSSChart").get(0).getContext("2d");
                    //This will get the first returned node in the jQuery collection.
                    var myNewChart = new Chart(ctx);

                    var data = {
                        labels: ["12 Tháng Trước", "11 Tháng Trước", "10 Tháng Trước", "9 Tháng Trước", "8 Tháng Trước", "7 Tháng Trước", "6 Tháng Trước", "5 Tháng Trước", "4 Tháng Trước", "3 Tháng Trước", "2 Tháng Trước", "Tháng Trước"],
                        datasets: [
                            {
                                fillColor: "rgba(220,220,220,0.5)",
                                strokeColor: "rgba(220,220,220,1)",
                                pointColor: "rgba(220,220,220,1)",
                                pointStrokeColor: "#fff",
                                data: [out.chartData1.feild1, out.chartData1.feild2, out.chartData1.feild3, out.chartData1.feild4, out.chartData1.feild5, out.chartData1.feild6, out.chartData1.feild7, out.chartData1.feild8, out.chartData1.feild9, out.chartData1.feild10, out.chartData1.feild11, out.chartData1.feild12]
                            },
                            {
                                fillColor: "rgba(151,187,205,0.5)",
                                strokeColor: "rgba(151,187,205,1)",
                                pointColor: "rgba(151,187,205,1)",
                                pointStrokeColor: "#fff",
                                data: [out.chartData2.feild1, out.chartData2.feild2, out.chartData2.feild3, out.chartData2.feild4, out.chartData2.feild5, out.chartData2.feild6, out.chartData2.feild7, out.chartData2.feild8, out.chartData2.feild9, out.chartData2.feild10, out.chartData2.feild11, out.chartData2.feild12]
                            }
                        ]
                    }
                    new Chart(ctx).Line(data);
                };
            }
        });
    }
    //--------------------------------------------------------------------------------
    function getLastYearRevenue(officeId) {
        $.ajax({
            url: '/Statistic/GetLastYearRevenue',
            method: 'GET',
            async: false,
            data: { officeId: officeId },
            success: function (out) {
                {
                    //Get context with jQuery - using jQuery's .get() method.
                    var ctx = $("#LastYearRevenueChart").get(0).getContext("2d");
                    //This will get the first returned node in the jQuery collection.
                    var myNewChart = new Chart(ctx);

                    var data = {
                        labels: ["Tháng 1", "Tháng 2", "Tháng 3", "Tháng 4", "Tháng 5", "Tháng 6", "Tháng 7", "Tháng 8", "Tháng 9", "Tháng 10", "Tháng 11", "Tháng 12"],
                        datasets: [
                            {
                                fillColor: "rgba(151,187,205,0.5)",
                                strokeColor: "rgba(151,187,205,1)",
                                data: [out.chartData.feild1, out.chartData.feild2, out.chartData.feild3, out.chartData.feild4, out.chartData.feild5, out.chartData.feild6, out.chartData.feild7, out.chartData.feild8, out.chartData.feild9, out.chartData.feild12, out.chartData.feild11, out.chartData.feild12]
                            }
                        ]
                    }
                    new Chart(ctx).Bar(data);
                };
            }
        });
    }

    function getLastYearRevenuePieChart() {
        $.ajax({
            url: '/Statistic/GetLastYearRevenuePieChart',
            method: 'GET',
            async: false,
            data: {},
            success: function (out) {
                {
                    //Get context with jQuery - using jQuery's .get() method.
                    var ctx = $("#LastYearRevenuePieChart").get(0).getContext("2d");
                    //This will get the first returned node in the jQuery collection.
                    var myNewChart = new Chart(ctx);

                    var data = [
	                            {
	                                value: out.chartData[1],
	                                color: "#F38630",
	                            },
	                            {
	                                value: out.chartData[2],
	                                color: "#E0E4CC",
	                            },
	                            {
	                                value: out.chartData[3],
	                                color: "#69D2E7",
	                            }
                    ]
                    new Chart(ctx).Pie(data);
                };
            }
        });
    }

    function getLastYearRevenueSS(officeId1, officeId2) {
        $.ajax({
            url: '/Statistic/GetLastYearRevenueSS',
            method: 'GET',
            async: false,
            data: { officeId1: officeId1, officeId2: officeId2 },
            success: function (out) {
                {
                    //Get context with jQuery - using jQuery's .get() method.
                    var ctx = $("#LastYearRevenueSSChart").get(0).getContext("2d");
                    //This will get the first returned node in the jQuery collection.
                    var myNewChart = new Chart(ctx);

                    var data = {
                        labels: ["12 Tháng Trước", "11 Tháng Trước", "10 Tháng Trước", "9 Tháng Trước", "8 Tháng Trước", "7 Tháng Trước", "6 Tháng Trước", "5 Tháng Trước", "4 Tháng Trước", "3 Tháng Trước", "2 Tháng Trước", "Tháng Trước"],
                        datasets: [
                            {
                                fillColor: "rgba(220,220,220,0.5)",
                                strokeColor: "rgba(220,220,220,1)",
                                pointColor: "rgba(220,220,220,1)",
                                pointStrokeColor: "#fff",
                                data: [out.chartData1.feild1, out.chartData1.feild2, out.chartData1.feild3, out.chartData1.feild4, out.chartData1.feild5, out.chartData1.feild6, out.chartData1.feild7, out.chartData1.feild8, out.chartData1.feild9, out.chartData1.feild10, out.chartData1.feild11, out.chartData1.feild12]
                            },
                            {
                                fillColor: "rgba(151,187,205,0.5)",
                                strokeColor: "rgba(151,187,205,1)",
                                pointColor: "rgba(151,187,205,1)",
                                pointStrokeColor: "#fff",
                                data: [out.chartData2.feild1, out.chartData2.feild2, out.chartData2.feild3, out.chartData2.feild4, out.chartData2.feild5, out.chartData2.feild6, out.chartData2.feild7, out.chartData2.feild8, out.chartData2.feild9, out.chartData2.feild10, out.chartData2.feild11, out.chartData2.feild12]
                            }
                        ]
                    }
                    new Chart(ctx).Line(data);
                };
            }
        });
    }
    //--------------------------------------------------------------------------------
    function getYearsRevenue(officeId, from, to) {
        $.ajax({
            url: '/Statistic/GetYearsRevenue',
            method: 'GET',
            async: false,
            data: { from: from, officeId: officeId, to: to },
            success: function (out) {
                var keys = Object.keys(out);
                var vals = [];
                for (var key in out) {
                    val = out[key];
                    vals.push(val);
                }
                //Get context with jQuery - using jQuery's .get() method.
                var ctx = $("#YearsRevenueChart").get(0).getContext("2d");
                //This will get the first returned node in the jQuery collection.
                var myNewChart = new Chart(ctx);

                var data = {
                    labels: keys,
                    datasets: [
                        {
                            fillColor: "rgba(151,187,205,0.5)",
                            strokeColor: "rgba(151,187,205,1)",
                            data: vals
                        }
                    ]
                }
                new Chart(ctx).Bar(data);
            }
        });
    }

    function getYearsRevenuePieChart(officeId, from, to) {
        $.ajax({
            url: '/Statistic/GetYearsRevenuePieChart',
            method: 'GET',
            async: false,
            data: { from: from, officeId: officeId, to: to },
            success: function (out) {
                {
                    //Get context with jQuery - using jQuery's .get() method.
                    var ctx = $("#YearsRevenuePieChart").get(0).getContext("2d");
                    //This will get the first returned node in the jQuery collection.
                    var myNewChart = new Chart(ctx);

                    var data = [
	                            {
	                                value: out.chartData[1],
	                                color: "#F38630",
	                            },
	                            {
	                                value: out.chartData[2],
	                                color: "#E0E4CC",
	                            },
	                            {
	                                value: out.chartData[3],
	                                color: "#69D2E7",
	                            }
                    ]
                    new Chart(ctx).Pie(data);
                };
            }
        });
    }
    function getYearsRevenueSS(officeId1, officeId2, from, to) {
        $.ajax({
            url: '/Statistic/GetYearsRevenueSS',
            method: 'GET',
            async: false,
            data: { officeId1: officeId1, officeId2: officeId2 , from: from, to: to},
            success: function (out) {
                {
                    var keys = Object.keys(out.chartData1);
                    var vals1 = [];
                    var vals2 = [];
                    for (var key in out.chartData1) {
                        val = out.chartData1[key];
                        vals1.push(val);
                    }
                    for (var key in out.chartData2) {
                        val = out.chartData2[key];
                        vals2.push(val);
                    }
                    //Get context with jQuery - using jQuery's .get() method.
                    var ctx = $("#YearsRevenueSSChart").get(0).getContext("2d");
                    //This will get the first returned node in the jQuery collection.
                    var myNewChart = new Chart(ctx);

                    var data = {
                        labels: keys,
                        datasets: [
                            {
                                fillColor: "rgba(220,220,220,0.5)",
                                strokeColor: "rgba(220,220,220,1)",
                                pointColor: "rgba(220,220,220,1)",
                                pointStrokeColor: "#fff",
                                data: vals1
                            },
                            {
                                fillColor: "rgba(151,187,205,0.5)",
                                strokeColor: "rgba(151,187,205,1)",
                                pointColor: "rgba(151,187,205,1)",
                                pointStrokeColor: "#fff",
                                data: vals2
                            }
                        ]
                    }
                    new Chart(ctx).Line(data);
                };
            }
        });
    }

    //=====================================================================================================================================
    function renderOfficeHTML() {
        $.ajax({
            url: "/Statistic/RenderOfficeHTML",
            type: 'GET',
            async: false,
            success: function (data) {
                document.getElementById("bodyContent").innerHTML = (data.html);//render HTML cua partial view
            },
            error: function (errMsg) {
                alert(errMsg.responseText);
            }
        });
    }
    function get12MonthCase(officeId) {
        $.ajax({
            url: "/Statistic/Get12MonthCase",
            type: 'GET',
            async: false,
            data: { officeId: officeId },
            success: function (out) {
                renderOfficeHTML();
                loadSelectOffice();
                loadFromYearCase();
                get12MonthCasePieChart();
                // bắt sự kiện onchange của combobox sau khi nó dc render
                $("#selectOffice").change(function () {
                    var officeId = $('#selectOffice').val();
                    //alert(officeId);
                    officeVal = officeId;
                    get12MonthCase(officeId);
                });
                $("#selectOffice2").change(function () {
                    var officeId = $('#selectOffice2').val();
                    //alert(officeId);
                    officeVal2 = officeId;
                    getLastYearCase(officeId);
                });
                $("#selectOffice3").change(function () {
                    var officeId = $('#selectOffice3').val();
                    var from = $('#selectYear').val();
                    var to = $('#selectYear2').val();
                    officeVal3 = officeId;
                    getYearsCase(officeId, from, to);
                    getYearsCasePieChart(officeId, from, to);
                });
                $("#selectYear").change(function () {
                    var officeId = $('#selectOffice3').val();
                    var from = $('#selectYear').val();
                    officeVal3 = officeId;
                    $('#toLbl').show();
                    $('#selectYear2').show();
                    loadToYearCase(from);
                });
                $("#selectYear2").change(function () {
                    var officeId = $('#selectOffice3').val();
                    var from = $('#selectYear').val();
                    var to = $('#selectYear2').val();
                    officeVal3 = officeId;
                    getYearsCase(officeId, from, to);
                    getYearsCasePieChart(officeId, from, to);
                });
                $("#selectOfficeSS1").change(function () {
                    var officeId1 = $('#selectOfficeSS1').val();
                    officeValSS1 = officeId1;
                    var officeId2 = $('#selectOfficeSS2').val();
                    officeValSS2 = officeId2;
                    get12MonthCaseSS(officeId1, officeId2);
                });
                $("#selectOfficeSS2").change(function () {
                    var officeId1 = $('#selectOfficeSS1').val();
                    officeValSS1 = officeId1;
                    var officeId2 = $('#selectOfficeSS2').val();
                    officeValSS2 = officeId2;
                    get12MonthCaseSS(officeId1, officeId2);
                });
                $("#selectOfficeSS1LY").change(function () {
                    var officeId1 = $('#selectOfficeSS1LY').val();
                    officeValSS1LY = officeId1;
                    var officeId2 = $('#selectOfficeSS2LY').val();
                    officeValSS2LY = officeId2;
                    getLastYearCaseSS(officeId1, officeId2);
                });
                $("#selectOfficeSS2LY").change(function () {
                    var officeId1 = $('#selectOfficeSS1LY').val();
                    officeValSS1LY = officeId1;
                    var officeId2 = $('#selectOfficeSS2LY').val();
                    officeValSS2LY = officeId2;
                    getLastYearCaseSS(officeId1, officeId2);
                });
                $("#selectOfficeSS1Y").change(function () {
                    var officeId1 = $('#selectOfficeSS1Y').val();
                    officeValSS1Y = officeId1;
                    var officeId2 = $('#selectOfficeSS2Y').val();
                    officeValSS2Y = officeId2;
                    var from = $('#selectYear').val();
                    var to = $('#selectYear2').val();
                    getYearsCaseSS(officeId1, officeId2, from, to);
                });
                $("#selectOfficeSS2Y").change(function () {
                    var officeId1 = $('#selectOfficeSS1Y').val();
                    officeValSS1Y = officeId1;
                    var officeId2 = $('#selectOfficeSS2Y').val();
                    officeValSS2Y = officeId2;
                    var from = $('#selectYear').val();
                    var to = $('#selectYear2').val();
                    getYearsCaseSS(officeId1, officeId2, from, to);
                });


                //Get context with jQuery - using jQuery's .get() method.
                var ctx = $("#12MonthCaseChart").get(0).getContext("2d");
                //This will get the first returned node in the jQuery collection.
                var myNewChart = new Chart(ctx);

                var data = {
                    labels: ["12 Tháng Trước", "11 Tháng Trước", "10 Tháng Trước", "9 Tháng Trước", "8 Tháng Trước", "7 Tháng Trước", "6 Tháng Trước", "5 Tháng Trước", "4 Tháng Trước", "3 Tháng Trước", "2 Tháng Trước", "Tháng Trước"],
                    datasets: [
                        {
                            fillColor: "rgba(151,187,205,0.5)",
                            strokeColor: "rgba(151,187,205,1)",
                            data: [out.chartData.feild12, out.chartData.feild11, out.chartData.feild10, out.chartData.feild9, out.chartData.feild8, out.chartData.feild7, out.chartData.feild6, out.chartData.feild5, out.chartData.feild4, out.chartData.feild3, out.chartData.feild2, out.chartData.feild1]
                        }
                    ]
                }
                new Chart(ctx).Bar(data);
            },
            error: function (errMsg) {
                alert(errMsg.responseText);
            }
        });
    }
    function get12MonthCasePieChart() {
        $.ajax({
            url: '/Statistic/Get12MonthCasePieChart',
            method: 'GET',
            async: false,
            data: {},
            success: function (out) {
                {
                    //Get context with jQuery - using jQuery's .get() method.
                    var ctx = $("#12MonthCasePieChart").get(0).getContext("2d");
                    //This will get the first returned node in the jQuery collection.
                    var myNewChart = new Chart(ctx);

                    var data = [
	                            {
	                                value: out.chartData[1],
	                                color: "#F38630",
	                            },
	                            {
	                                value: out.chartData[2],
	                                color: "#E0E4CC",
	                            },
	                            {
	                                value: out.chartData[3],
	                                color: "#69D2E7",
	                            }
                    ]
                    new Chart(ctx).Pie(data);
                };
            }
        });
    }

    function get12MonthCaseSS(officeId1, officeId2) {
        $.ajax({
            url: '/Statistic/Get12MonthCaseSS',
            method: 'GET',
            async: false,
            data: { officeId1: officeId1, officeId2: officeId2 },
            success: function (out) {
                {
                    //Get context with jQuery - using jQuery's .get() method.
                    var ctx = $("#12MonthCaseSSChart").get(0).getContext("2d");
                    //This will get the first returned node in the jQuery collection.
                    var myNewChart = new Chart(ctx);

                    var data = {
                        labels: ["12 Tháng Trước", "11 Tháng Trước", "10 Tháng Trước", "9 Tháng Trước", "8 Tháng Trước", "7 Tháng Trước", "6 Tháng Trước", "5 Tháng Trước", "4 Tháng Trước", "3 Tháng Trước", "2 Tháng Trước", "Tháng Trước"],
                        datasets: [
                            {
                                fillColor: "rgba(220,220,220,0.5)",
                                strokeColor: "rgba(220,220,220,1)",
                                pointColor: "rgba(220,220,220,1)",
                                pointStrokeColor: "#fff",
                                data: [out.chartData1.feild1, out.chartData1.feild2, out.chartData1.feild3, out.chartData1.feild4, out.chartData1.feild5, out.chartData1.feild6, out.chartData1.feild7, out.chartData1.feild8, out.chartData1.feild9, out.chartData1.feild10, out.chartData1.feild11, out.chartData1.feild12]
                            },
                            {
                                fillColor: "rgba(151,187,205,0.5)",
                                strokeColor: "rgba(151,187,205,1)",
                                pointColor: "rgba(151,187,205,1)",
                                pointStrokeColor: "#fff",
                                data: [out.chartData2.feild1, out.chartData2.feild2, out.chartData2.feild3, out.chartData2.feild4, out.chartData2.feild5, out.chartData2.feild6, out.chartData2.feild7, out.chartData2.feild8, out.chartData2.feild9, out.chartData2.feild10, out.chartData2.feild11, out.chartData2.feild12]
                            }
                        ]
                    }
                    new Chart(ctx).Line(data);
                };
            }
        });
    }
    //--------------------------------------------------------------------------
    function getLastYearCase(officeId) {
        $.ajax({
            url: '/Statistic/GetLastYearCase',
            method: 'GET',
            async: false,
            data: { officeId: officeId },
            success: function (out) {
                {
                    //Get context with jQuery - using jQuery's .get() method.
                    var ctx = $("#LastYearCaseChart").get(0).getContext("2d");
                    //This will get the first returned node in the jQuery collection.
                    var myNewChart = new Chart(ctx);

                    var data = {
                        labels: ["Tháng 1", "Tháng 2", "Tháng 3", "Tháng 4", "Tháng 5", "Tháng 6", "Tháng 7", "Tháng 8", "Tháng 9", "Tháng 10", "Tháng 11", "Tháng 12"],
                        datasets: [
                            {
                                fillColor: "rgba(151,187,205,0.5)",
                                strokeColor: "rgba(151,187,205,1)",
                                data: [out.chartData.feild1, out.chartData.feild2, out.chartData.feild3, out.chartData.feild4, out.chartData.feild5, out.chartData.feild6, out.chartData.feild7, out.chartData.feild8, out.chartData.feild9, out.chartData.feild12, out.chartData.feild11, out.chartData.feild12]
                            }
                        ]
                    }
                    new Chart(ctx).Bar(data);
                };
            }
        });
    }
    function getLastYearCasePieChart() {
        $.ajax({
            url: '/Statistic/GetLastYearCasePieChart',
            method: 'GET',
            async: false,
            data: {},
            success: function (out) {
                {
                    //Get context with jQuery - using jQuery's .get() method.
                    var ctx = $("#LastYearCasePieChart").get(0).getContext("2d");
                    //This will get the first returned node in the jQuery collection.
                    var myNewChart = new Chart(ctx);

                    var data = [
	                            {
	                                value: out.chartData[1],
	                                color: "#F38630",
	                            },
	                            {
	                                value: out.chartData[2],
	                                color: "#E0E4CC",
	                            },
	                            {
	                                value: out.chartData[3],
	                                color: "#69D2E7",
	                            }
                    ]
                    new Chart(ctx).Pie(data);
                };
            }
        });
    }

    function getLastYearCaseSS(officeId1, officeId2) {
        $.ajax({
            url: '/Statistic/GetLastYearCaseSS',
            method: 'GET',
            async: false,
            data: { officeId1: officeId1, officeId2: officeId2 },
            success: function (out) {
                {
                    //Get context with jQuery - using jQuery's .get() method.
                    var ctx = $("#LastYearCaseSSChart").get(0).getContext("2d");
                    //This will get the first returned node in the jQuery collection.
                    var myNewChart = new Chart(ctx);

                    var data = {
                        labels: ["12 Tháng Trước", "11 Tháng Trước", "10 Tháng Trước", "9 Tháng Trước", "8 Tháng Trước", "7 Tháng Trước", "6 Tháng Trước", "5 Tháng Trước", "4 Tháng Trước", "3 Tháng Trước", "2 Tháng Trước", "Tháng Trước"],
                        datasets: [
                            {
                                fillColor: "rgba(220,220,220,0.5)",
                                strokeColor: "rgba(220,220,220,1)",
                                pointColor: "rgba(220,220,220,1)",
                                pointStrokeColor: "#fff",
                                data: [out.chartData1.feild1, out.chartData1.feild2, out.chartData1.feild3, out.chartData1.feild4, out.chartData1.feild5, out.chartData1.feild6, out.chartData1.feild7, out.chartData1.feild8, out.chartData1.feild9, out.chartData1.feild10, out.chartData1.feild11, out.chartData1.feild12]
                            },
                            {
                                fillColor: "rgba(151,187,205,0.5)",
                                strokeColor: "rgba(151,187,205,1)",
                                pointColor: "rgba(151,187,205,1)",
                                pointStrokeColor: "#fff",
                                data: [out.chartData2.feild1, out.chartData2.feild2, out.chartData2.feild3, out.chartData2.feild4, out.chartData2.feild5, out.chartData2.feild6, out.chartData2.feild7, out.chartData2.feild8, out.chartData2.feild9, out.chartData2.feild10, out.chartData2.feild11, out.chartData2.feild12]
                            }
                        ]
                    }
                    new Chart(ctx).Line(data);
                };
            }
        });
    }
    //----------------------------------------------------------------------

    function getYearsCase(officeId, from, to) {
        $.ajax({
            url: '/Statistic/GetYearsCase',
            method: 'GET',
            async: false,
            data: { from: from, officeId: officeId, to: to },
            success: function (out) {
                var keys = Object.keys(out);
                var vals = [];
                for (var key in out) {
                    val = out[key];
                    vals.push(val);
                }
                //Get context with jQuery - using jQuery's .get() method.
                var ctx = $("#YearsCaseChart").get(0).getContext("2d");
                //This will get the first returned node in the jQuery collection.
                var myNewChart = new Chart(ctx);

                var data = {
                    labels: keys,
                    datasets: [
                        {
                            fillColor: "rgba(151,187,205,0.5)",
                            strokeColor: "rgba(151,187,205,1)",
                            data: vals
                        }
                    ]
                }
                new Chart(ctx).Bar(data);
            }
        });
    }
    function getYearsCasePieChart(officeId, from, to) {
        $.ajax({
            url: '/Statistic/GetYearsCasePieChart',
            method: 'GET',
            async: false,
            data: { from: from, officeId: officeId, to: to },
            success: function (out) {
                {
                    //Get context with jQuery - using jQuery's .get() method.
                    var ctx = $("#YearsCasePieChart").get(0).getContext("2d");
                    //This will get the first returned node in the jQuery collection.
                    var myNewChart = new Chart(ctx);

                    var data = [
	                            {
	                                value: out.chartData[1],
	                                color: "#F38630",
	                            },
	                            {
	                                value: out.chartData[2],
	                                color: "#E0E4CC",
	                            },
	                            {
	                                value: out.chartData[3],
	                                color: "#69D2E7",
	                            }
                    ]
                    new Chart(ctx).Pie(data);
                };
            }
        });
    }
    function getYearsCaseSS(officeId1, officeId2, from, to) {
        $.ajax({
            url: '/Statistic/GetYearsCaseSS',
            method: 'GET',
            async: false,
            data: { officeId1: officeId1, officeId2: officeId2, from: from, to: to },
            success: function (out) {
                {
                    var keys = Object.keys(out.chartData1);
                    var vals1 = [];
                    var vals2 = [];
                    for (var key in out.chartData1) {
                        val = out.chartData1[key];
                        vals1.push(val);
                    }
                    for (var key in out.chartData2) {
                        val = out.chartData2[key];
                        vals2.push(val);
                    }
                    //Get context with jQuery - using jQuery's .get() method.
                    var ctx = $("#YearsCaseSSChart").get(0).getContext("2d");
                    //This will get the first returned node in the jQuery collection.
                    var myNewChart = new Chart(ctx);

                    var data = {
                        labels: keys,
                        datasets: [
                            {
                                fillColor: "rgba(220,220,220,0.5)",
                                strokeColor: "rgba(220,220,220,1)",
                                pointColor: "rgba(220,220,220,1)",
                                pointStrokeColor: "#fff",
                                data: vals1
                            },
                            {
                                fillColor: "rgba(151,187,205,0.5)",
                                strokeColor: "rgba(151,187,205,1)",
                                pointColor: "rgba(151,187,205,1)",
                                pointStrokeColor: "#fff",
                                data: vals2
                            }
                        ]
                    }
                    new Chart(ctx).Line(data);
                };
            }
        });
    }

    function loadFromYearCase() {
        $.ajax({
            url: "/Statistic/GetFromYearCase",
            type: 'GET',
            async: false,
            success: function (data) {
                if (data.year != null) {
                    var item = '<option value="0">---</option>';
                    var keys = Object.keys(data.year);
                    for (var key in data.year) {
                        item += '<option value="' + data.year[key] + '">' + data.year[key] + '</option>';
                    }
                    $('#selectYear').html(item);
                    //$('#selectYear').val(officeVal);
                }
            },
            error: function (errMsg) {
                alert(errMsg.responseText);
            }
        });
    }

    function loadToYearCase(year) {
        $.ajax({
            url: "/Statistic/GetToYearCase",
            type: 'GET',
            async: false,
            data: { year: year },
            success: function (data) {
                if (data.year != null) {
                    var item = '<option value="0">---</option>';
                    var keys = Object.keys(data.year);
                    for (var key in data.year) {
                        item += '<option value="' + data.year[key] + '">' + data.year[key] + '</option>';
                    }
                    $('#selectYear2').html(item);
                    //$('#selectYear').val(officeVal);
                }
            },
            error: function (errMsg) {
                alert(errMsg.responseText);
            }
        });
    }

    //=======================================================================================================================================
    function renderStaffHTML() {
        $.ajax({
            url: "/Statistic/RenderStaffHTML",
            type: 'GET',
            async: false,
            success: function (data) {
                document.getElementById("bodyContent").innerHTML = (data.html);//render HTML cua partial view
            },
            error: function (errMsg) {
                alert(errMsg.responseText);
            }
        });
    }
    function get12MonthStaffRevenue(staffId) {
        $.ajax({
            url: "/Statistic/Get12MonthStaffRevenue",
            type: 'GET',
            async: false,
            data: { staffId: staffId },
            success: function (out) {
                renderStaffHTML();
                loadSelectStaff();
                loadFromYearStaffRevenue();
                // bắt sự kiện onchange của combobox sau khi nó dc render
                $("#selectStaff").change(function () {
                    var staffId = $('#selectStaff').val();
                    staffVal = staffId;
                    get12MonthStaffRevenue(staffId);
                });
                $("#selectStaff2").change(function () {
                    var staffId = $('#selectStaff2').val();
                    staffVal2 = staffId;
                    getLastYearStaffRevenue(staffId);
                });
                $("#selectStaff3").change(function () {
                    var staffId = $('#selectStaff3').val();
                    var from = $('#selectYearStaff').val();
                    var to = $('#selectYear2Staff').val();
                    staffVal3 = staffId;
                    getYearsStaffRevenue(staffId, from, to);
                });
                $("#selectYearStaff").change(function () {
                    var staffId = $('#selectStaff3').val();
                    var from = $('#selectYearStaff').val();
                    staffVal3 = staffId;
                    $('#toLbl').show();
                    $('#selectYear2Staff').show();
                    loadToYearStaffRevenue(from);
                });
                $("#selectYear2Staff").change(function () {
                    var staffId = $('#selectStaff3').val();
                    var from = $('#selectYearStaff').val();
                    var to = $('#selectYear2Staff').val();
                    staffVal3 = staffId;
                    getYearsStaffRevenue(staffId, from, to);
                });

                $("#selectStaffSS1").change(function () {
                    var staffId1 = $('#selectStaffSS1').val();
                    staffValSS1 = staffId1;
                    var staffId2 = $('#selectStaffSS2').val();
                    staffValSS2 = staffId2;
                    get12MonthStaffRevenueSS(staffId1, staffId2);
                });
                $("#selectStaffSS2").change(function () {
                    var staffId1 = $('#selectStaffSS1').val();
                    staffValSS1 = staffId1;
                    var staffId2 = $('#selectStaffSS2').val();
                    staffValSS2 = staffId2;
                    get12MonthStaffRevenueSS(staffId1, staffId2);
                });
                $("#selectStaffSS1LY").change(function () {
                    var staffId1 = $('#selectStaffSS1LY').val();
                    staffValSS1LY = staffId1;
                    var staffId2 = $('#selectStaffSS2LY').val();
                    staffValSS2LY = staffId2;
                    getLastYearStaffRevenueSS(staffId1, staffId2);
                });
                $("#selectStaffSS2LY").change(function () {
                    var staffId1 = $('#selectStaffSS1LY').val();
                    staffValSS1LY = staffId1;
                    var staffId2 = $('#selectStaffSS2LY').val();
                    staffValSS2LY = staffId2;
                    getLastYearStaffRevenueSS(staffId1, staffId2);
                });
                $("#selectStaffSS1Y").change(function () {
                    var staffId1 = $('#selectStaffSS1Y').val();
                    staffValSS1Y = staffId1;
                    var staffId2 = $('#selectStaffSS2Y').val();
                    staffValSS2Y = staffId2;
                    var from = $('#selectYearStaff').val();
                    var to = $('#selectYear2Staff').val();
                    getYearsStaffRevenueSS(staffId1, staffId2, from, to);
                });
                $("#selectStaffSS2Y").change(function () {
                    var staffId1 = $('#selectStaffSS1Y').val();
                    staffValSS1Y = staffId1;
                    var staffId2 = $('#selectStaffSS2Y').val();
                    staffValSS2Y = staffId2;
                    var from = $('#selectYearStaff').val();
                    var to = $('#selectYear2Staff').val();
                    getYearsStaffRevenueSS(staffId1, staffId2, from, to);
                });
                $("#selectStaff").chosen();
                $("#selectStaff_chosen").css("width", "30%");
                $("#selectStaff2").chosen();
                $("#selectStaff2_chosen").css("width", "30%");
                $("#selectStaff3").chosen();
                $("#selectStaff3_chosen").css("width", "30%");

                $("#selectStaffSS1").chosen();
                $("#selectStaffSS1_chosen").css("width", "30%");
                $("#selectStaffSS2").chosen();
                $("#selectStaffSS2_chosen").css("width", "30%");
                $("#selectStaffSS1LY").chosen();
                $("#selectStaffSS1LY_chosen").css("width", "30%");
                $("#selectStaffSS2LY").chosen();
                $("#selectStaffSS2LY_chosen").css("width", "30%");
                $("#selectStaffSS1Y").chosen();
                $("#selectStaffSS1Y_chosen").css("width", "30%");
                $("#selectStaffSS2Y").chosen();
                $("#selectStaffSS2Y_chosen").css("width", "30%");

                //Get context with jQuery - using jQuery's .get() method.
                var ctx = $("#12MonthStaffRevenueChart").get(0).getContext("2d");
                //This will get the first returned node in the jQuery collection.
                var myNewChart = new Chart(ctx);

                var data = {
                    labels: ["12 Tháng Trước", "11 Tháng Trước", "10 Tháng Trước", "9 Tháng Trước", "8 Tháng Trước", "7 Tháng Trước", "6 Tháng Trước", "5 Tháng Trước", "4 Tháng Trước", "3 Tháng Trước", "2 Tháng Trước", "Tháng Trước"],
                    datasets: [
                        {
                            fillColor: "rgba(151,187,205,0.5)",
                            strokeColor: "rgba(151,187,205,1)",
                            data: [out.chartData.feild12, out.chartData.feild11, out.chartData.feild10, out.chartData.feild9, out.chartData.feild8, out.chartData.feild7, out.chartData.feild6, out.chartData.feild5, out.chartData.feild4, out.chartData.feild3, out.chartData.feild2, out.chartData.feild1]
                        }
                    ]
                }
                new Chart(ctx).Bar(data);
            },
            error: function (errMsg) {
                alert(errMsg.responseText);
            }
        });
    }
    function get12MonthStaffRevenueSS(staffId1, staffId2) {
        $.ajax({
            url: '/Statistic/Get12MonthStaffSS',
            method: 'GET',
            async: false,
            data: { staffId1: staffId1, staffId2: staffId2 },
            success: function (out) {
                {
                    //Get context with jQuery - using jQuery's .get() method.
                    var ctx = $("#12MonthStaffRevenueSSChart").get(0).getContext("2d");
                    //This will get the first returned node in the jQuery collection.
                    var myNewChart = new Chart(ctx);

                    var data = {
                        labels: ["12 Tháng Trước", "11 Tháng Trước", "10 Tháng Trước", "9 Tháng Trước", "8 Tháng Trước", "7 Tháng Trước", "6 Tháng Trước", "5 Tháng Trước", "4 Tháng Trước", "3 Tháng Trước", "2 Tháng Trước", "Tháng Trước"],
                        datasets: [
                            {
                                fillColor: "rgba(220,220,220,0.5)",
                                strokeColor: "rgba(220,220,220,1)",
                                pointColor: "rgba(220,220,220,1)",
                                pointStrokeColor: "#fff",
                                data: [out.chartData1.feild1, out.chartData1.feild2, out.chartData1.feild3, out.chartData1.feild4, out.chartData1.feild5, out.chartData1.feild6, out.chartData1.feild7, out.chartData1.feild8, out.chartData1.feild9, out.chartData1.feild10, out.chartData1.feild11, out.chartData1.feild12]
                            },
                            {
                                fillColor: "rgba(151,187,205,0.5)",
                                strokeColor: "rgba(151,187,205,1)",
                                pointColor: "rgba(151,187,205,1)",
                                pointStrokeColor: "#fff",
                                data: [out.chartData2.feild1, out.chartData2.feild2, out.chartData2.feild3, out.chartData2.feild4, out.chartData2.feild5, out.chartData2.feild6, out.chartData2.feild7, out.chartData2.feild8, out.chartData2.feild9, out.chartData2.feild10, out.chartData2.feild11, out.chartData2.feild12]
                            }
                        ]
                    }
                    new Chart(ctx).Line(data);
                };
            }
        });
    }
    //------------------------------------------------------------------
    function getLastYearStaffRevenue(staffId) {
        $.ajax({
            url: '/Statistic/GetLastYearStaffRevenue',
            method: 'GET',
            async: false,
            data: { staffId: staffId },
            success: function (out) {
                {
                    //Get context with jQuery - using jQuery's .get() method.
                    var ctx = $("#LastYearStaffRevenueChart").get(0).getContext("2d");
                    //This will get the first returned node in the jQuery collection.
                    var myNewChart = new Chart(ctx);

                    var data = {
                        labels: ["Tháng 1", "Tháng 2", "Tháng 3", "Tháng 4", "Tháng 5", "Tháng 6", "Tháng 7", "Tháng 8", "Tháng 9", "Tháng 10", "Tháng 11", "Tháng 12"],
                        datasets: [
                            {
                                fillColor: "rgba(151,187,205,0.5)",
                                strokeColor: "rgba(151,187,205,1)",
                                data: [out.chartData.feild1, out.chartData.feild2, out.chartData.feild3, out.chartData.feild4, out.chartData.feild5, out.chartData.feild6, out.chartData.feild7, out.chartData.feild8, out.chartData.feild9, out.chartData.feild12, out.chartData.feild11, out.chartData.feild12]
                            }
                        ]
                    }
                    new Chart(ctx).Bar(data);
                };
            }
        });
    }
    function getLastYearStaffRevenueSS(staffId1, staffId2) {
        $.ajax({
            url: '/Statistic/GetLastYearStaffSS',
            method: 'GET',
            async: false,
            data: { staffId1: staffId1, staffId2: staffId2 },
            success: function (out) {
                {
                    //Get context with jQuery - using jQuery's .get() method.
                    var ctx = $("#LastYearStaffRevenueSSChart").get(0).getContext("2d");
                    //This will get the first returned node in the jQuery collection.
                    var myNewChart = new Chart(ctx);

                    var data = {
                        labels: ["12 Tháng Trước", "11 Tháng Trước", "10 Tháng Trước", "9 Tháng Trước", "8 Tháng Trước", "7 Tháng Trước", "6 Tháng Trước", "5 Tháng Trước", "4 Tháng Trước", "3 Tháng Trước", "2 Tháng Trước", "Tháng Trước"],
                        datasets: [
                            {
                                fillColor: "rgba(220,220,220,0.5)",
                                strokeColor: "rgba(220,220,220,1)",
                                pointColor: "rgba(220,220,220,1)",
                                pointStrokeColor: "#fff",
                                data: [out.chartData1.feild1, out.chartData1.feild2, out.chartData1.feild3, out.chartData1.feild4, out.chartData1.feild5, out.chartData1.feild6, out.chartData1.feild7, out.chartData1.feild8, out.chartData1.feild9, out.chartData1.feild10, out.chartData1.feild11, out.chartData1.feild12]
                            },
                            {
                                fillColor: "rgba(151,187,205,0.5)",
                                strokeColor: "rgba(151,187,205,1)",
                                pointColor: "rgba(151,187,205,1)",
                                pointStrokeColor: "#fff",
                                data: [out.chartData2.feild1, out.chartData2.feild2, out.chartData2.feild3, out.chartData2.feild4, out.chartData2.feild5, out.chartData2.feild6, out.chartData2.feild7, out.chartData2.feild8, out.chartData2.feild9, out.chartData2.feild10, out.chartData2.feild11, out.chartData2.feild12]
                            }
                        ]
                    }
                    new Chart(ctx).Line(data);
                };
            }
        });
    }
    //--------------------------------------------------------
    function getYearsStaffRevenue(staffId, from, to) {
        $.ajax({
            url: '/Statistic/GetYearsStaffRevenue',
            method: 'GET',
            async: false,
            data: { from: from, staffId: staffId, to: to },
            success: function (out) {
                var keys = Object.keys(out);
                var vals = [];
                for (var key in out) {
                    val = out[key];
                    vals.push(val);
                }
                //Get context with jQuery - using jQuery's .get() method.
                var ctx = $("#YearsStaffChart").get(0).getContext("2d");
                //This will get the first returned node in the jQuery collection.
                var myNewChart = new Chart(ctx);

                var data = {
                    labels: keys,
                    datasets: [
                        {
                            fillColor: "rgba(151,187,205,0.5)",
                            strokeColor: "rgba(151,187,205,1)",
                            data: vals
                        }
                    ]
                }
                new Chart(ctx).Bar(data);
            }
        });
    }
    function getYearsStaffRevenueSS(staffId1, staffId2, from, to) {
        $.ajax({
            url: '/Statistic/GetYearsStaffRevenueSS',
            method: 'GET',
            async: false,
            data: { staffId1: staffId1, staffId2: staffId2, from: from, to: to },
            success: function (out) {
                {
                    var keys = Object.keys(out.chartData1);
                    var vals1 = [];
                    var vals2 = [];
                    for (var key in out.chartData1) {
                        val = out.chartData1[key];
                        vals1.push(val);
                    }
                    for (var key in out.chartData2) {
                        val = out.chartData2[key];
                        vals2.push(val);
                    }
                    //Get context with jQuery - using jQuery's .get() method.
                    var ctx = $("#YearsStaffRevenueSSChart").get(0).getContext("2d");
                    //This will get the first returned node in the jQuery collection.
                    var myNewChart = new Chart(ctx);

                    var data = {
                        labels: keys,
                        datasets: [
                            {
                                fillColor: "rgba(220,220,220,0.5)",
                                strokeColor: "rgba(220,220,220,1)",
                                pointColor: "rgba(220,220,220,1)",
                                pointStrokeColor: "#fff",
                                data: vals1
                            },
                            {
                                fillColor: "rgba(151,187,205,0.5)",
                                strokeColor: "rgba(151,187,205,1)",
                                pointColor: "rgba(151,187,205,1)",
                                pointStrokeColor: "#fff",
                                data: vals2
                            }
                        ]
                    }
                    new Chart(ctx).Line(data);
                };
            }
        });
    }
    function loadFromYearStaffRevenue() {
        $.ajax({
            url: "/Statistic/GetFromYearStaffRevenue",
            type: 'GET',
            async: false,
            success: function (data) {
                if (data.year != null) {
                    var item = '<option value="0">---</option>';
                    var keys = Object.keys(data.year);
                    for (var key in data.year) {
                        item += '<option value="' + data.year[key] + '">' + data.year[key] + '</option>';
                    }
                    $('#selectYearStaff').html(item);
                    //$('#selectYear').val(staffVal);
                }
            },
            error: function (errMsg) {
                alert(errMsg.responseText);
            }
        });
    }

    function loadToYearStaffRevenue(year) {
        $.ajax({
            url: "/Statistic/GetToYearStaffRevenue",
            type: 'GET',
            async: false,
            data: { year: year },
            success: function (data) {
                if (data.year != null) {
                    var item = '<option value="0">---</option>';
                    var keys = Object.keys(data.year);
                    for (var key in data.year) {
                        item += '<option value="' + data.year[key] + '">' + data.year[key] + '</option>';
                    }
                    $('#selectYear2Staff').html(item);
                }
            },
            error: function (errMsg) {
                alert(errMsg.responseText);
            }
        });
    }

    function loadSelectStaff() {
        $.ajax({
            url: "/Statistic/GetAllSelectStaff",
            type: 'GET',
            async: false,
            success: function (data) {
                if (data.staff != null) {
                    var item = "";//<option value=''" + ">&nbsp</option>
                    $.each(data.staff, function (index, staff) {
                        item += '<option value="' + staff.StaffId + '">' + staff.StaffName + " (" + staff.Accounts[0].Username + ')</option>';
                    });
                    $("#selectStaff").html(item);
                    $("#selectStaff").val(staffVal);
                    $("#selectStaff").trigger("chosen:updated");
                    $("#selectStaff2").html(item);
                    $("#selectStaff2").val(staffVal2);
                    $("#selectStaff2").trigger("chosen:updated");
                    $("#selectStaff3").html(item);
                    $("#selectStaff3").val(staffVal3);
                    $("#selectStaff3").trigger("chosen:updated");

                    $("#selectStaffSS1").html(item);
                    $("#selectStaffSS1").val(staffValSS1);
                    $("#selectStaffSS1").trigger("chosen:updated");
                    $("#selectStaffSS2").html(item);
                    $("#selectStaffSS2").val(staffValSS2);
                    $("#selectStaffSS2").trigger("chosen:updated");
                    $("#selectStaffSS1LY").html(item);
                    $("#selectStaffSS1LY").val(staffValSS1LY);
                    $("#selectStaffSS1LY").trigger("chosen:updated");
                    $("#selectStaffSS2LY").html(item);
                    $("#selectStaffSS2LY").val(staffValSS2LY);
                    $("#selectStaffSS2LY").trigger("chosen:updated");
                    $("#selectStaffSS1Y").html(item);
                    $("#selectStaffSS1Y").val(staffValSS1Y);
                    $("#selectStaffSS1Y").trigger("chosen:updated");
                    $("#selectStaffSS2Y").html(item);
                    $("#selectStaffSS2Y").val(staffValSS2Y);
                    $("#selectStaffSS2Y").trigger("chosen:updated");
                }
            },
            error: function (errMsg) {
                alert(errMsg.responseText);
            }
        });
    }

    function exportExcel() {
        $.post("/Statistic/ExportExcel", {}, function (result) {
            if (result == "Successful") {
                notification("Xuất file Excel thành công !", "", 2000, "btn-primary center");
            } else if (result == 'Error') {
                notification("Xuất file Excel thất bại!", "Không có dữ liệu để xuất ra file, hãy chọn tháng khác!.", 3000, "gritter-error center");
            }
        }).error(function () {
            $('.close').click();
            notification("Xuất file Excel thất bại", "Hãy kiểm tra lại kết nối database.", 3000, "gritter-error center");
        });
    }
</script>
                            <!-- PAGE CONTENT ENDS -->
                        </div><!-- /.col -->
                    </div><!-- /.row -->
                </div><!-- /.page-content -->
            </div><!-- /.main-content -->

        </div><!-- /.main-container-inner -->

        <a href="#" id="btn-scroll-up" class="btn-scroll-up btn btn-sm btn-inverse">
            <i class="icon-double-angle-up icon-only bigger-110"></i>
        </a>
    </div><!-- /.main-container -->
    
    


</body></html>