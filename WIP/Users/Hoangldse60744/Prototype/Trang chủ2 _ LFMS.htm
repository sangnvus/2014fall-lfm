<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Trang chủ | LFMS</title>
    <link href="http://localhost:19442/Content/logo/LFMS-icon-48.png" rel="icon">

    

    <!-- basic styles -->
    <link href="Trang%20ch%E1%BB%A72%20_%20LFMS_files/main.css" rel="stylesheet" type="text/css">
    <link href="Trang%20ch%E1%BB%A72%20_%20LFMS_files/bootstrap.css" rel="stylesheet" type="text/css">
    <link href="Trang%20ch%E1%BB%A72%20_%20LFMS_files/font-awesome.css" rel="stylesheet" type="text/css">

    <!-- ace styles -->
    <link href="Trang%20ch%E1%BB%A72%20_%20LFMS_files/ace.css" rel="stylesheet" type="text/css">
    <link href="Trang%20ch%E1%BB%A72%20_%20LFMS_files/ace-rtl.css" rel="stylesheet" type="text/css">
    <link href="Trang%20ch%E1%BB%A72%20_%20LFMS_files/ace-skins.css" rel="stylesheet" type="text/css">

    <!-- ace settings handler -->
    <script src="Trang%20ch%E1%BB%A72%20_%20LFMS_files/ace-extra.js" type="text/javascript"></script>

    <!-- basic scripts -->
    <!--[if !IE]> -->
    <script src="Trang%20ch%E1%BB%A72%20_%20LFMS_files/jquery-2.js" type="text/javascript"></script>
    <!-- <![endif]-->
    <script src="Trang%20ch%E1%BB%A72%20_%20LFMS_files/main.js" type="text/javascript"></script>

    <!--[if !IE]> -->
    <script type="text/javascript">
        window.jQuery || document.write("<script src='~/Content/js/jquery-2.0.3.min.js'>" + "<" + "/script>");
    </script>
    <!-- <![endif]-->

    <script type="text/javascript">
        if ("ontouchend" in document && document.ontouchend != null) document.write("<script src='~/Content/js/jquery.mobile.custom.min.js'>" + "<" + "/script>");
    </script>
    <script src="Trang%20ch%E1%BB%A72%20_%20LFMS_files/bootstrap.js" type="text/javascript"></script>
    <script src="Trang%20ch%E1%BB%A72%20_%20LFMS_files/typeahead-bs2.js" type="text/javascript"></script>

    <!-- ace scripts -->
    <script src="Trang%20ch%E1%BB%A72%20_%20LFMS_files/ace-elements.js" type="text/javascript"></script>
    <script src="Trang%20ch%E1%BB%A72%20_%20LFMS_files/ace.js" type="text/javascript"></script>
    <script src="Trang%20ch%E1%BB%A72%20_%20LFMS_files/md5.js" type="text/javascript"></script>


</head>

<body spellcheck="false">
    <div class="navbar navbar-default" id="navbar">
        <script type="text/javascript">
            try { ace.settings.check('navbar', 'fixed') } catch (e) { }
        </script>

        <div class="navbar-container" id="navbar-container">
            <div class="navbar-header pull-left">
                <a href="http://localhost:19442/Home/Index" class="navbar-brand" title="Trang chủ">
                    <small>
                        <img src="Trang%20ch%E1%BB%A72%20_%20LFMS_files/LFMS-logo-big.png" style="border: none; height: 22px">
                    </small>
                </a><!-- /.brand -->
            </div><!-- /.navbar-header -->
            <div id="staffIdDiv" value="1" style="display:none"></div>

<div class="navbar-header pull-right" role="navigation">
    <ul class="nav ace-nav">
        <li class="green" id="notificationArea" style="display: block"><a data-toggle="dropdown" class="dropdown-toggle" href="#"><i class="icon-bell-alt icon-animated-bell" id="bellIcon"></i><span class="badge badge-important" id="countCalender1">1</span></a><ul class="pull-right dropdown-navbar dropdown-menu dropdown-caret dropdown-close"><li class="dropdown-header"><i class="icon-calendar"></i>Hôm nay có <span id="countCalender2">1</span> sự kiện</li><li><a><span class="label label-lg label-success" style="margin-right: 10px"><i class="icon-info-sign"></i></span><span class="msg-body"><span class="msg-title" style="font-weight: bold">Gặp anh Nam</span><span class="msg-time"><span> Từ ngày: 19/09/2014</span></span><span class="msg-time"><span> Đến ngày: 20/09/2014</span></span></span></a></li><li></li></ul></li>

        <li class="light-green">
            <a data-toggle="dropdown" href="#" class="dropdown-toggle">
                <img class="nav-user-photo" src="Trang%20ch%E1%BB%A72%20_%20LFMS_files/thuannh.jpg" alt="">
                <span class="user-info">
                    <small>Xin chào,</small>
                    <p>Nguyễn Hòa Thuận</p>
                </span>

                <i class="icon-caret-down"></i>
            </a>

            <ul class="user-menu pull-right dropdown-menu dropdown-yellow dropdown-caret dropdown-close">
                <li>
                    <a href="http://localhost:19442/Case/ListCase" onclick="">
                        <i class="icon-folder-open"></i>
                        Danh sách hồ sơ
                    </a>
                </li>

                <li class="divider"></li>

                    <li>
                        <a href="http://localhost:19442/Customer/Customer" onclick="">
                            <i class="icon-group"></i>
                            Quản lý khách hàng
                        </a>
                    </li>
                    <li class="divider"></li>
                    <li>
                        <a href="http://localhost:19442/Staff/Staff">
                            <i class="icon-user"></i>
                            Quản lý nhân viên
                        </a>
                    </li>
                    <li class="divider"></li>
                    <li>
                        <a href="http://localhost:19442/Service/Service" onclick="">
                            <i class="icon-cog"></i>
                            Quản lý dịch vụ
                        </a>
                    </li>
                    <li class="divider"></li>
                    <li>
                        <a href="http://localhost:19442/Office/Office">
                            <i class="icon-home"></i>
                            Quản lý văn phòng
                        </a>
                    </li>
                    <li class="divider"></li>
                    <li>
                        <a href="http://localhost:19442/Salary/Salary">
                            <i class=" icon-globe"></i>
                            Quản lí lương nhân viên
                        </a>
                    </li>
                    <li class="divider"></li>
                    <li>
                        <a href="http://localhost:19442/Statistic/Statistic">
                            <i class="icon-home"></i>
                            Thống kê
                        </a>
                    </li>
                     <li class="divider"></li>
                    <li>
                        <a href="http://localhost:19442/OtherCost/OtherCost">
                            <i class="icon-cog"></i>
                            Chi phí khác
                        </a>
                    </li>
                    <li class="divider"></li>

                <li>
                    <a data-toggle="modal" href="#tblPassChange" onclick='$("#PassChangeDiv").appendTo("#bodyChangePass"); validatePassword("#validatPassForm"); clearFieldPassword();'>
                        <i class="icon-key"></i>
                        Đổi mật khẩu
                    </a>
                </li>

                <li class="divider"></li>

                <li>
                    <a href="#" onclick="logOut()">
                        <i class="icon-off"></i>
                        Đăng xuất
                    </a>
                </li>
            </ul>
        </li>
    </ul><!-- /.ace-nav -->
</div><!-- /.navbar-header -->

<script>
    $(document).ready(function () {
        GetCalendarsByStaffId();
    });

    function GetCalendarsByStaffId() {
        $.post("/UserControl/GetCalendarsByStaffId", { staffId: $("#staffIdDiv").attr("value") }, function (out) {
            var item = '<a data-toggle="dropdown" class="dropdown-toggle" href="#"><i class="icon-bell-alt" id="bellIcon"></i><span class="badge badge-success" id="countCalender1"></span></a>';
            item += '<ul class="pull-right dropdown-navbar dropdown-menu dropdown-caret dropdown-close"><li class="dropdown-header"><i class="icon-calendar"></i>Hôm nay có <span id="countCalender2"></span> sự kiện</li>';
            var count = 0;

            $.each(out, function (index, ca) {
                var casecode = "";
                var priority;
                if (typeof (ca.Case) != "undefined") {
                    casecode = " (" + ca.Case.CaseCode + ")";
                    priority = "";
                } else priority = ca.Priority;
                count += 1;

                item += '<li><a>';
                item += '<span class="label label-lg ' + priority + '" style="margin-right: 10px"><i class="icon-info-sign"></i></span>';
                item += '<span class="msg-body">';
                item += '<span class="msg-title" style="font-weight: bold">' + ca.Title + casecode + '</span>';

                var date1 = convertNETDateTime(ca.BeginTime).toLocaleFormat('%d/%m/%Y');
                var time1 = convertNETDateTime(ca.BeginTime).toLocaleTimeString();
                var date2 = convertNETDateTime(ca.EndTime).toLocaleFormat('%d/%m/%Y');
                var time2 = convertNETDateTime(ca.EndTime).toLocaleTimeString();

                if (date1 == date2) {
                    if (time1 == "12:00:00 AM" && time2 == "12:00:00 AM") {
                        item += '<span class="msg-time"><span>Cả ngày</span></span>';
                    } else {
                        item += '<span class="msg-time"><span> Bắt đầu: ' + time1 + '</span></span>';
                        item += '<span class="msg-time"><span> Kết thúc: ' + time2 + '</span></span>';
                    }
                } else {
                    item += '<span class="msg-time"><span> Từ ngày: ' + date1 + '</span></span>';
                    item += '<span class="msg-time"><span> Đến ngày: ' + date2 + '</span></span>';
                }

                item += '</span>'; // span body
                item += '</a></li>';
            });

            item += '<li></li></ul>';
            $('#notificationArea').html(item);
            $('#countCalender1').text(count);
            $('#countCalender2').text(count);

            if (count != 0) {
                $('#countCalender1').attr('class', 'badge badge-important');
                $('#bellIcon').attr('class', 'icon-bell-alt icon-animated-bell');
            }
        });
    }

</script>

<div id="PassChangeDiv">
    <div id="tblPassChange" class="modal fade" tabindex="-1">
        <div class="modal-dialog" style="width: 100%; min-width: 600px; max-width: 600px">
            <div class="modal-content">
                <div class="modal-header no-padding">
                    <div class="table-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                            <span class="white">×</span>
                        </button>
                        Thay đổi mật khẩu
                    </div>
                </div>
                <form class="modal-body no-padding" id="validatPassForm">
                    <div class="modal-body no-padding">
                        <div class="col-xs-12 form-horizontal" style="padding-top: 20px; margin-left: 10px">
                            <div class="row">
                                <div class="form-group col-sm-12">
                                    <label class="col-sm-4 ">Mật khẩu cũ: <span style="color: red"> *</span></label>
                                    <div class="col-sm-8">
                                        
                                        <div>
                                            <input name="Oldpassword" id="Oldpassword" style="width:100%" type="password">
                                        </div>
                                        <div id="checkPass" style="display: none">
                                            <span style="color: #D16E6C">Mật khẩu cũ không đúng ! </span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="form-group col-sm-12">
                                    <label class="col-sm-4 ">Mật khẩu mới: <span style="color: red"> *</span></label>
                                    <div class="col-sm-8">
                                        <div>
                                            <input name="password" id="password" style="width:100%" type="password">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="form-group col-sm-12">
                                    <label class="col-sm-4 ">Lặp lại mật khẩu mới: <span style="color: red"> *</span></label>
                                    <div class="col-sm-8">
                                        <div>
                                            <input name="password2" id="password2" style="width:100%" type="password">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>

                <div class="modal-footer no-margin-top"></div>
                <div class="modal-footer no-margin-top">
                    <button class="btn btn-grey pull-left" type="button" data-dismiss="modal" id="btnCloseChange">
                        <i class="icon-remove"></i>
                        Đóng
                    </button>
                    <button class="btn btn-success" type="button" data-bb-handler="confirm" id="btnUpdatePass" onclick="updateStaffPass()">
                        <i class="icon-ok"></i>
                        Đổi mật khẩu
                    </button>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div>
</div>
<script type="text/javascript">
    function updateStaffPass() {
        if ($('#validatPassForm').valid()) {
            editFr = $('#tblPassChange');
            var oldPassword = $.md5($('#Oldpassword', editFr).val());
            var staffPassword = $.md5($('#password2', editFr).val());
            $.post("/UserControl/UpdateStaffPass", {
                oldPassword: oldPassword, staffPassword2: staffPassword
            }, function (result) {
                if (result == "successful") {
                    $('.close').click();
                    $('#checkPass').attr("style", "display: none");
                    notification("Cập nhật mật khẩu nhân viên thành công!", "", 3000, "btn-primary center");
                } else if (result == 'error') {
                    $('.close').click();
                    $('#checkPass').attr("style", "display: none");
                    notification("Cập nhật mật khẩu nhân viên nhân viên thất bại!", "Hãy kiểm tra lại kết nối database.", 5000, "gritter-error center");
                } else if (result == "notMatch") {
                    $('#checkPass').attr("style", "display: block");
                }
            })
                .error(function () {
                    $('.close').click();
                    $('#checkPass').attr("style", "display: none");
                    notification("Cập nhật mật khẩu nhân viên thất bại", "Hãy kiểm tra lại kết nối database.", 5000, "gritter-error center");
                });
        }
    }

    function validatePassword(validateform) {
        $(validateform).validate({
            errorElement: 'div',
            errorClass: 'help-block',
            focusInvalid: false,
            rules: {
                password: {
                    required: true,
                    alphanumeric: true,
                    minlength: 6


                },
                password2: {
                    required: true,
                    alphanumeric: true,
                    minlength: 6,
                    equalTo: "#password"
                },
                Oldpassword: {
                    required: true,
                    alphanumeric: true
                }
            },
            messages: {
                password: {
                    required: "Hãy nhập mật khẩu mới.",
                    alphanumeric: "Mật khẩu không được có kí tự đặc biệt",
                    minlength: "Mật khẩu mới phải có ít nhất 6 kí tự.",
                },
                password2: {
                    required: "Hãy nhập lại mật khẩu mới.",
                    alphanumeric: "Mật khẩu không được có kí tự đặc biệt",
                    minlength: "Mật khẩu mới phải có ít nhất 6 kí tự.",
                    equalTo: "Mật khẩu 2 không trùng khớp.",
                },
                Oldpassword: {
                    required: "Hãy nhập lại mật khẩu cũ.",
                    alphanumeric: "Mật khẩu không được có kí tự đặc biệt",
                }
            },
            highlight: function (e) {
                $(e).closest('.form-group').removeClass('has-info').addClass('has-error');
            },

            success: function (e) {
                $(e).closest('.form-group').removeClass('has-error').addClass('has-info');
                $(e).remove();
            },
            errorPlacement: function (error, element) {
                if (element.is(':checkbox') || element.is(':radio')) {
                    var controls = element.closest('div[class*="col-"]');
                    if (controls.find(':checkbox,:radio').length > 1) controls.append(error);
                    else error.insertAfter(element.nextAll('.lbl:eq(0)').eq(0));
                }
                else error.insertAfter(element.parent());
            }
        });
    }

    function clearFieldPassword() {
        editFr = $('#tblPassChange');
        $('#Oldpassword', editFr).val("");
        $('#password', editFr).val("");
        $('#password2', editFr).val("");

    }

    function logOut() {
        $.post("/Login/LogOut", {}, function (out) {
            if (out != "success") {
                alert(out);
            }
            window.location = ("/Login/Login");
        });
    }
</script>


            
        </div><!-- /.container -->
    </div>

    <div class="main-container" id="main-container">
        <script type="text/javascript">
            try { ace.settings.check('main-container', 'fixed') } catch (e) { }
        </script>

        <div class="main-container-inner">

            <div class="main-content" style="margin-left:0">

                <div class="page-content">
                    <div class="row">
                        <div class="col-xs-12">
                            <!-- PAGE CONTENT BEGINS -->
                            

<link rel="stylesheet" href="Trang%20ch%E1%BB%A72%20_%20LFMS_files/jquery-ui-1.css">
<link rel="stylesheet" href="Trang%20ch%E1%BB%A72%20_%20LFMS_files/fullcalendar.css">
<link rel="stylesheet" href="Trang%20ch%E1%BB%A72%20_%20LFMS_files/jquery.css">
<link rel="stylesheet" href="Trang%20ch%E1%BB%A72%20_%20LFMS_files/jquery-ui-1.css">

<link rel="stylesheet" href="Trang%20ch%E1%BB%A72%20_%20LFMS_files/chosen.css">
<link rel="stylesheet" href="Trang%20ch%E1%BB%A72%20_%20LFMS_files/bootstrap.css">
<link rel="stylesheet" href="Trang%20ch%E1%BB%A72%20_%20LFMS_files/font-awesome.css">
<link rel="stylesheet" href="Trang%20ch%E1%BB%A72%20_%20LFMS_files/ace.css">
<link rel="stylesheet" href="Trang%20ch%E1%BB%A72%20_%20LFMS_files/datepicker.css" type="text/css">


<script src="Trang%20ch%E1%BB%A72%20_%20LFMS_files/jquery-ui-1.js" type="text/javascript"></script>
<script src="Trang%20ch%E1%BB%A72%20_%20LFMS_files/chosen.js" type="text/javascript"></script>
<script src="Trang%20ch%E1%BB%A72%20_%20LFMS_files/fullcalendar.js"></script>
<script src="Trang%20ch%E1%BB%A72%20_%20LFMS_files/jquery_002.js"></script>
<script src="Trang%20ch%E1%BB%A72%20_%20LFMS_files/bootbox.js" type="text/javascript"></script>

<script src="Trang%20ch%E1%BB%A72%20_%20LFMS_files/jquery_003.js"></script>
<script src="Trang%20ch%E1%BB%A72%20_%20LFMS_files/additional-methods.js" type="text/javascript"></script>

<script src="Trang%20ch%E1%BB%A72%20_%20LFMS_files/bootstrap-datepicker.js" type="text/javascript"></script>
<script src="Trang%20ch%E1%BB%A72%20_%20LFMS_files/jquery.js" type="text/javascript"></script>

<div id="bodyChangePass"> </div>

<div id="staffRoleIdDiv" value="1" style="display:none"></div>

<div id="addNewCaseBtn" style="position: absolute; top: 0px; left: 6%; display: none;">
    <a href="#modalAddNewCase" role="button" class="green" data-toggle="modal">
        <button class="btn btn-primary" onclick="" style="border-radius: 6px">
            <center><i class="icon-plus"></i></center>
        </button>
    </a>
</div>

<ul class="nav nav-pills" style="width: 80%; margin-left: 10%">
    <li id="caseLi" class="">
        <a href="#" id="caseA" onclick="prepareForCase()"><i class="icon-folder-open"></i> Hồ Sơ</a>
    </li>

    <li class="active" id="eventLi">
        <a style="background-color: #A0A0A0" href="#" id="eventA" onclick="prepareForCalendar()"><i class="icon-calendar"></i> Lịch Làm Việc</a>
    </li>
</ul>

<div style="width: 80%; margin-left: 10%">
    <div id="caseContent" style="display: none;"><div style="padding: 20px 0px"><h3 class="header smaller lighter green"><i class="icon-legal"></i> Luật Thuận Nguyễn Hồ Chí Minh</h3><a href="http://localhost:19442/Case/Case/3" class="btn btn-case btn-primary"><p style="font-weight: bold; padding-bottom: 15px">DSST2014001</p><p>01/04/2014</p><p class="myparagraph">Tranh chấp quyền sử dụng đất và kiện đòi tài sản</p></a><a href="http://localhost:19442/Case/Case/6" class="btn btn-case btn-primary"><p style="font-weight: bold; padding-bottom: 15px">TLST2014002</p><p>01/11/2013</p><p class="myparagraph">Kiện đòi tài sản</p></a><a href="http://localhost:19442/Case/Case/1007" class="btn btn-case btn-primary"><p style="font-weight: bold; padding-bottom: 15px">TLST2014003</p><p>08/04/2014</p><p class="myparagraph">Tranh chấp thừa kế</p></a></div><div style="padding: 20px 0px"><h3 class="header smaller lighter green"><i class="icon-legal"></i> Luật Thuận Nguyễn Vĩnh Long</h3><a href="http://localhost:19442/Case/Case/2" class="btn btn-case btn-primary"><p style="font-weight: bold; padding-bottom: 15px">HS20140002</p><p>14/02/2014</p><p class="myparagraph">Đòi bồi thường tai nạn giao thông</p></a></div></div>
</div>

<div id="calendarContent" style="">
    <div style="position: absolute; right: 12px; top:0;">
        <div id="searchBtn" style="position: absolute; right: 0; top:0">
            <button class="btn btn-sm btn-warning">
                <i class="icon-arrow-left icon-on-right"></i>
                <span class="bigger-110 no-text-shadow"> Lịch làm việc các luật sư</span> 
            </button>
        </div>

        <div id="searchContent">
            <div style="margin-top: 5%; margin-left: 5%;padding-bottom:15px">
                <i style="margin-right:5px"><b>Luật sư: </b></i>
                <select style="display: none;" class="chosen-select" id="ChosenCalendar" data-placeholder=""><option value="2">Nguyễn Huỳnh Kim Ngân (ngannhk)</option><option value="3">Lê Văn Dụng (dunglv)</option><option value="4">Nguyễn Thị Hòa Thảo (thaonth)</option><option value="5">Nguyễn Hữu Tiếng (tiengnh)</option><option value="6">Lương Thị Kim Anh (anhltk)</option><option value="7">Nguyễn Ngọc Tàu (taunn)</option><option value="8">Nguyễn Thành Tín (tinnt)</option><option value="9">Nguyễn Phi Long (longnp)</option><option value="10">Ngô Văn Tùng (tungnv)</option></select><div id="ChosenCalendar_chosen" title="" style="width: 50%;" class="chosen-container chosen-container-single"><a class="chosen-single chosen-default" tabindex="-1"><span>Tìm Kiếm . . .</span><div><b></b></div></a><div class="chosen-drop"><div class="chosen-search"><input autocomplete="off" type="text"></div><ul class="chosen-results"></ul></div></div>
            </div>
            
            <div class="fc fc-ltr" id="calendar2" style="width: 90%; margin: 3% 5%"><table class="fc-header" style="width:100%"><tbody><tr><td class="fc-header-left"><span style="-moz-user-select: none;" unselectable="on" class="fc-button fc-button-prev fc-state-default fc-corner-left"><i class="icon-chevron-left"></i></span><span style="-moz-user-select: none;" unselectable="on" class="fc-button fc-button-next fc-state-default fc-corner-right"><i class="icon-chevron-right"></i></span><span class="fc-header-space"></span><span style="-moz-user-select: none;" unselectable="on" class="fc-button fc-button-today fc-state-default fc-corner-left fc-corner-right">Hôm nay</span></td><td class="fc-header-center"><span class="fc-header-title"><h2>&nbsp;</h2></span></td><td class="fc-header-right"><span style="-moz-user-select: none;" unselectable="on" class="fc-button fc-button-month fc-state-default fc-corner-left fc-state-active">Tháng</span><span style="-moz-user-select: none;" unselectable="on" class="fc-button fc-button-agendaWeek fc-state-default">Tuần</span><span style="-moz-user-select: none;" unselectable="on" class="fc-button fc-button-agendaDay fc-state-default fc-corner-right">Ngày</span></td></tr></tbody></table><div class="fc-content" style="position: relative;"><div unselectable="on" class="fc-view fc-view-month fc-grid" style="position: relative; -moz-user-select: none;"></div></div>

            </div>
        </div>
    </div>

    <div class="row" style="width: 80%; margin-left: 10%; padding: 50px 0px">
        <div class="col-sm-9">
            <div class="fc fc-ltr" id="calendar"><table class="fc-header" style="width:100%"><tbody><tr><td class="fc-header-left"><span style="-moz-user-select: none;" unselectable="on" class="fc-button fc-button-prev fc-state-default fc-corner-left"><i class="icon-chevron-left"></i></span><span style="-moz-user-select: none;" unselectable="on" class="fc-button fc-button-next fc-state-default fc-corner-right"><i class="icon-chevron-right"></i></span><span class="fc-header-space"></span><span style="-moz-user-select: none;" unselectable="on" class="fc-button fc-button-today fc-state-default fc-corner-left fc-corner-right fc-state-disabled">Hôm nay</span></td><td class="fc-header-center"><span class="fc-header-title"><h2>Tháng 9, 2014</h2></span></td><td class="fc-header-right"><span style="-moz-user-select: none;" unselectable="on" class="fc-button fc-button-month fc-state-default fc-corner-left fc-state-active">Tháng</span><span style="-moz-user-select: none;" unselectable="on" class="fc-button fc-button-agendaWeek fc-state-default">Tuần</span><span style="-moz-user-select: none;" unselectable="on" class="fc-button fc-button-agendaDay fc-state-default fc-corner-right">Ngày</span></td></tr></tbody></table><div class="fc-content" style="position: relative;"><div unselectable="on" class="fc-view fc-view-month fc-grid" style="position: relative; -moz-user-select: none;"><div class="fc-event-container" style="position:absolute;z-index:8;top:0;left:0"><div class="fc-event fc-event-hori fc-event-draggable fc-event-start fc-event-end label-success" style="position: absolute; left: 553px; width: 205px; top: 229px;"><div class="fc-event-inner"><span class="fc-event-title">Gặp anh Nam</span></div><div class="ui-resizable-handle ui-resizable-e">&nbsp;&nbsp;&nbsp;</div></div><div class="fc-event fc-event-hori fc-event-draggable fc-event-start fc-event-end label-success" style="position: absolute; left: 223px; width: 325px; top: 138px;"><div class="fc-event-inner"><span class="fc-event-title">asd</span></div><div class="ui-resizable-handle ui-resizable-e">&nbsp;&nbsp;&nbsp;</div></div></div><table class="fc-border-separate" style="width:100%" cellspacing="0"><thead><tr class="fc-first fc-last"><th style="width: 110px;" class="fc-day-header fc-sun fc-widget-header fc-first">CN</th><th style="width: 110px;" class="fc-day-header fc-mon fc-widget-header">T2</th><th style="width: 110px;" class="fc-day-header fc-tue fc-widget-header">T3</th><th style="width: 110px;" class="fc-day-header fc-wed fc-widget-header">T4</th><th style="width: 110px;" class="fc-day-header fc-thu fc-widget-header">T5</th><th style="width: 110px;" class="fc-day-header fc-fri fc-widget-header">T6</th><th class="fc-day-header fc-sat fc-widget-header fc-last">T7</th></tr></thead><tbody><tr class="fc-week fc-first"><td class="fc-day fc-sun fc-widget-content fc-other-month fc-past fc-first" data-date="2014-08-31"><div style="min-height: 91px;"><div class="fc-day-number">31</div><div class="fc-day-content"><div style="position: relative; height: 0px;">&nbsp;</div></div></div></td><td class="fc-day fc-mon fc-widget-content fc-past" data-date="2014-09-01"><div><div class="fc-day-number">1</div><div class="fc-day-content"><div style="position: relative; height: 0px;">&nbsp;</div></div></div></td><td class="fc-day fc-tue fc-widget-content fc-past" data-date="2014-09-02"><div><div class="fc-day-number">2</div><div class="fc-day-content"><div style="position: relative; height: 0px;">&nbsp;</div></div></div></td><td class="fc-day fc-wed fc-widget-content fc-past" data-date="2014-09-03"><div><div class="fc-day-number">3</div><div class="fc-day-content"><div style="position: relative; height: 0px;">&nbsp;</div></div></div></td><td class="fc-day fc-thu fc-widget-content fc-past" data-date="2014-09-04"><div><div class="fc-day-number">4</div><div class="fc-day-content"><div style="position: relative; height: 0px;">&nbsp;</div></div></div></td><td class="fc-day fc-fri fc-widget-content fc-past" data-date="2014-09-05"><div><div class="fc-day-number">5</div><div class="fc-day-content"><div style="position: relative; height: 0px;">&nbsp;</div></div></div></td><td class="fc-day fc-sat fc-widget-content fc-past fc-last" data-date="2014-09-06"><div><div class="fc-day-number">6</div><div class="fc-day-content"><div style="position: relative; height: 0px;">&nbsp;</div></div></div></td></tr><tr class="fc-week"><td class="fc-day fc-sun fc-widget-content fc-past fc-first" data-date="2014-09-07"><div style="min-height: 90px;"><div class="fc-day-number">7</div><div class="fc-day-content"><div style="position: relative; height: 21px;">&nbsp;</div></div></div></td><td class="fc-day fc-mon fc-widget-content fc-past" data-date="2014-09-08"><div><div class="fc-day-number">8</div><div class="fc-day-content"><div style="position: relative; height: 21px;">&nbsp;</div></div></div></td><td class="fc-day fc-tue fc-widget-content fc-past" data-date="2014-09-09"><div><div class="fc-day-number">9</div><div class="fc-day-content"><div style="position: relative; height: 21px;">&nbsp;</div></div></div></td><td class="fc-day fc-wed fc-widget-content fc-past" data-date="2014-09-10"><div><div class="fc-day-number">10</div><div class="fc-day-content"><div style="position: relative; height: 21px;">&nbsp;</div></div></div></td><td class="fc-day fc-thu fc-widget-content fc-past" data-date="2014-09-11"><div><div class="fc-day-number">11</div><div class="fc-day-content"><div style="position: relative; height: 21px;">&nbsp;</div></div></div></td><td class="fc-day fc-fri fc-widget-content fc-past" data-date="2014-09-12"><div><div class="fc-day-number">12</div><div class="fc-day-content"><div style="position: relative; height: 21px;">&nbsp;</div></div></div></td><td class="fc-day fc-sat fc-widget-content fc-past fc-last" data-date="2014-09-13"><div><div class="fc-day-number">13</div><div class="fc-day-content"><div style="position: relative; height: 21px;">&nbsp;</div></div></div></td></tr><tr class="fc-week"><td class="fc-day fc-sun fc-widget-content fc-past fc-first" data-date="2014-09-14"><div style="min-height: 90px;"><div class="fc-day-number">14</div><div class="fc-day-content"><div style="position: relative; height: 21px;">&nbsp;</div></div></div></td><td class="fc-day fc-mon fc-widget-content fc-past" data-date="2014-09-15"><div><div class="fc-day-number">15</div><div class="fc-day-content"><div style="position: relative; height: 21px;">&nbsp;</div></div></div></td><td class="fc-day fc-tue fc-widget-content fc-past" data-date="2014-09-16"><div><div class="fc-day-number">16</div><div class="fc-day-content"><div style="position: relative; height: 21px;">&nbsp;</div></div></div></td><td class="fc-day fc-wed fc-widget-content fc-past" data-date="2014-09-17"><div><div class="fc-day-number">17</div><div class="fc-day-content"><div style="position: relative; height: 21px;">&nbsp;</div></div></div></td><td class="fc-day fc-thu fc-widget-content fc-past" data-date="2014-09-18"><div><div class="fc-day-number">18</div><div class="fc-day-content"><div style="position: relative; height: 21px;">&nbsp;</div></div></div></td><td class="fc-day fc-fri fc-widget-content fc-today fc-state-highlight" data-date="2014-09-19"><div><div class="fc-day-number">19</div><div class="fc-day-content"><div style="position: relative; height: 21px;">&nbsp;</div></div></div></td><td class="fc-day fc-sat fc-widget-content fc-future fc-last" data-date="2014-09-20"><div><div class="fc-day-number">20</div><div class="fc-day-content"><div style="position: relative; height: 21px;">&nbsp;</div></div></div></td></tr><tr class="fc-week"><td class="fc-day fc-sun fc-widget-content fc-future fc-first" data-date="2014-09-21"><div style="min-height: 90px;"><div class="fc-day-number">21</div><div class="fc-day-content"><div style="position: relative; height: 0px;">&nbsp;</div></div></div></td><td class="fc-day fc-mon fc-widget-content fc-future" data-date="2014-09-22"><div><div class="fc-day-number">22</div><div class="fc-day-content"><div style="position: relative; height: 0px;">&nbsp;</div></div></div></td><td class="fc-day fc-tue fc-widget-content fc-future" data-date="2014-09-23"><div><div class="fc-day-number">23</div><div class="fc-day-content"><div style="position: relative; height: 0px;">&nbsp;</div></div></div></td><td class="fc-day fc-wed fc-widget-content fc-future" data-date="2014-09-24"><div><div class="fc-day-number">24</div><div class="fc-day-content"><div style="position: relative; height: 0px;">&nbsp;</div></div></div></td><td class="fc-day fc-thu fc-widget-content fc-future" data-date="2014-09-25"><div><div class="fc-day-number">25</div><div class="fc-day-content"><div style="position: relative; height: 0px;">&nbsp;</div></div></div></td><td class="fc-day fc-fri fc-widget-content fc-future" data-date="2014-09-26"><div><div class="fc-day-number">26</div><div class="fc-day-content"><div style="position: relative; height: 0px;">&nbsp;</div></div></div></td><td class="fc-day fc-sat fc-widget-content fc-future fc-last" data-date="2014-09-27"><div><div class="fc-day-number">27</div><div class="fc-day-content"><div style="position: relative; height: 0px;">&nbsp;</div></div></div></td></tr><tr class="fc-week"><td class="fc-day fc-sun fc-widget-content fc-future fc-first" data-date="2014-09-28"><div style="min-height: 90px;"><div class="fc-day-number">28</div><div class="fc-day-content"><div style="position: relative; height: 0px;">&nbsp;</div></div></div></td><td class="fc-day fc-mon fc-widget-content fc-future" data-date="2014-09-29"><div><div class="fc-day-number">29</div><div class="fc-day-content"><div style="position: relative; height: 0px;">&nbsp;</div></div></div></td><td class="fc-day fc-tue fc-widget-content fc-future" data-date="2014-09-30"><div><div class="fc-day-number">30</div><div class="fc-day-content"><div style="position: relative; height: 0px;">&nbsp;</div></div></div></td><td class="fc-day fc-wed fc-widget-content fc-other-month fc-future" data-date="2014-10-01"><div><div class="fc-day-number">1</div><div class="fc-day-content"><div style="position: relative; height: 0px;">&nbsp;</div></div></div></td><td class="fc-day fc-thu fc-widget-content fc-other-month fc-future" data-date="2014-10-02"><div><div class="fc-day-number">2</div><div class="fc-day-content"><div style="position: relative; height: 0px;">&nbsp;</div></div></div></td><td class="fc-day fc-fri fc-widget-content fc-other-month fc-future" data-date="2014-10-03"><div><div class="fc-day-number">3</div><div class="fc-day-content"><div style="position: relative; height: 0px;">&nbsp;</div></div></div></td><td class="fc-day fc-sat fc-widget-content fc-other-month fc-future fc-last" data-date="2014-10-04"><div><div class="fc-day-number">4</div><div class="fc-day-content"><div style="position: relative; height: 0px;">&nbsp;</div></div></div></td></tr><tr class="fc-week fc-last"><td class="fc-day fc-sun fc-widget-content fc-other-month fc-future fc-first" data-date="2014-10-05"><div style="min-height: 92px;"><div class="fc-day-number">5</div><div class="fc-day-content"><div style="position: relative; height: 0px;">&nbsp;</div></div></div></td><td class="fc-day fc-mon fc-widget-content fc-other-month fc-future" data-date="2014-10-06"><div><div class="fc-day-number">6</div><div class="fc-day-content"><div style="position: relative; height: 0px;">&nbsp;</div></div></div></td><td class="fc-day fc-tue fc-widget-content fc-other-month fc-future" data-date="2014-10-07"><div><div class="fc-day-number">7</div><div class="fc-day-content"><div style="position: relative; height: 0px;">&nbsp;</div></div></div></td><td class="fc-day fc-wed fc-widget-content fc-other-month fc-future" data-date="2014-10-08"><div><div class="fc-day-number">8</div><div class="fc-day-content"><div style="position: relative; height: 0px;">&nbsp;</div></div></div></td><td class="fc-day fc-thu fc-widget-content fc-other-month fc-future" data-date="2014-10-09"><div><div class="fc-day-number">9</div><div class="fc-day-content"><div style="position: relative; height: 0px;">&nbsp;</div></div></div></td><td class="fc-day fc-fri fc-widget-content fc-other-month fc-future" data-date="2014-10-10"><div><div class="fc-day-number">10</div><div class="fc-day-content"><div style="position: relative; height: 0px;">&nbsp;</div></div></div></td><td class="fc-day fc-sat fc-widget-content fc-other-month fc-future fc-last" data-date="2014-10-11"><div><div class="fc-day-number">11</div><div class="fc-day-content"><div style="position: relative; height: 0px;">&nbsp;</div></div></div></td></tr></tbody></table></div></div>

            </div>
        </div>

        <div class="col-sm-3">
            <div class="widget-box transparent">
                <div class="widget-header">
                    <h4>Kéo thả sự kiện vào lịch làm việc</h4>
                </div>

                <div class="widget-body">
                    <div class="widget-main no-padding">
                        <div id="external-events">
                            <div style="position: relative;" class="external-event label-success ui-draggable" data-class="label-success">
                                <i class="icon-move"></i>
                                Gặp khách hàng
                            </div>

                            <div style="position: relative;" class="external-event label-danger ui-draggable" data-class="label-danger">
                                <i class="icon-move"></i>
                                Biện hộ trước tòa
                            </div>

                            <div style="position: relative;" class="external-event label-purple ui-draggable" data-class="label-purple">
                                <i class="icon-move"></i>
                                Thu thập tài liệu
                            </div>

                            <div style="position: relative;" class="external-event label-yellow ui-draggable" data-class="label-yellow">
                                <i class="icon-move"></i>
                                Thu thập bằng chứng
                            </div>

                            <div style="position: relative;" class="external-event label-pink ui-draggable" data-class="label-pink">
                                <i class="icon-move"></i>
                                Tư vấn khách hàng
                            </div>

                            <div style="position: relative;" class="external-event label-info ui-draggable" data-class="label-info">
                                <i class="icon-move"></i>
                                Kí kết hợp đồng
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="modalAddNewCase" class="modal fade" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header no-padding">
                <div class="table-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                        <span class="white">×</span>
                    </button>
                    Thêm hồ sơ tác nghiệp
                </div>
            </div>

            <form novalidate="novalidate" class="modal-body no-padding" id="addCaseValidateForm">
                <div class="col-xs-12">
                    <div class="row">
                        <div class="form-group" style="margin-bottom: 0px">
                            <div class="col-sm-6">
                                <p class="header blue lighter smaller">Mã hồ sơ<span style="color: red"> *</span></p>
                                <div>
                                    <input id="txtCaseCode" name="txtCaseCode" class="col-xs-10 col-sm-5" style="width: 100%; height: 32px;" maxlength="50" type="text">
                                </div>
                                <div id="existCaseCodeError" style="display: none">
                                    <span style="color: #D16E6C">Mã hồ sơ đã tồn tại!</span>
                                </div>
                            </div>
                        </div>

                        <div class="col-sm-6">
                            <p class="header blue lighter smaller">Ngày thụ lý<span style="color: red"> *</span></p>
                            <div class="input-group input-group-sm">
                                <input value="19/09/2014" class="form-control date-picker" id="datePickerReceiptDate" data-date-format="dd/mm/yyyy" style="width: 100%; cursor: pointer; background: none repeat scroll 0 0 #fff !important" readonly="readonly" type="text">
                                <span class="input-group-addon">
                                    <i class="icon-calendar bigger-110"></i>
                                </span>

                                <script>
                                    var today = getCurdate();
                                    document.getElementById("datePickerReceiptDate").value = today.toString();
                                </script>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="form-group" style="margin-bottom: 0px">
                            <div class="col-sm-6">
                                <p class="header blue lighter smaller">Thuộc văn phòng<span style="color: red"> *</span></p>
                                <div>
                                    <select class="form-control" id="cboOffice" name="cboOffice"><option value="1">Luật Thuận Nguyễn Hồ Chí Minh</option><option value="2">Luật Thuận Nguyễn Vĩnh Long</option></select>
                                </div>
                            </div>
                        </div>

                        <div class="form-group" style="margin-bottom: 0px">
                            <div class="col-sm-6">
                                <p class="header blue lighter smaller">Nội dung<span style="color: red"> *</span></p>
                                <div>
                                    <textarea id="txtCaseContent" name="txtCaseContent" class="autosize-transition form-control" style="resize: none; overflow: hidden; word-wrap: break-word; height: 52px;"></textarea>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="space-12"></div>
                </div>
            </form>

            <div class="modal-footer no-margin-top">
                <button class="btn btn-grey pull-left" type="button" data-dismiss="modal" id="btnClose">
                    <i class="icon-remove"></i>
                    Đóng
                </button>
                <button class="btn btn-success" type="button" data-bb-handler="confirm" id="btnAddNewCase" onclick="addCase()">
                    <i class="icon-ok"></i>
                    Thêm mới
                </button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>

<script>
    $(document).ready(function () {
        document.body.setAttribute('spellcheck', false);
        GetAssignedCases();

        var roleId = $("#staffRoleIdDiv").attr("value");
        if (roleId == "1" || roleId == "2") {
            $('#addNewCaseBtn').show();
        }

        validateAddCase('#addCaseValidateForm');

    });
</script>

<script>
    function prepareForCase() {
        var roleId = $("#staffRoleIdDiv").attr("value");
        if (roleId == "1" || roleId == "2") {
            $('#addNewCaseBtn').show();
        }
        
        $('#caseContent').show();
        $('#calendarContent').hide();

        $('#caseLi').attr('class', 'active');
        $('#eventLi').attr('class', '');
        $('#caseA').attr('style', 'background-color: #A0A0A0');
        $('#eventA').removeAttr('style');
    }

    function prepareForCalendar() {
        $('#addNewCaseBtn').hide();
        
        $('#caseContent').hide();
        $('#calendarContent').show();
        $(".fc-header-left").find(".fc-button-today").click();

        $('#caseLi').attr('class', '');
        $('#eventLi').attr('class', 'active');
        $('#caseA').removeAttr('style');
        $('#eventA').attr('style', 'background-color: #A0A0A0');
        loadSelectStaffCalendar();//
    }
</script>

<script>
    function addCase() {
        if ($('#addCaseValidateForm').valid()) {
            var caseCode = $('#txtCaseCode').val();
            var receiptDate = $('#datePickerReceiptDate').val();
            var caseContent = $('#txtCaseContent').val();
            var officeId = $("#cboOffice option:selected").val();

            $.post("/Case/AddCase", {
                caseCode: caseCode, receiptDate: receiptDate, caseContent: caseContent, officeId: officeId
            }, function (result) {
                if (result != "error" && result != "existCode") {
                    $('#existCaseCodeError').attr("style", "display: none");
                    var url = '/Case/Case/' + result + '';
                    $(location).attr('href', url);
                } else if (result == "error") {
                    notification("Thêm hồ sơ thất bại!", "Hãy kiểm tra lại kết nối database.", 5000, "gritter-error center");
                } else if (result == "existCode") {
                    $('#existCaseCodeError').attr("style", "display: block");
                }
            })
            .error(function () {
                notification("Thêm hồ sơ thất bại!", "Hãy kiểm tra lại kết nối database.", 5000, "gritter-error center");
            });
        }
    }

    function validateAddCase(validateform) {
        $(validateform).validate({
            errorElement: 'div',
            errorClass: 'help-block',
            focusInvalid: false,
            rules: {
                txtCaseCode: {
                    required: true
                },
                cboOffice: {
                    required: true
                },
                txtCaseContent: {
                    required: true
                }
            },
            messages: {
                txtCaseCode: {
                    required: "Nhập mã hồ sơ!"
                },
                cboOffice: {
                    required: "Chọn văn phòng!",
                },
                txtCaseContent: {
                    required: "Nhập nội dung!",
                }
            },
            highlight: function (e) {
                $(e).closest('.form-group').removeClass('has-info').addClass('has-error');
            },

            success: function (e) {
                $(e).closest('.form-group').removeClass('has-error').addClass('has-info');
                $(e).remove();
            },
            errorPlacement: function (error, element) {
                if (element.is(':checkbox') || element.is(':radio')) {
                    var controls = element.closest('div[class*="col-"]');
                    if (controls.find(':checkbox,:radio').length > 1) controls.append(error);
                    else error.insertAfter(element.nextAll('.lbl:eq(0)').eq(0));
                }
                else error.insertAfter(element.parent());
            }
        });
    }
</script>

<script type="text/javascript">
    jQuery(function ($) {
        $('.date-picker').datepicker({ autoclose: true }).next().on(ace.click_event, function () {
            $(this).prev().focus();
        });

        $('textarea[class*=autosize]').autosize({ append: "\n" });
    });

</script>


<script>
    function GetAssignedCases() {
        $('#caseContent').html('');

        var items = '';
        //items = '<hr/><div id="addNewCaseBtn" style="display: none">' +
        //    '<a href="#modalAddNewCase" role="button" class="green" data-toggle="modal">' +
        //    '<button class="btn btn-primary" onclick="">' +
        //    '<i class="icon-plus"></i>Thêm hồ sơ tác nghiệp</button></a></div>';

        var roleId = $("#staffRoleIdDiv").attr("value");

        // get toan bo case ma staff duoc assign
        $.ajax({
            url: '/Home/GetAssignedCases',
            type: 'POST',
            data: {},
            dataType: "json",
            async: true,
            success: function(out) {
                var outCase = out.assignCase;
                var outOffice = "";
                if (roleId == "1") {
                     outOffice = out.outOffice;
                } else {
                     outOffice = new Array();
                    $.each(out.outOffice.Office_Staff, function(index, element) {
                        outOffice.push(element.Office);
                    });
                }
 
                $.each(outOffice, function(index, resultOffice) {
                    items += '<div style="padding: 20px 0px"><h3 class="header smaller lighter green"><i class="icon-legal"></i> ' + resultOffice.OfficeName + '</h3>';

                    if (outCase != null) {
                        var caseCount = 0;
                        $.each(outCase, function(index2, resultCase) {
                            if (resultCase.OfficeId == resultOffice.OfficeId && resultCase.Status == "Đang thụ lý") {
                                caseCount += 1;

                                items += '<a href="/Case/Case/' + resultCase.CaseId + '" class="btn btn-case btn-primary">';
                                items += '<p style="font-weight: bold; padding-bottom: 15px">' + resultCase.CaseCode + '</p>';
                                var date = convertNETDateTime(resultCase.ReceiptDate).toLocaleFormat('%d/%m/%Y');
                                items += '<p>' + date + '</p>';
                                items += '<p class="myparagraph">' + resultCase.CaseContent + '</p>';
                                items += '</a>';
                            }
                        });
                        if (caseCount == 0) {
                            items += '<p style="margin-left: 30px">Chưa có phân công hồ sơ án.</p>';
                        }
                    } else {
                        items += '<p style="margin-left: 30px">Chưa có phân công hồ sơ án.</p>';
                    }

                    items += '</div>';
                });
                $('#caseContent').append(items);
                
                // load office len cobOffice
                var itemOff = '';
                $.each(outOffice, function (index, off) {
                    itemOff += '<option value="' + off.OfficeId + '">' + off.OfficeName + '</option>';
                });
                $('#cboOffice').html(itemOff);
                $('#cboOffice').val("");
            },
            error: function() {
                notification("Liệt kê hồ sơ thất bại!", "Hãy kiểm tra lại kết nối database.", 5000, "gritter-error center");
            }
        });
    }
</script>

<script type="text/javascript">

    jQuery(function ($) {
        /* initialize the external events
        -----------------------------------------------------------------*/

        $('#external-events div.external-event').each(function () {

            // create an Event Object (http://arshaw.com/fullcalendar/docs/event_data/Event_Object/)
            // it doesn't need to have a start or end
            var eventObject = {
                title: $.trim($(this).text()) // use the element's text as the event title
            };

            // store the Event Object in the DOM element so we can get to it later
            $(this).data('eventObject', eventObject);

            // make the event draggable using jQuery UI
            $(this).draggable({
                zIndex: 999,
                revert: true,      // will cause the event to go back to its
                revertDuration: 0  //  original position after the drag
            });

        });
        /* initialize the calendar
        -----------------------------------------------------------------*/
        var date = new Date();
        var d = date.getDate();
        var m = date.getMonth();
        var y = date.getFullYear();

        var calendar = $('#calendar').fullCalendar({
            buttonText: {
                prev: '<i class="icon-chevron-left"></i>',
                next: '<i class="icon-chevron-right"></i>'
            },

            header: {
                left: 'prev,next today',
                center: 'title',
                right: 'month,agendaWeek,agendaDay'
            },
            //load event source
            events: function (start, end, callback) {
                $.ajax({
                    url: 'JsonCalendarEvent',
                    method: 'POST',
                    data: {
                        start: ConvertDateToString(start),
                        end: ConvertDateToString(end)
                    },
                    success: function (doc) {
                        var events = [];
                        // push Calendar Event ra fullCalendar
                        $(doc.listCE).each(function (index, element) {
                            var boolAllDay = true;
                            if (getHMS(convertNETDateTime($(this).attr('BeginTime'))) != "00:00:00" || getHMS(convertNETDateTime($(this).attr('EndTime'))) != "00:00:00") {
                                boolAllDay = false;
                            }
                            events.push({
                                calendarId: $(this).attr('CalendarEventId'), //day la customize feild
                                title: $(this).attr('Title'),
                                start: convertNETDateTime($(this).attr('BeginTime')).toLocaleFormat('%M/%d/%y %h:%m:%s'), // will be parsed
                                end: convertNETDateTime($(this).attr('EndTime')).toLocaleFormat('%M/%d/%y %h:%m:%s'),
                                className: $(this).attr('Priority'),
                                allDay: boolAllDay,
                                type: "CE" //customize feild, phan loai event dua theo nguon goc (table)
                            });
                        });
                        // push Operation Event ra fullCalendar
                        $(doc.listOE).each(function (index, element) {
                            var boolAllDay = true;
                            if (getHMS(convertNETDateTime($(this).attr('BeginTime'))) != "00:00:00" || getHMS(convertNETDateTime($(this).attr('EndTime'))) != "00:00:00") {
                                boolAllDay = false;
                            }
                            var caseCode = $(this).attr('Case').CaseCode;
                            events.push({
                                calendarId: $(this).attr('OperationalEventId'),
                                title: $(this).attr('Title') + " (" + caseCode+")",
                                start: convertNETDateTime($(this).attr('BeginTime')).toLocaleFormat('%M/%d/%y %h:%m:%s'), // will be parsed
                                end: convertNETDateTime($(this).attr('EndTime')).toLocaleFormat('%M/%d/%y %h:%m:%s'),
                                className: "label-grey",
                                allDay: boolAllDay,
                                caseCode:caseCode,
                                type: "OE" //customize feild, phan loai event dua theo nguon goc (table)
                            });
                        });
                        //console.log(events);
                        callback(events);
                    }
                });
            },
            editable: true,
            droppable: true, // this allows things to be dropped onto the calendar !!!
            //di chuyen event co san
            eventDrop: function (event, jsEvent, ui, view) {
                //alert("drop");
                //viet chac nang update event
                
                if (event.end == null || event.end == "") {
                    event.end = event.start;
                } // nếu event trong 1 ngày (ko có end) thì truyền end=start về server
                var formatedStart = ConvertDateToString(event.start);
                var formatedEnd = ConvertDateToString(event.end);
                if (event.allDay) {
                    formatedStart = formatToAllDayEvent(event.start);
                    formatedEnd = formatToAllDayEvent(event.end);
                }
                var title = event.title;
                if (event.type == "OE") {
                    title = title.split(" (")[0];
                }
                $.ajax({
                    url: "UpdateCalendarEvent",
                    type: 'POST',
                    async: true,
                    data: {
                        id: event.calendarId,
                        title: title,
                        start: formatedStart,
                        end: formatedEnd,
                        className: event.className.toString(),
                        type: event.type
                    },
                    success: function (result) {
                        if (result == 'success') {
                            calendar.fullCalendar('updateEvent', event);
                            console.debug("success");
                        } else {
                            console.debug("fail");
                        }
                    },
                    error: function (errMsg) {
                        //alert(errMsg.responseText);
                        console.debug("error");
                    }
                });

            },
            //keo dai event co san
            eventResize: function (event, jsEvent, ui, view) {
                //alert("resize");
                //viet chac nang update event
                if (event.end == null || event.end == "") {
                    event.end = event.start;
                } // nếu event trong 1 ngày (ko có end) thì truyền end=start về server
                var title = event.title;
                if (event.type == "OE") {
                    title = title.split(" (")[0];
                }
                $.ajax({
                    url: "UpdateCalendarEvent",
                    type: 'POST',
                    async: true,
                    data: {
                        id: event.calendarId,
                        title: title,
                        start: ConvertDateToString(event.start),
                        end: ConvertDateToString(event.end),
                        className: event.className.toString(),
                        type: event.type
                    },
                    success: function (result) {
                        if (result == 'success') {
                            calendar.fullCalendar('updateEvent', event);
                            console.debug("success");
                        } else {
                            console.debug("fail");
                        }
                    },
                    error: function (errMsg) {
                        //alert(errMsg.responseText);
                        console.debug("error");
                    }
                });
            },
            //keo tha event moi vao calendar
            drop: function (date, allDay) { // this function is called when something is dropped
                // retrieve the dropped element's stored Event Object
                //var originalEventObject = $(this).data('eventObject');
                var $extraEventClass = $(this).attr('data-class');
                // we need to copy it, so that multiple events don't have a reference to the same object
                //var copiedEventObject = $.extend({}, originalEventObject);

                // assign it the date that was reported
                //copiedEventObject.start = date;
                //copiedEventObject.allDay = allDay;
                //if ($extraEventClass) copiedEventObject['className'] = [$extraEventClass];

                // render the event on the calendar
                // the last `true` argument determines if the event "sticks" (http://arshaw.com/fullcalendar/docs/event_rendering/renderEvent/)
                //$('#calendar').fullCalendar('renderEvent', copiedEventObject, true);

                //code them vao
                bootbox.prompt("Tên Sự Kiện Mới:", function (title) {
                    if (title !== null && title != "") {

                        //viet ham add new event
                        $.ajax({
                            url: "AddCalendarEvent",
                            type: 'POST',
                            async: true,
                            data: {
                                title: title,
                                start: ConvertDateToString(date),
                                end: ConvertDateToString(date),
                                className: $extraEventClass
                            },
                            success: function (result) {
                                if (result != "0") {
                                    calendar.fullCalendar('renderEvent',
                                        {
                                            calendarId: result,
                                            title: title,
                                            start: date,
                                            end: date,
                                            allDay: allDay,
                                            className: $extraEventClass,
                                            type: "CE"
                                        },
                                        true //make the event "stick"
                                    );
                                } else {
                                    console.debug("fail");
                                }
                            },
                            error: function (errMsg) {
                                //alert(errMsg.responseText);
                                console.debug("fail");
                            }
                        });
                    }
                });
                calendar.fullCalendar('unselect');
            },
            selectable: true,
            selectHelper: true,
            //click vao calendar de tao event moi
            select: function (start, end, allDay) {

                bootbox.prompt("Tên Sự Kiện Mới:", function (title) {
                    if (title !== null) {

                        //ham add new event
                        $.ajax({
                            url: "AddCalendarEvent",
                            type: 'POST',
                            async: true,
                            data: {
                                title: title,
                                start: ConvertDateToString(start),
                                end: ConvertDateToString(end),
                                //allDay: allDay,
                                className: "label-info"
                            },
                            success: function (result) {
                                if (result != "0") {
                                    calendar.fullCalendar('renderEvent',
                                        {
                                            calendarId: result,
                                            title: title,
                                            start: start,
                                            end: end,
                                            //allDay: allDay,
                                            className: "label-info",
                                            type: "CE"
                                        },
                                        true // make the event "stick"
                                    );
                                    console.debug("success");
                                } else {
                                    console.debug("fail");
                                }
                            },
                            error: function (errMsg) {
                                //alert(errMsg.responseText);
                                console.debug("fail");
                            }
                        });
                    }
                });

                calendar.fullCalendar('unselect');

            },
            //click vao event co san
            eventClick: function (calEvent, jsEvent, view) {
                $("#calendarContent");
                var form = $("<form class='form-inline'><label>Đổi Tên Sự Kiện &nbsp;</label></form>");
                var title = calEvent.title;
                if (calEvent.type == "OE") {
                    title = title.split(" (")[0];
                }
                form.append("<input class='middle' style='width:60%' autocomplete=off type=text value='" + title + "' /> ");
                form.append("<button type='submit' class='btn btn-sm btn-success'><i class='icon-ok'></i> Lưu</button>");

                var div = bootbox.dialog({
                    message: form,

                    buttons: {
                        "delete": {
                            "label": "<i class='icon-trash'></i> Xóa Sự Kiện",
                            "className": "btn-sm btn-danger",
                            "callback": function () {

                                calendar.fullCalendar('removeEvents', function (ev) {
                                    if (ev._id == calEvent._id) {
                                        //ham delete event
                                        var deleteResult;
                                        $.ajax({
                                            url: "DeleteCalendarEvent",
                                            type: 'POST',
                                            async: false,
                                            data: {
                                                calendarId: ev.calendarId,
                                                type: ev.type
                                            },
                                            success: function (result) {
                                                if (result == 'success') {
                                                    deleteResult = true;
                                                } else {
                                                    deleteResult = false;
                                                }
                                            },
                                            error: function (errMsg) {
                                                //alert(errMsg.responseText);
                                                console.debug("fail");
                                                deleteResult = false;
                                            }

                                        });
                                        return deleteResult;
                                    }
                                });
                            }
                        },
                        "close": {
                            "label": "<i class='icon-remove'></i> Đóng",
                            "className": "btn-sm"
                        }
                    }
                });

                form.on('submit', function (ev) {
                    //viet chac nang update event
                    if (calEvent.end == null || calEvent.end == "") {
                        calEvent.end = calEvent.start;
                    } // nếu event trong 1 ngày (ko có end) thì truyền end=start về server
                    $.ajax({
                        url: "UpdateCalendarEvent",
                        type: 'POST',
                        async: false,
                        data: {
                            id: calEvent.calendarId,
                            title: form.find("input[type=text]").val(),
                            start: ConvertDateToString(calEvent.start),
                            end: ConvertDateToString(calEvent.end),
                            className: calEvent.className.toString(),
                            type: calEvent.type
                        },
                        success: function (result) {
                            if (result == 'success') {
                                calEvent.title = form.find("input[type=text]").val() + " (" + calEvent.caseCode+")";
                                calendar.fullCalendar('updateEvent', calEvent);
                                div.modal("hide");
                                console.debug("success");
                            } else {
                                console.debug("fail");
                            }
                        },
                        error: function (errMsg) {
                            //alert(errMsg.responseText);
                            console.debug("error");
                        }
                    });
                    return false;
                });

                //console.log(calEvent.id);
                //console.log(jsEvent);
                //console.log(view);

                // change the border color just for fun
                //$(this).css('border-color', 'red');
            }
        });

        var calendar2 = $('#calendar2').fullCalendar({
            buttonText: {
                prev: '<i class="icon-chevron-left"></i>',
                next: '<i class="icon-chevron-right"></i>'
            },

            header: {
                left: 'prev,next today',
                center: 'title',
                right: 'month,agendaWeek,agendaDay'
            },
            events: function (start, end, callback) {
                $.ajax({
                    url: 'GetAllStaffCalendar',
                    method: 'POST',
                    data: {
                        staffId: $('#ChosenCalendar').val(),
                        start: ConvertDateToString(start),
                        end: ConvertDateToString(end)
                    },
                    success: function (doc) {
                        var events = [];
                        $(doc.listCE).each(function (index, element) {
                            var boolAllDay = true;
                            if (getHMS(convertNETDateTime($(this).attr('BeginTime'))) != "00:00:00") {
                                boolAllDay = false;
                            }
                            events.push({
                                calendarId: $(this).attr('CalendarEventId'),
                                title: $(this).attr('Title'),
                                start: convertNETDateTime($(this).attr('BeginTime')).toLocaleFormat('%M/%d/%y %h:%m:%s'), // will be parsed
                                end: convertNETDateTime($(this).attr('EndTime')).toLocaleFormat('%M/%d/%y %h:%m:%s'),
                                className: $(this).attr('Priority'),
                                allDay: boolAllDay
                            });
                        });
                        // push Operation Event ra fullCalendar
                        $(doc.listOE).each(function (index, element) {
                            var boolAllDay = true;
                            if (getHMS(convertNETDateTime($(this).attr('BeginTime'))) != "00:00:00") {
                                boolAllDay = false;
                            }
                            var caseCode = $(this).attr('Case').CaseCode;
                            events.push({
                                calendarId: $(this).attr('OperationalEventId'),
                                title: $(this).attr('Title') + " (" + caseCode + ")",
                                start: convertNETDateTime($(this).attr('BeginTime')).toLocaleFormat('%M/%d/%y %h:%m:%s'), // will be parsed
                                end: convertNETDateTime($(this).attr('EndTime')).toLocaleFormat('%M/%d/%y %h:%m:%s'),
                                className: "label-grey",
                                allDay: boolAllDay,
                            });
                        });
                        //console.log(events);
                        callback(events);
                    }
                });
            },
            editable: false,
            droppable: false, // this allows things to be dropped onto the calendar !!!

            selectable: false,
            selectHelper: false,
        });
    });

    function ConvertDateToString(date) {
        var dd = date.getDate();
        var mm = date.getMonth() + 1; //January is 0!
        var yyyy = date.getFullYear();
        var hh = date.getHours();
        var m = date.getMinutes();
        if (dd < 10) { dd = "0" + dd };
        if (mm < 10) { mm = "0" + mm };
        if (hh < 10) { hh = "0" + hh };
        if (m < 10) { m = "0" + m };

        return mm + "/" + dd + "/" + yyyy + " " + hh + ":" + m + ":" + "00";
    }

    function getHMS(date) {
        var hh = date.getHours();
        var m = date.getMinutes();
        if (hh < 10) { hh = "0" + hh };
        if (m < 10) { m = "0" + m };

        return hh + ":" + m + ":" + "00";
    }

    function formatToAllDayEvent(date) {
        var dd = date.getDate();
        var mm = date.getMonth() + 1; //January is 0!
        var yyyy = date.getFullYear();
        if (dd < 10) { dd = "0" + dd };
        if (mm < 10) { mm = "0" + mm };

        return mm + "/" + dd + "/" + yyyy + " 00:00:00";
    }

    var isSearchLab = false;
    $('#searchBtn').click(function () {
        if (!isSearchLab) {
            $("#searchContent").show();

            $("#searchBtn").css("right", "600px");
            $("#searchBtn").css("top", "5px");
            $("#searchBtn").find("span").text("Đóng");
            $("#searchBtn").find("i").appendTo($("#searchBtn").find("button"));
            $($("#searchBtn").find("i")).attr("class", "icon-arrow-right icon-on-right");
            $("#searchContent").find(".fc-button-today").click();
            //$("#searchContent").css("height", "800px");
            //$("#searchContent").css("width", "800px");

            //loadSelectStaffCalendar();//chu y
            isSearchLab = true;
            
        }
        else {
            $("#searchContent").hide();

            $("#searchBtn").css("right", "0");
            $("#searchBtn").find("span").text(" Lịch làm việc các luật sư");
            $("#searchBtn").find("span").appendTo($("#searchBtn").find("button"));
            $($("#searchBtn").find("i")).attr("class", "icon-arrow-left icon-on-right");
         
            isSearchLab = false;
        }
    });

    $("#ChosenCalendar").chosen();
    $("#ChosenCalendar_chosen").css("width", "50%");
    
    function loadSelectStaffCalendar() {
        $.ajax({
            url: "/Home/GetAllSelectStaff",
            type: 'POST',
            async: false,
            success: function (data) {
                if (data != null) {
                    var item = "";//<option value=''" + ">&nbsp</option>
                    $.each(data, function (index, staff) {
                        item += '<option value="' + staff.StaffId + '">' + staff.StaffName + " (" + staff.Accounts[0].Username + ')</option>';
                    });
                    $("#ChosenCalendar").html(item);
                    $("#ChosenCalendar").val('');
                    $("#ChosenCalendar").trigger("chosen:updated");
                }
            },
            error: function (errMsg) {
                alert(errMsg.responseText);
            }
        });
    }

    $("#ChosenCalendar").change(function() {
        //callback de calendar update source event
        //$("#searchContent").find(".fc-button-next").click();
        //$("#searchContent").find(".fc-button-today").click();
        $('#calendar2').data("fullCalendar").refetchEvents();
    });

</script>
                            <!-- PAGE CONTENT ENDS -->
                        </div><!-- /.col -->
                    </div><!-- /.row -->
                </div><!-- /.page-content -->
            </div><!-- /.main-content -->

        </div><!-- /.main-container-inner -->

        <a href="#" id="btn-scroll-up" class="btn-scroll-up btn btn-sm btn-inverse">
            <i class="icon-double-angle-up icon-only bigger-110"></i>
        </a>
    </div><!-- /.main-container -->
    


<div class="datepicker datepicker-dropdown dropdown-menu"><div style="display: block;" class="datepicker-days"><table class=" table-condensed"><thead><tr><th style="visibility: visible;" class="prev"><i class="icon-arrow-left"></i></th><th colspan="5" class="switch">Tháng 9 2014</th><th style="visibility: visible;" class="next"><i class="icon-arrow-right"></i></th></tr><tr><th class="dow">CN</th><th class="dow">T2</th><th class="dow">T3</th><th class="dow">T4</th><th class="dow">T5</th><th class="dow">T6</th><th class="dow">T7</th></tr></thead><tbody><tr><td class="day old">31</td><td class="day">1</td><td class="day">2</td><td class="day">3</td><td class="day">4</td><td class="day">5</td><td class="day">6</td></tr><tr><td class="day">7</td><td class="day">8</td><td class="day">9</td><td class="day">10</td><td class="day">11</td><td class="day">12</td><td class="day">13</td></tr><tr><td class="day">14</td><td class="day">15</td><td class="day">16</td><td class="day">17</td><td class="day">18</td><td class="day active">19</td><td class="day">20</td></tr><tr><td class="day">21</td><td class="day">22</td><td class="day">23</td><td class="day">24</td><td class="day">25</td><td class="day">26</td><td class="day">27</td></tr><tr><td class="day">28</td><td class="day">29</td><td class="day">30</td><td class="day new">1</td><td class="day new">2</td><td class="day new">3</td><td class="day new">4</td></tr><tr><td class="day new">5</td><td class="day new">6</td><td class="day new">7</td><td class="day new">8</td><td class="day new">9</td><td class="day new">10</td><td class="day new">11</td></tr></tbody><tfoot><tr><th style="display: none;" colspan="7" class="today">Hôm nay</th></tr></tfoot></table></div><div style="display: none;" class="datepicker-months"><table class="table-condensed"><thead><tr><th style="visibility: visible;" class="prev"><i class="icon-arrow-left"></i></th><th colspan="5" class="switch">2014</th><th style="visibility: visible;" class="next"><i class="icon-arrow-right"></i></th></tr></thead><tbody><tr><td colspan="7"><span class="month">Tháng 1</span><span class="month">Tháng 2</span><span class="month">Tháng 3</span><span class="month">Tháng 4</span><span class="month">Tháng 5</span><span class="month">Tháng 6</span><span class="month">Tháng 7</span><span class="month">Tháng 8</span><span class="month active">Tháng 9</span><span class="month">Tháng 10</span><span class="month">Tháng 11</span><span class="month">Tháng 12</span></td></tr></tbody><tfoot><tr><th style="display: none;" colspan="7" class="today">Hôm nay</th></tr></tfoot></table></div><div style="display: none;" class="datepicker-years"><table class="table-condensed"><thead><tr><th style="visibility: visible;" class="prev"><i class="icon-arrow-left"></i></th><th colspan="5" class="switch">2010-2019</th><th style="visibility: visible;" class="next"><i class="icon-arrow-right"></i></th></tr></thead><tbody><tr><td colspan="7"><span class="year old">2009</span><span class="year">2010</span><span class="year">2011</span><span class="year">2012</span><span class="year">2013</span><span class="year active">2014</span><span class="year">2015</span><span class="year">2016</span><span class="year">2017</span><span class="year">2018</span><span class="year">2019</span><span class="year old">2020</span></td></tr></tbody><tfoot><tr><th style="display: none;" colspan="7" class="today">Hôm nay</th></tr></tfoot></table></div></div><textarea class="autosizejs" tabindex="-1" style="position: absolute; top: -999px; left: 0px; right: auto; bottom: auto; border: 0px none; padding: 0px; box-sizing: content-box; word-wrap: break-word; height: 0px ! important; min-height: 0px ! important; overflow: hidden; transition: none 0s ease 0s ; font-family: &quot;Helvetica Neue&quot;,&quot;Segoe UI&quot;,Helvetica,Arial,&quot;Lucida Grande&quot;,sans-serif; font-size: 14px; font-weight: 400; font-style: normal; letter-spacing: 0px; text-transform: none; word-spacing: 0px; text-indent: 0px; line-height: 20px;">
</textarea></body></html>